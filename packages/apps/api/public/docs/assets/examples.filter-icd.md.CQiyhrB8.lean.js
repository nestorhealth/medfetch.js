var lh=Object.defineProperty;var lc=i=>{throw TypeError(i)};var ch=(i,e,t)=>e in i?lh(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var et=(i,e,t)=>ch(i,typeof e!="symbol"?e+"":e,t),xa=(i,e,t)=>e.has(i)||lc("Cannot "+t);var s=(i,e,t)=>(xa(i,e,"read from private field"),t?t.call(i):e.get(i)),V=(i,e,t)=>e.has(i)?lc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),G=(i,e,t,o)=>(xa(i,e,"write to private field"),o?o.call(i,t):e.set(i,t),t),me=(i,e,t)=>(xa(i,e,"access private method"),t);import{af as uh,d as dh,v as hh,c as fh,o as ph,ae as _h}from"./chunks/framework.B_7j4Rw8.js";function Sa(...i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new Error(`unexpected nullable value at index ${e}`);return i}function mh(){return typeof window<"u"}function kr(i){return typeof i>"u"||i===void 0}function Mt(i){return typeof i=="string"}function ua(i){return typeof i=="number"}function po(i){return typeof i=="boolean"}function ul(i){return i===null}function yh(i){return i instanceof Date}function dl(i){return typeof i=="bigint"}function si(i){return typeof i=="function"}function qi(i){return typeof i=="object"&&i!==null}function d(i){return Object.freeze(i)}function oo(i){return sr(i)?i:[i]}function sr(i){return Array.isArray(i)}function ei(i){return i}const He=d({is(i){return i.kind==="AlterTableNode"},create(i){return d({kind:"AlterTableNode",table:i})},cloneWithTableProps(i,e){return d({...i,...e})},cloneWithColumnAlteration(i,e){return d({...i,columnAlterations:i.columnAlterations?[...i.columnAlterations,e]:[e]})}}),Je=d({is(i){return i.kind==="IdentifierNode"},create(i){return d({kind:"IdentifierNode",name:i})}}),xi=d({is(i){return i.kind==="CreateIndexNode"},create(i){return d({kind:"CreateIndexNode",name:Je.create(i)})},cloneWith(i,e){return d({...i,...e})},cloneWithColumns(i,e){return d({...i,columns:[...i.columns||[],...e]})}}),hl=d({is(i){return i.kind==="CreateSchemaNode"},create(i,e){return d({kind:"CreateSchemaNode",schema:Je.create(i),...e})},cloneWith(i,e){return d({...i,...e})}}),Ec=["preserve rows","delete rows","drop"],jt=d({is(i){return i.kind==="CreateTableNode"},create(i){return d({kind:"CreateTableNode",table:i,columns:d([])})},cloneWithColumn(i,e){return d({...i,columns:d([...i.columns,e])})},cloneWithConstraint(i,e){return d({...i,constraints:i.constraints?d([...i.constraints,e]):d([e])})},cloneWithFrontModifier(i,e){return d({...i,frontModifiers:i.frontModifiers?d([...i.frontModifiers,e]):d([e])})},cloneWithEndModifier(i,e){return d({...i,endModifiers:i.endModifiers?d([...i.endModifiers,e]):d([e])})},cloneWith(i,e){return d({...i,...e})}}),Wi=d({is(i){return i.kind==="SchemableIdentifierNode"},create(i){return d({kind:"SchemableIdentifierNode",identifier:Je.create(i)})},createWithSchema(i,e){return d({kind:"SchemableIdentifierNode",schema:Je.create(i),identifier:Je.create(e)})}}),xn=d({is(i){return i.kind==="DropIndexNode"},create(i,e){return d({kind:"DropIndexNode",name:Wi.create(i),...e})},cloneWith(i,e){return d({...i,...e})}}),_o=d({is(i){return i.kind==="DropSchemaNode"},create(i,e){return d({kind:"DropSchemaNode",schema:Je.create(i),...e})},cloneWith(i,e){return d({...i,...e})}}),mo=d({is(i){return i.kind==="DropTableNode"},create(i,e){return d({kind:"DropTableNode",table:i,...e})},cloneWith(i,e){return d({...i,...e})}}),Ri=d({is(i){return i.kind==="AliasNode"},create(i,e){return d({kind:"AliasNode",node:i,alias:e})}}),Li=d({is(i){return i.kind==="TableNode"},create(i){return d({kind:"TableNode",table:Wi.create(i)})},createWithSchema(i,e){return d({kind:"TableNode",table:Wi.createWithSchema(i,e)})}});function Ft(i){return qi(i)&&si(i.toOperationNode)}function fl(i){return qi(i)&&"expressionType"in i&&Ft(i)}function vc(i){return qi(i)&&"expression"in i&&Mt(i.alias)&&Ft(i)}const ki=d({is(i){return i.kind==="SelectModifierNode"},create(i,e){return d({kind:"SelectModifierNode",modifier:i,of:e})},createWithExpression(i){return d({kind:"SelectModifierNode",rawModifier:i})}}),or=d({is(i){return i.kind==="AndNode"},create(i,e){return d({kind:"AndNode",left:i,right:e})}}),dn=d({is(i){return i.kind==="OrNode"},create(i,e){return d({kind:"OrNode",left:i,right:e})}}),ao=d({is(i){return i.kind==="OnNode"},create(i){return d({kind:"OnNode",on:i})},cloneWithOperation(i,e,t){return d({...i,on:e==="And"?or.create(i.on,t):dn.create(i.on,t)})}}),tn=d({is(i){return i.kind==="JoinNode"},create(i,e){return d({kind:"JoinNode",joinType:i,table:e,on:void 0})},createWithOn(i,e,t){return d({kind:"JoinNode",joinType:i,table:e,on:ao.create(t)})},cloneWithOn(i,e){return d({...i,on:i.on?ao.cloneWithOperation(i.on,"And",e):ao.create(e)})}}),nn=d({is(i){return i.kind==="BinaryOperationNode"},create(i,e,t){return d({kind:"BinaryOperationNode",leftOperand:i,operator:e,rightOperand:t})}}),kc=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],xc=["+","-","*","/","%","^","&","|","#","<<",">>"],pl=["->","->>"],Sc=[...kc,...xc,"&&","||"],Ac=["exists","not exists"],Oc=["not","-",...Ac],Cc=[...Sc,...pl,...Oc,"between","between symmetric"],ar=d({is(i){return i.kind==="OperatorNode"},create(i){return d({kind:"OperatorNode",operator:i})}});function Fa(i){return Mt(i)&&pl.includes(i)}const pt=d({is(i){return i.kind==="ColumnNode"},create(i){return d({kind:"ColumnNode",column:Je.create(i)})}}),da=d({is(i){return i.kind==="SelectAllNode"},create(){return d({kind:"SelectAllNode"})}}),Ys=d({is(i){return i.kind==="ReferenceNode"},create(i,e){return d({kind:"ReferenceNode",table:e,column:i})},createSelectAll(i){return d({kind:"ReferenceNode",table:i,column:da.create()})}});var Tn;class gh{constructor(e){V(this,Tn);G(this,Tn,e)}get dynamicReference(){return s(this,Tn)}get refType(){}toOperationNode(){return Lc(s(this,Tn))}}Tn=new WeakMap;function Ic(i){return qi(i)&&Ft(i)&&Mt(i.dynamicReference)}const Pi=d({is(i){return i.kind==="OrderByItemNode"},create(i,e){return d({kind:"OrderByItemNode",orderBy:i,direction:e})},cloneWith(i,e){return d({...i,...e})}}),ht=d({is(i){return i.kind==="RawNode"},create(i,e){return d({kind:"RawNode",sqlFragments:d(i),parameters:d(e)})},createWithSql(i){return ht.create([i],[])},createWithChild(i){return ht.create(["",""],[i])},createWithChildren(i){return ht.create(new Array(i.length+1).fill(""),i)}}),Tc={is(i){return i.kind==="CollateNode"},create(i){return d({kind:"CollateNode",collation:Je.create(i)})}};var Si;const Pr=class Pr{constructor(e){V(this,Si);G(this,Si,d(e))}desc(){return new Pr({node:Pi.cloneWith(s(this,Si).node,{direction:ht.createWithSql("desc")})})}asc(){return new Pr({node:Pi.cloneWith(s(this,Si).node,{direction:ht.createWithSql("asc")})})}nullsLast(){return new Pr({node:Pi.cloneWith(s(this,Si).node,{nulls:"last"})})}nullsFirst(){return new Pr({node:Pi.cloneWith(s(this,Si).node,{nulls:"first"})})}collate(e){return new Pr({node:Pi.cloneWith(s(this,Si).node,{collation:Tc.create(e)})})}toOperationNode(){return s(this,Si).node}};Si=new WeakMap;let yo=Pr;const cc=new Set;function ts(i){cc.has(i)||(cc.add(i),console.log(i))}function Fc(i){return i==="asc"||i==="desc"}function sn(i){if(i.length===2)return[Aa(i[0],i[1])];if(i.length===1){const[e]=i;return Array.isArray(e)?(ts("orderBy(array) is deprecated, use multiple orderBy calls instead."),e.map(t=>Aa(t))):[Aa(e)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${i.length}`)}function Aa(i,e){const t=wh(i);if(Pi.is(t)){if(e)throw new Error("Cannot specify direction twice!");return t}return Pc(t,e)}function wh(i){if(eo(i))return pn(i);if(Ic(i))return i.toOperationNode();const[e,t]=i.split(" ");return t?(ts("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),Pc(lr(e),t)):lr(i)}function Pc(i,e){if(typeof e=="string"){if(!Fc(e))throw new Error(`Invalid order by direction: ${e}`);return Pi.create(i,ht.createWithSql(e))}if(fl(e))return ts("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),Pi.create(i,e.toOperationNode());const t=Pi.create(i);return e?e(new yo({node:t})).toOperationNode():t}const Cs=d({is(i){return i.kind==="JSONReferenceNode"},create(i,e){return d({kind:"JSONReferenceNode",reference:i,traversal:e})},cloneWithTraversal(i,e){return d({...i,traversal:e})}}),_l=d({is(i){return i.kind==="JSONOperatorChainNode"},create(i){return d({kind:"JSONOperatorChainNode",operator:i,values:d([])})},cloneWithValue(i,e){return d({...i,values:d([...i.values,e])})}}),Sn=d({is(i){return i.kind==="JSONPathNode"},create(i){return d({kind:"JSONPathNode",inOperator:i,pathLegs:d([])})},cloneWithLeg(i,e){return d({...i,pathLegs:d([...i.pathLegs,e])})}});function Lc(i){return Mt(i)?lr(i):i.toOperationNode()}function Is(i){return sr(i)?i.map(e=>ii(e)):[ii(i)]}function ii(i){return eo(i)?pn(i):Lc(i)}function bh(i,e){const t=lr(i);if(Fa(e))return Cs.create(t,_l.create(ar.create(e)));const o=e.slice(0,-1);if(Fa(o))return Cs.create(t,Sn.create(ar.create(o)));throw new Error(`Invalid JSON operator: ${e}`)}function lr(i){const e=".";if(!i.includes(e))return Ys.create(pt.create(i));const t=i.split(e).map(ml);if(t.length===3)return qh(t);if(t.length===2)return Eh(t);throw new Error(`invalid column reference ${i}`)}function Nh(i){const e=" as ";if(i.includes(e)){const[t,o]=i.split(e).map(ml);return Ri.create(lr(t),Je.create(o))}else return lr(i)}function Wc(i){return pt.create(i)}function go(i){const e=" ";if(i.includes(e)){const[t,o]=i.split(e).map(ml);if(!Fc(o))throw new Error(`invalid order direction "${o}" next to "${t}"`);return sn([t,o])[0]}else return Wc(i)}function qh(i){const[e,t,o]=i;return Ys.create(pt.create(o),Li.createWithSchema(e,t))}function Eh(i){const[e,t]=i;return Ys.create(pt.create(t),Li.create(e))}function ml(i){return i.trim()}const yl=d({is(i){return i.kind==="PrimitiveValueListNode"},create(i){return d({kind:"PrimitiveValueListNode",values:d([...i])})}}),Xs=d({is(i){return i.kind==="ValueListNode"},create(i){return d({kind:"ValueListNode",values:d(i)})}}),ri=d({is(i){return i.kind==="ValueNode"},create(i){return d({kind:"ValueNode",value:i})},createImmediate(i){return d({kind:"ValueNode",value:i,immediate:!0})}});function vh(i){return sr(i)?kh(i):bt(i)}function bt(i){return eo(i)?pn(i):ri.create(i)}function gl(i){return ua(i)||po(i)||ul(i)}function wl(i){if(!gl(i))throw new Error(`unsafe immediate value ${JSON.stringify(i)}`);return ri.createImmediate(i)}function kh(i){return i.some(eo)?Xs.create(i.map(e=>bt(e))):yl.create(i)}const on=d({is(i){return i.kind==="ParensNode"},create(i){return d({kind:"ParensNode",node:i})}});function Tt(i){if(i.length===3)return bl(i[0],i[1],i[2]);if(i.length===1)return bt(i[0]);throw new Error(`invalid arguments: ${JSON.stringify(i)}`)}function bl(i,e,t){return xh(e)&&Dc(t)?nn.create(ii(i),Pa(e),ri.createImmediate(t)):nn.create(ii(i),Pa(e),vh(t))}function Di(i,e,t){return nn.create(ii(i),Pa(e),ii(t))}function uc(i,e){return wo(Object.entries(i).filter(([,t])=>!kr(t)).map(([t,o])=>bl(t,Dc(o)?"is":"=",o)),e)}function wo(i,e,t=!0){const o=e==="and"?or.create:dn.create;if(i.length===0)return nn.create(ri.createImmediate(1),ar.create("="),ri.createImmediate(e==="and"?1:0));let m=dc(i[0]);for(let M=1;M<i.length;++M)m=o(m,dc(i[M]));return i.length>1&&t?on.create(m):m}function xh(i){return i==="is"||i==="is not"}function Dc(i){return ul(i)||po(i)}function Pa(i){if(Mt(i)&&Cc.includes(i))return ar.create(i);if(Ft(i))return i.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(i)}`)}function dc(i){return Ft(i)?i.toOperationNode():i}const an=d({is(i){return i.kind==="OrderByNode"},create(i){return d({kind:"OrderByNode",items:d([...i])})},cloneWithItems(i,e){return d({...i,items:d([...i.items,...e])})}}),La=d({is(i){return i.kind==="PartitionByNode"},create(i){return d({kind:"PartitionByNode",items:d(i)})},cloneWithItems(i,e){return d({...i,items:d([...i.items,...e])})}}),bo=d({is(i){return i.kind==="OverNode"},create(){return d({kind:"OverNode"})},cloneWithOrderByItems(i,e){return d({...i,orderBy:i.orderBy?an.cloneWithItems(i.orderBy,e):an.create(e)})},cloneWithPartitionByItems(i,e){return d({...i,partitionBy:i.partitionBy?La.cloneWithItems(i.partitionBy,e):La.create(e)})}}),Ts=d({is(i){return i.kind==="FromNode"},create(i){return d({kind:"FromNode",froms:d(i)})},cloneWithFroms(i,e){return d({...i,froms:d([...i.froms,...e])})}}),Wa=d({is(i){return i.kind==="GroupByNode"},create(i){return d({kind:"GroupByNode",items:d(i)})},cloneWithItems(i,e){return d({...i,items:d([...i.items,...e])})}}),Da=d({is(i){return i.kind==="HavingNode"},create(i){return d({kind:"HavingNode",having:i})},cloneWithOperation(i,e,t){return d({...i,having:e==="And"?or.create(i.having,t):dn.create(i.having,t)})}}),qt=d({is(i){return i.kind==="InsertQueryNode"},create(i,e,t){return d({kind:"InsertQueryNode",into:i,...e&&{with:e},replace:t})},createWithoutInto(){return d({kind:"InsertQueryNode"})},cloneWith(i,e){return d({...i,...e})}}),Nl=d({is(i){return i.kind==="ListNode"},create(i){return d({kind:"ListNode",items:d(i)})}}),rn=d({is(i){return i.kind==="UpdateQueryNode"},create(i,e){return d({kind:"UpdateQueryNode",table:i.length===1?i[0]:Nl.create(i),...e&&{with:e}})},createWithoutTable(){return d({kind:"UpdateQueryNode"})},cloneWithFromItems(i,e){return d({...i,from:i.from?Ts.cloneWithFroms(i.from,e):Ts.create(e)})},cloneWithUpdates(i,e){return d({...i,updates:i.updates?d([...i.updates,...e]):e})},cloneWithLimit(i,e){return d({...i,limit:e})}}),Ra=d({is(i){return i.kind==="UsingNode"},create(i){return d({kind:"UsingNode",tables:d(i)})},cloneWithTables(i,e){return d({...i,tables:d([...i.tables,...e])})}}),An=d({is(i){return i.kind==="DeleteQueryNode"},create(i,e){return d({kind:"DeleteQueryNode",from:Ts.create(i),...e&&{with:e}})},cloneWithOrderByItems:(i,e)=>fe.cloneWithOrderByItems(i,e),cloneWithoutOrderBy:i=>fe.cloneWithoutOrderBy(i),cloneWithLimit(i,e){return d({...i,limit:e})},cloneWithoutLimit(i){return d({...i,limit:void 0})},cloneWithUsing(i,e){return d({...i,using:i.using!==void 0?Ra.cloneWithTables(i.using,e):Ra.create(e)})}}),Rt=d({is(i){return i.kind==="WhereNode"},create(i){return d({kind:"WhereNode",where:i})},cloneWithOperation(i,e,t){return d({...i,where:e==="And"?or.create(i.where,t):dn.create(i.where,t)})}}),Ba=d({is(i){return i.kind==="ReturningNode"},create(i){return d({kind:"ReturningNode",selections:d(i)})},cloneWithSelections(i,e){return d({...i,selections:i.selections?d([...i.selections,...e]):d(e)})}}),Rc=d({is(i){return i.kind==="ExplainNode"},create(i,e){return d({kind:"ExplainNode",format:i,options:e})}}),is=d({is(i){return i.kind==="WhenNode"},create(i){return d({kind:"WhenNode",condition:i})},cloneWithResult(i,e){return d({...i,result:e})}}),Bt=d({is(i){return i.kind==="MergeQueryNode"},create(i,e){return d({kind:"MergeQueryNode",into:i,...e&&{with:e}})},cloneWithUsing(i,e){return d({...i,using:e})},cloneWithWhen(i,e){return d({...i,whens:i.whens?d([...i.whens,e]):d([e])})},cloneWithThen(i,e){return d({...i,whens:i.whens?d([...i.whens.slice(0,-1),is.cloneWithResult(i.whens[i.whens.length-1],e)]):void 0})}}),Ma=d({is(i){return i.kind==="OutputNode"},create(i){return d({kind:"OutputNode",selections:d(i)})},cloneWithSelections(i,e){return d({...i,selections:i.selections?d([...i.selections,...e]):d(e)})}}),fe=d({is(i){return Ke.is(i)||qt.is(i)||rn.is(i)||An.is(i)||Bt.is(i)},cloneWithEndModifier(i,e){return d({...i,endModifiers:i.endModifiers?d([...i.endModifiers,e]):d([e])})},cloneWithWhere(i,e){return d({...i,where:i.where?Rt.cloneWithOperation(i.where,"And",e):Rt.create(e)})},cloneWithJoin(i,e){return d({...i,joins:i.joins?d([...i.joins,e]):d([e])})},cloneWithReturning(i,e){return d({...i,returning:i.returning?Ba.cloneWithSelections(i.returning,e):Ba.create(e)})},cloneWithoutReturning(i){return d({...i,returning:void 0})},cloneWithoutWhere(i){return d({...i,where:void 0})},cloneWithExplain(i,e,t){return d({...i,explain:Rc.create(e,t==null?void 0:t.toOperationNode())})},cloneWithTop(i,e){return d({...i,top:e})},cloneWithOutput(i,e){return d({...i,output:i.output?Ma.cloneWithSelections(i.output,e):Ma.create(e)})},cloneWithOrderByItems(i,e){return d({...i,orderBy:i.orderBy?an.cloneWithItems(i.orderBy,e):an.create(e)})},cloneWithoutOrderBy(i){return d({...i,orderBy:void 0})}}),Ke=d({is(i){return i.kind==="SelectQueryNode"},create(i){return d({kind:"SelectQueryNode",...i&&{with:i}})},createFrom(i,e){return d({kind:"SelectQueryNode",from:Ts.create(i),...e&&{with:e}})},cloneWithSelections(i,e){return d({...i,selections:i.selections?d([...i.selections,...e]):d(e)})},cloneWithDistinctOn(i,e){return d({...i,distinctOn:i.distinctOn?d([...i.distinctOn,...e]):d(e)})},cloneWithFrontModifier(i,e){return d({...i,frontModifiers:i.frontModifiers?d([...i.frontModifiers,e]):d([e])})},cloneWithOrderByItems:(i,e)=>fe.cloneWithOrderByItems(i,e),cloneWithGroupByItems(i,e){return d({...i,groupBy:i.groupBy?Wa.cloneWithItems(i.groupBy,e):Wa.create(e)})},cloneWithLimit(i,e){return d({...i,limit:e})},cloneWithOffset(i,e){return d({...i,offset:e})},cloneWithFetch(i,e){return d({...i,fetch:e})},cloneWithHaving(i,e){return d({...i,having:i.having?Da.cloneWithOperation(i.having,"And",e):Da.create(e)})},cloneWithSetOperations(i,e){return d({...i,setOperations:i.setOperations?d([...i.setOperations,...e]):d([...e])})},cloneWithoutSelections(i){return d({...i,selections:[]})},cloneWithoutLimit(i){return d({...i,limit:void 0})},cloneWithoutOffset(i){return d({...i,offset:void 0})},cloneWithoutOrderBy:i=>fe.cloneWithoutOrderBy(i),cloneWithoutGroupBy(i){return d({...i,groupBy:void 0})}});var _i;const Ns=class Ns{constructor(e){V(this,_i);G(this,_i,d(e))}on(...e){return new Ns({...s(this,_i),joinNode:tn.cloneWithOn(s(this,_i).joinNode,Tt(e))})}onRef(e,t,o){return new Ns({...s(this,_i),joinNode:tn.cloneWithOn(s(this,_i).joinNode,Di(e,t,o))})}onTrue(){return new Ns({...s(this,_i),joinNode:tn.cloneWithOn(s(this,_i).joinNode,ht.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return s(this,_i).joinNode}};_i=new WeakMap;let No=Ns;const Bc=d({is(i){return i.kind==="PartitionByItemNode"},create(i){return d({kind:"PartitionByItemNode",partitionBy:i})}});function Sh(i){return Is(i).map(Bc.create)}var yr;const qs=class qs{constructor(e){V(this,yr);G(this,yr,d(e))}orderBy(...e){return new qs({overNode:bo.cloneWithOrderByItems(s(this,yr).overNode,sn(e))})}clearOrderBy(){return new qs({overNode:fe.cloneWithoutOrderBy(s(this,yr).overNode)})}partitionBy(e){return new qs({overNode:bo.cloneWithPartitionByItems(s(this,yr).overNode,Sh(e))})}$call(e){return e(this)}toOperationNode(){return s(this,yr).overNode}};yr=new WeakMap;let Ua=qs;const On=d({is(i){return i.kind==="SelectionNode"},create(i){return d({kind:"SelectionNode",selection:i})},createSelectAll(){return d({kind:"SelectionNode",selection:da.create()})},createSelectAllFromTable(i){return d({kind:"SelectionNode",selection:Ys.createSelectAll(i)})}});function ni(i){return si(i)?ni(i(fn())):sr(i)?i.map(e=>hc(e)):[hc(i)]}function hc(i){return Mt(i)?On.create(Nh(i)):Ic(i)?On.create(i.toOperationNode()):On.create(mu(i))}function ui(i){return i?Array.isArray(i)?i.map(fc):[fc(i)]:[On.createSelectAll()]}function fc(i){if(Mt(i))return On.createSelectAllFromTable(ft(i));throw new Error(`invalid value selectAll expression: ${JSON.stringify(i)}`)}const Mc=d({is(i){return i.kind==="ValuesNode"},create(i){return d({kind:"ValuesNode",values:d(i)})}}),Uc=d({is(i){return i.kind==="DefaultInsertValueNode"},create(){return d({kind:"DefaultInsertValueNode"})}});function Qc(i){const e=si(i)?i(fn()):i,t=sr(e)?e:d([e]);return Ah(t)}function Ah(i){const e=Oh(i);return[d([...e.keys()].map(pt.create)),Mc.create(i.map(t=>Ch(t,e)))]}function Oh(i){const e=new Map;for(const t of i){const o=Object.keys(t);for(const m of o)!e.has(m)&&t[m]!==void 0&&e.set(m,e.size)}return e}function Ch(i,e){const t=Object.keys(i),o=Array.from({length:e.size});let m=!1,M=t.length;for(const _e of t){const ke=e.get(_e);if(kr(ke)){M--;continue}const se=i[_e];(kr(se)||eo(se))&&(m=!0),o[ke]=se}if(M<e.size||m){const _e=Uc.create();return Xs.create(o.map(ke=>kr(ke)?_e:bt(ke)))}return yl.create(o)}const ql=d({is(i){return i.kind==="ColumnUpdateNode"},create(i,e){return d({kind:"ColumnUpdateNode",column:i,value:e})}});function Ih(...i){return i.length===2?[ql.create(ii(i[0]),bt(i[1]))]:El(i[0])}function El(i){const e=si(i)?i(fn()):i;return Object.entries(e).filter(([t,o])=>o!==void 0).map(([t,o])=>ql.create(pt.create(t),bt(o)))}const jc=d({is(i){return i.kind==="OnDuplicateKeyNode"},create(i){return d({kind:"OnDuplicateKeyNode",updates:i})}});class Vc{constructor(e,t){et(this,"insertId");et(this,"numInsertedOrUpdatedRows");this.insertId=e,this.numInsertedOrUpdatedRows=t}}class rs extends Error{constructor(t){super("no result");et(this,"node");this.node=t}}function ns(i){return Object.prototype.hasOwnProperty.call(i,"prototype")}const Vt=d({is(i){return i.kind==="OnConflictNode"},create(){return d({kind:"OnConflictNode"})},cloneWith(i,e){return d({...i,...e})},cloneWithIndexWhere(i,e){return d({...i,indexWhere:i.indexWhere?Rt.cloneWithOperation(i.indexWhere,"And",e):Rt.create(e)})},cloneWithIndexOrWhere(i,e){return d({...i,indexWhere:i.indexWhere?Rt.cloneWithOperation(i.indexWhere,"Or",e):Rt.create(e)})},cloneWithUpdateWhere(i,e){return d({...i,updateWhere:i.updateWhere?Rt.cloneWithOperation(i.updateWhere,"And",e):Rt.create(e)})},cloneWithUpdateOrWhere(i,e){return d({...i,updateWhere:i.updateWhere?Rt.cloneWithOperation(i.updateWhere,"Or",e):Rt.create(e)})},cloneWithoutIndexWhere(i){return d({...i,indexWhere:void 0})},cloneWithoutUpdateWhere(i){return d({...i,updateWhere:void 0})}});var tt;const zi=class zi{constructor(e){V(this,tt);G(this,tt,d(e))}column(e){const t=pt.create(e);return new zi({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{columns:s(this,tt).onConflictNode.columns?d([...s(this,tt).onConflictNode.columns,t]):d([t])})})}columns(e){const t=e.map(pt.create);return new zi({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{columns:s(this,tt).onConflictNode.columns?d([...s(this,tt).onConflictNode.columns,...t]):d(t)})})}constraint(e){return new zi({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{constraint:Je.create(e)})})}expression(e){return new zi({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new zi({...s(this,tt),onConflictNode:Vt.cloneWithIndexWhere(s(this,tt).onConflictNode,Tt(e))})}whereRef(e,t,o){return new zi({...s(this,tt),onConflictNode:Vt.cloneWithIndexWhere(s(this,tt).onConflictNode,Di(e,t,o))})}clearWhere(){return new zi({...s(this,tt),onConflictNode:Vt.cloneWithoutIndexWhere(s(this,tt).onConflictNode)})}doNothing(){return new zc({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new Eo({...s(this,tt),onConflictNode:Vt.cloneWith(s(this,tt).onConflictNode,{updates:El(e)})})}$call(e){return e(this)}};tt=new WeakMap;let qo=zi;var Us;class zc{constructor(e){V(this,Us);G(this,Us,d(e))}toOperationNode(){return s(this,Us).onConflictNode}}Us=new WeakMap;var mi;const Es=class Es{constructor(e){V(this,mi);G(this,mi,d(e))}where(...e){return new Es({...s(this,mi),onConflictNode:Vt.cloneWithUpdateWhere(s(this,mi).onConflictNode,Tt(e))})}whereRef(e,t,o){return new Es({...s(this,mi),onConflictNode:Vt.cloneWithUpdateWhere(s(this,mi).onConflictNode,Di(e,t,o))})}clearWhere(){return new Es({...s(this,mi),onConflictNode:Vt.cloneWithoutUpdateWhere(s(this,mi).onConflictNode)})}$call(e){return e(this)}toOperationNode(){return s(this,mi).onConflictNode}};mi=new WeakMap;let Eo=Es;const $c=d({is(i){return i.kind==="TopNode"},create(i,e){return d({kind:"TopNode",expression:i,modifiers:e})}});function ss(i,e){if(!ua(i)&&!dl(i))throw new Error(`Invalid top expression: ${i}`);if(!kr(e)&&!Th(e))throw new Error(`Invalid top modifiers: ${e}`);return $c.create(i,e)}function Th(i){return i==="percent"||i==="with ties"||i==="percent with ties"}const Or=d({is(i){return i.kind==="OrActionNode"},create(i){return d({kind:"OrActionNode",action:i})}});var ye;const Ze=class Ze{constructor(e){V(this,ye);G(this,ye,d(e))}values(e){const[t,o]=Qc(e);return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{columns:t,values:o})})}columns(e){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{columns:d(e.map(pt.create))})})}expression(e){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{values:pn(e)})})}defaultValues(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{defaultValues:!0})})}modifyEnd(e){return new Ze({...s(this,ye),queryNode:fe.cloneWithEndModifier(s(this,ye).queryNode,e.toOperationNode())})}ignore(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("ignore")})})}orIgnore(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("ignore")})})}orAbort(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("abort")})})}orFail(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("fail")})})}orReplace(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("replace")})})}orRollback(){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{orAction:Or.create("rollback")})})}top(e,t){return new Ze({...s(this,ye),queryNode:fe.cloneWithTop(s(this,ye).queryNode,ss(e,t))})}onConflict(e){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{onConflict:e(new qo({onConflictNode:Vt.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new Ze({...s(this,ye),queryNode:qt.cloneWith(s(this,ye).queryNode,{onDuplicateKey:jc.create(El(e))})})}returning(e){return new Ze({...s(this,ye),queryNode:fe.cloneWithReturning(s(this,ye).queryNode,ni(e))})}returningAll(){return new Ze({...s(this,ye),queryNode:fe.cloneWithReturning(s(this,ye).queryNode,ui())})}output(e){return new Ze({...s(this,ye),queryNode:fe.cloneWithOutput(s(this,ye).queryNode,ni(e))})}outputAll(e){return new Ze({...s(this,ye),queryNode:fe.cloneWithOutput(s(this,ye).queryNode,ui(e))})}clearReturning(){return new Ze({...s(this,ye),queryNode:fe.cloneWithoutReturning(s(this,ye).queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Ze({...s(this,ye)})}$castTo(){return new Ze(s(this,ye))}$narrowType(){return new Ze(s(this,ye))}$assertType(){return new Ze(s(this,ye))}withPlugin(e){return new Ze({...s(this,ye),executor:s(this,ye).executor.withPlugin(e)})}toOperationNode(){return s(this,ye).executor.transformQuery(s(this,ye).queryNode,s(this,ye).queryId)}compile(){return s(this,ye).executor.compileQuery(this.toOperationNode(),s(this,ye).queryId)}async execute(){const e=this.compile(),t=await s(this,ye).executor.executeQuery(e,s(this,ye).queryId),{adapter:o}=s(this,ye).executor,m=e.query;return m.returning&&o.supportsReturning||m.output&&o.supportsOutput?t.rows:[new Vc(t.insertId,t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=rs){const t=await this.executeTakeFirst();if(t===void 0)throw ns(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),o=s(this,ye).executor.stream(t,e,s(this,ye).queryId);for await(const m of o)yield*m.rows}async explain(e,t){return await new Ze({...s(this,ye),queryNode:fe.cloneWithExplain(s(this,ye).queryNode,e,t)}).execute()}};ye=new WeakMap;let Fs=Ze;class Hc{constructor(e){et(this,"numDeletedRows");this.numDeletedRows=e}}const ha=d({is(i){return i.kind==="LimitNode"},create(i){return d({kind:"LimitNode",limit:i})}});var Ne,Qr,us;const ot=class ot{constructor(e){V(this,Qr);V(this,Ne);G(this,Ne,d(e))}where(...e){return new ot({...s(this,Ne),queryNode:fe.cloneWithWhere(s(this,Ne).queryNode,Tt(e))})}whereRef(e,t,o){return new ot({...s(this,Ne),queryNode:fe.cloneWithWhere(s(this,Ne).queryNode,Di(e,t,o))})}clearWhere(){return new ot({...s(this,Ne),queryNode:fe.cloneWithoutWhere(s(this,Ne).queryNode)})}top(e,t){return new ot({...s(this,Ne),queryNode:fe.cloneWithTop(s(this,Ne).queryNode,ss(e,t))})}using(e){return new ot({...s(this,Ne),queryNode:An.cloneWithUsing(s(this,Ne).queryNode,In(e))})}innerJoin(...e){return me(this,Qr,us).call(this,"InnerJoin",e)}leftJoin(...e){return me(this,Qr,us).call(this,"LeftJoin",e)}rightJoin(...e){return me(this,Qr,us).call(this,"RightJoin",e)}fullJoin(...e){return me(this,Qr,us).call(this,"FullJoin",e)}returning(e){return new ot({...s(this,Ne),queryNode:fe.cloneWithReturning(s(this,Ne).queryNode,ni(e))})}returningAll(e){return new ot({...s(this,Ne),queryNode:fe.cloneWithReturning(s(this,Ne).queryNode,ui(e))})}output(e){return new ot({...s(this,Ne),queryNode:fe.cloneWithOutput(s(this,Ne).queryNode,ni(e))})}outputAll(e){return new ot({...s(this,Ne),queryNode:fe.cloneWithOutput(s(this,Ne).queryNode,ui(e))})}clearReturning(){return new ot({...s(this,Ne),queryNode:fe.cloneWithoutReturning(s(this,Ne).queryNode)})}clearLimit(){return new ot({...s(this,Ne),queryNode:An.cloneWithoutLimit(s(this,Ne).queryNode)})}orderBy(...e){return new ot({...s(this,Ne),queryNode:fe.cloneWithOrderByItems(s(this,Ne).queryNode,sn(e))})}clearOrderBy(){return new ot({...s(this,Ne),queryNode:fe.cloneWithoutOrderBy(s(this,Ne).queryNode)})}limit(e){return new ot({...s(this,Ne),queryNode:An.cloneWithLimit(s(this,Ne).queryNode,ha.create(bt(e)))})}modifyEnd(e){return new ot({...s(this,Ne),queryNode:fe.cloneWithEndModifier(s(this,Ne).queryNode,e.toOperationNode())})}$call(e){return e(this)}$if(e,t){return e?t(this):new ot({...s(this,Ne)})}$castTo(){return new ot(s(this,Ne))}$narrowType(){return new ot(s(this,Ne))}$assertType(){return new ot(s(this,Ne))}withPlugin(e){return new ot({...s(this,Ne),executor:s(this,Ne).executor.withPlugin(e)})}toOperationNode(){return s(this,Ne).executor.transformQuery(s(this,Ne).queryNode,s(this,Ne).queryId)}compile(){return s(this,Ne).executor.compileQuery(this.toOperationNode(),s(this,Ne).queryId)}async execute(){const e=this.compile(),t=await s(this,Ne).executor.executeQuery(e,s(this,Ne).queryId),{adapter:o}=s(this,Ne).executor,m=e.query;return m.returning&&o.supportsReturning||m.output&&o.supportsOutput?t.rows:[new Hc(t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=rs){const t=await this.executeTakeFirst();if(t===void 0)throw ns(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),o=s(this,Ne).executor.stream(t,e,s(this,Ne).queryId);for await(const m of o)yield*m.rows}async explain(e,t){return await new ot({...s(this,Ne),queryNode:fe.cloneWithExplain(s(this,Ne).queryNode,e,t)}).execute()}};Ne=new WeakMap,Qr=new WeakSet,us=function(e,t){return new ot({...s(this,Ne),queryNode:fe.cloneWithJoin(s(this,Ne).queryNode,fa(e,t))})};let vo=ot;class Jc{constructor(e,t){et(this,"numUpdatedRows");et(this,"numChangedRows");this.numUpdatedRows=e,this.numChangedRows=t}}var qe,jr,ds;const at=class at{constructor(e){V(this,jr);V(this,qe);G(this,qe,d(e))}where(...e){return new at({...s(this,qe),queryNode:fe.cloneWithWhere(s(this,qe).queryNode,Tt(e))})}whereRef(e,t,o){return new at({...s(this,qe),queryNode:fe.cloneWithWhere(s(this,qe).queryNode,Di(e,t,o))})}clearWhere(){return new at({...s(this,qe),queryNode:fe.cloneWithoutWhere(s(this,qe).queryNode)})}top(e,t){return new at({...s(this,qe),queryNode:fe.cloneWithTop(s(this,qe).queryNode,ss(e,t))})}from(e){return new at({...s(this,qe),queryNode:rn.cloneWithFromItems(s(this,qe).queryNode,In(e))})}innerJoin(...e){return me(this,jr,ds).call(this,"InnerJoin",e)}leftJoin(...e){return me(this,jr,ds).call(this,"LeftJoin",e)}rightJoin(...e){return me(this,jr,ds).call(this,"RightJoin",e)}fullJoin(...e){return me(this,jr,ds).call(this,"FullJoin",e)}orderBy(...e){return new at({...s(this,qe),queryNode:fe.cloneWithOrderByItems(s(this,qe).queryNode,sn(e))})}clearOrderBy(){return new at({...s(this,qe),queryNode:fe.cloneWithoutOrderBy(s(this,qe).queryNode)})}limit(e){return new at({...s(this,qe),queryNode:rn.cloneWithLimit(s(this,qe).queryNode,ha.create(bt(e)))})}set(...e){return new at({...s(this,qe),queryNode:rn.cloneWithUpdates(s(this,qe).queryNode,Ih(...e))})}returning(e){return new at({...s(this,qe),queryNode:fe.cloneWithReturning(s(this,qe).queryNode,ni(e))})}returningAll(e){return new at({...s(this,qe),queryNode:fe.cloneWithReturning(s(this,qe).queryNode,ui(e))})}output(e){return new at({...s(this,qe),queryNode:fe.cloneWithOutput(s(this,qe).queryNode,ni(e))})}outputAll(e){return new at({...s(this,qe),queryNode:fe.cloneWithOutput(s(this,qe).queryNode,ui(e))})}modifyEnd(e){return new at({...s(this,qe),queryNode:fe.cloneWithEndModifier(s(this,qe).queryNode,e.toOperationNode())})}clearReturning(){return new at({...s(this,qe),queryNode:fe.cloneWithoutReturning(s(this,qe).queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new at({...s(this,qe)})}$castTo(){return new at(s(this,qe))}$narrowType(){return new at(s(this,qe))}$assertType(){return new at(s(this,qe))}withPlugin(e){return new at({...s(this,qe),executor:s(this,qe).executor.withPlugin(e)})}toOperationNode(){return s(this,qe).executor.transformQuery(s(this,qe).queryNode,s(this,qe).queryId)}compile(){return s(this,qe).executor.compileQuery(this.toOperationNode(),s(this,qe).queryId)}async execute(){const e=this.compile(),t=await s(this,qe).executor.executeQuery(e,s(this,qe).queryId),{adapter:o}=s(this,qe).executor,m=e.query;return m.returning&&o.supportsReturning||m.output&&o.supportsOutput?t.rows:[new Jc(t.numAffectedRows??BigInt(0),t.numChangedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=rs){const t=await this.executeTakeFirst();if(t===void 0)throw ns(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),o=s(this,qe).executor.stream(t,e,s(this,qe).queryId);for await(const m of o)yield*m.rows}async explain(e,t){return await new at({...s(this,qe),queryNode:fe.cloneWithExplain(s(this,qe).queryNode,e,t)}).execute()}};qe=new WeakMap,jr=new WeakSet,ds=function(e,t){return new at({...s(this,qe),queryNode:fe.cloneWithJoin(s(this,qe).queryNode,fa(e,t))})};let Ps=at;const Qa=d({is(i){return i.kind==="CommonTableExpressionNameNode"},create(i,e){return d({kind:"CommonTableExpressionNameNode",table:Li.create(i),columns:e?d(e.map(pt.create)):void 0})}}),Ls=d({is(i){return i.kind==="CommonTableExpressionNode"},create(i,e){return d({kind:"CommonTableExpressionNode",name:i,expression:e})},cloneWith(i,e){return d({...i,...e})}});var Ki;const Ko=class Ko{constructor(e){V(this,Ki);G(this,Ki,d(e))}materialized(){return new Ko({...s(this,Ki),node:Ls.cloneWith(s(this,Ki).node,{materialized:!0})})}notMaterialized(){return new Ko({...s(this,Ki),node:Ls.cloneWith(s(this,Ki).node,{materialized:!1})})}toOperationNode(){return s(this,Ki).node}};Ki=new WeakMap;let ja=Ko;function pc(i,e){const t=e(Uh()).toOperationNode();return si(i)?i(Fh(t)).toOperationNode():Ls.create(Gc(i),t)}function Fh(i){return e=>new ja({node:Ls.create(Gc(e),i)})}function Gc(i){if(i.includes("(")){const e=i.split(/[\(\)]/),t=e[0],o=e[1].split(",").map(m=>m.trim());return Qa.create(t,o)}else return Qa.create(i)}const hs=d({is(i){return i.kind==="WithNode"},create(i,e){return d({kind:"WithNode",expressions:d([i]),...e})},cloneWithExpression(i,e){return d({...i,expressions:d([...i.expressions,e])})}}),_c=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function Ph(i){let e="";for(let t=0;t<i;++t)e+=Lh();return e}function Lh(){return _c[~~(Math.random()*_c.length)]}function Me(){return new Wh}var Fn;class Wh{constructor(){V(this,Fn)}get queryId(){return s(this,Fn)===void 0&&G(this,Fn,Ph(8)),s(this,Fn)}}Fn=new WeakMap;var Yo;class vl{constructor(){et(this,"nodeStack",[]);V(this,Yo,d({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)}))}transformNode(e,t){if(!e)return e;this.nodeStack.push(e);const o=this.transformNodeImpl(e,t);return this.nodeStack.pop(),d(o)}transformNodeImpl(e,t){return s(this,Yo)[e.kind](e,t)}transformNodeList(e,t){return e&&d(e.map(o=>this.transformNode(o,t)))}transformSelectQuery(e,t){return{kind:"SelectQueryNode",from:this.transformNode(e.from,t),selections:this.transformNodeList(e.selections,t),distinctOn:this.transformNodeList(e.distinctOn,t),joins:this.transformNodeList(e.joins,t),groupBy:this.transformNode(e.groupBy,t),orderBy:this.transformNode(e.orderBy,t),where:this.transformNode(e.where,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),limit:this.transformNode(e.limit,t),offset:this.transformNode(e.offset,t),with:this.transformNode(e.with,t),having:this.transformNode(e.having,t),explain:this.transformNode(e.explain,t),setOperations:this.transformNodeList(e.setOperations,t),fetch:this.transformNode(e.fetch,t),top:this.transformNode(e.top,t)}}transformSelection(e,t){return{kind:"SelectionNode",selection:this.transformNode(e.selection,t)}}transformColumn(e,t){return{kind:"ColumnNode",column:this.transformNode(e.column,t)}}transformAlias(e,t){return{kind:"AliasNode",node:this.transformNode(e.node,t),alias:this.transformNode(e.alias,t)}}transformTable(e,t){return{kind:"TableNode",table:this.transformNode(e.table,t)}}transformFrom(e,t){return{kind:"FromNode",froms:this.transformNodeList(e.froms,t)}}transformReference(e,t){return{kind:"ReferenceNode",column:this.transformNode(e.column,t),table:this.transformNode(e.table,t)}}transformAnd(e,t){return{kind:"AndNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformOr(e,t){return{kind:"OrNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformValueList(e,t){return{kind:"ValueListNode",values:this.transformNodeList(e.values,t)}}transformParens(e,t){return{kind:"ParensNode",node:this.transformNode(e.node,t)}}transformJoin(e,t){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table,t),on:this.transformNode(e.on,t)}}transformRaw(e,t){return{kind:"RawNode",sqlFragments:d([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters,t)}}transformWhere(e,t){return{kind:"WhereNode",where:this.transformNode(e.where,t)}}transformInsertQuery(e,t){return{kind:"InsertQueryNode",into:this.transformNode(e.into,t),columns:this.transformNodeList(e.columns,t),values:this.transformNode(e.values,t),returning:this.transformNode(e.returning,t),onConflict:this.transformNode(e.onConflict,t),onDuplicateKey:this.transformNode(e.onDuplicateKey,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),ignore:e.ignore,orAction:this.transformNode(e.orAction,t),replace:e.replace,explain:this.transformNode(e.explain,t),defaultValues:e.defaultValues,top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformValues(e,t){return{kind:"ValuesNode",values:this.transformNodeList(e.values,t)}}transformDeleteQuery(e,t){return{kind:"DeleteQueryNode",from:this.transformNode(e.from,t),using:this.transformNode(e.using,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),orderBy:this.transformNode(e.orderBy,t),limit:this.transformNode(e.limit,t),explain:this.transformNode(e.explain,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformReturning(e,t){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections,t)}}transformCreateTable(e,t){return{kind:"CreateTableNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),constraints:this.transformNodeList(e.constraints,t),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),selectQuery:this.transformNode(e.selectQuery,t)}}transformColumnDefinition(e,t){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),references:this.transformNode(e.references,t),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo,t),check:this.transformNode(e.check,t),generated:this.transformNode(e.generated,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity,ifNotExists:e.ifNotExists}}transformAddColumn(e,t){return{kind:"AddColumnNode",column:this.transformNode(e.column,t)}}transformDropTable(e,t){return{kind:"DropTableNode",table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e,t){return{kind:"OrderByNode",items:this.transformNodeList(e.items,t)}}transformOrderByItem(e,t){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy,t),direction:this.transformNode(e.direction,t),collation:this.transformNode(e.collation,t),nulls:e.nulls}}transformGroupBy(e,t){return{kind:"GroupByNode",items:this.transformNodeList(e.items,t)}}transformGroupByItem(e,t){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy,t)}}transformUpdateQuery(e,t){return{kind:"UpdateQueryNode",table:this.transformNode(e.table,t),from:this.transformNode(e.from,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),updates:this.transformNodeList(e.updates,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),explain:this.transformNode(e.explain,t),limit:this.transformNode(e.limit,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t),orderBy:this.transformNode(e.orderBy,t)}}transformColumnUpdate(e,t){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column,t),value:this.transformNode(e.value,t)}}transformLimit(e,t){return{kind:"LimitNode",limit:this.transformNode(e.limit,t)}}transformOffset(e,t){return{kind:"OffsetNode",offset:this.transformNode(e.offset,t)}}transformOnConflict(e,t){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns,t),constraint:this.transformNode(e.constraint,t),indexExpression:this.transformNode(e.indexExpression,t),indexWhere:this.transformNode(e.indexWhere,t),updates:this.transformNodeList(e.updates,t),updateWhere:this.transformNode(e.updateWhere,t),doNothing:e.doNothing}}transformOnDuplicateKey(e,t){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates,t)}}transformCreateIndex(e,t){return{kind:"CreateIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists,where:this.transformNode(e.where,t),nullsNotDistinct:e.nullsNotDistinct}}transformList(e,t){return{kind:"ListNode",items:this.transformNodeList(e.items,t)}}transformDropIndex(e,t){return{kind:"DropIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e,t){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformUniqueConstraint(e,t){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),nullsNotDistinct:e.nullsNotDistinct,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformForeignKeyConstraint(e,t){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns,t),references:this.transformNode(e.references,t),name:this.transformNode(e.name,t),onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformSetOperation(e,t){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression,t),all:e.all}}transformReferences(e,t){return{kind:"ReferencesNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e,t){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression,t),name:this.transformNode(e.name,t)}}transformWith(e,t){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions,t),recursive:e.recursive}}transformCommonTableExpression(e,t){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name,t),materialized:e.materialized,expression:this.transformNode(e.expression,t)}}transformCommonTableExpressionName(e,t){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t)}}transformHaving(e,t){return{kind:"HavingNode",having:this.transformNode(e.having,t)}}transformCreateSchema(e,t){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema,t),ifNotExists:e.ifNotExists}}transformDropSchema(e,t){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema,t),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e,t){return{kind:"AlterTableNode",table:this.transformNode(e.table,t),renameTo:this.transformNode(e.renameTo,t),setSchema:this.transformNode(e.setSchema,t),columnAlterations:this.transformNodeList(e.columnAlterations,t),addConstraint:this.transformNode(e.addConstraint,t),dropConstraint:this.transformNode(e.dropConstraint,t),renameConstraint:this.transformNode(e.renameConstraint,t),addIndex:this.transformNode(e.addIndex,t),dropIndex:this.transformNode(e.dropIndex,t)}}transformDropColumn(e,t){return{kind:"DropColumnNode",column:this.transformNode(e.column,t)}}transformRenameColumn(e,t){return{kind:"RenameColumnNode",column:this.transformNode(e.column,t),renameTo:this.transformNode(e.renameTo,t)}}transformAlterColumn(e,t){return{kind:"AlterColumnNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),dataTypeExpression:this.transformNode(e.dataTypeExpression,t),setDefault:this.transformNode(e.setDefault,t),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e,t){return{kind:"ModifyColumnNode",column:this.transformNode(e.column,t)}}transformAddConstraint(e,t){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint,t)}}transformDropConstraint(e,t){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName,t),ifExists:e.ifExists,modifier:e.modifier}}transformRenameConstraint(e,t){return{kind:"RenameConstraintNode",oldName:this.transformNode(e.oldName,t),newName:this.transformNode(e.newName,t)}}transformCreateView(e,t){return{kind:"CreateViewNode",name:this.transformNode(e.name,t),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns,t),as:this.transformNode(e.as,t)}}transformRefreshMaterializedView(e,t){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(e.name,t),concurrently:e.concurrently,withNoData:e.withNoData}}transformDropView(e,t){return{kind:"DropViewNode",name:this.transformNode(e.name,t),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e,t){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression,t)}}transformDefaultValue(e,t){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue,t)}}transformOn(e,t){return{kind:"OnNode",on:this.transformNode(e.on,t)}}transformSelectModifier(e,t){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier,t),of:this.transformNodeList(e.of,t)}}transformCreateType(e,t){return{kind:"CreateTypeNode",name:this.transformNode(e.name,t),enum:this.transformNode(e.enum,t)}}transformDropType(e,t){return{kind:"DropTypeNode",name:this.transformNode(e.name,t),ifExists:e.ifExists}}transformExplain(e,t){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options,t)}}transformSchemableIdentifier(e,t){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema,t),identifier:this.transformNode(e.identifier,t)}}transformAggregateFunction(e,t){return{kind:"AggregateFunctionNode",func:e.func,aggregated:this.transformNodeList(e.aggregated,t),distinct:e.distinct,orderBy:this.transformNode(e.orderBy,t),withinGroup:this.transformNode(e.withinGroup,t),filter:this.transformNode(e.filter,t),over:this.transformNode(e.over,t)}}transformOver(e,t){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy,t),partitionBy:this.transformNode(e.partitionBy,t)}}transformPartitionBy(e,t){return{kind:"PartitionByNode",items:this.transformNodeList(e.items,t)}}transformPartitionByItem(e,t){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy,t)}}transformBinaryOperation(e,t){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand,t),operator:this.transformNode(e.operator,t),rightOperand:this.transformNode(e.rightOperand,t)}}transformUnaryOperation(e,t){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator,t),operand:this.transformNode(e.operand,t)}}transformUsing(e,t){return{kind:"UsingNode",tables:this.transformNodeList(e.tables,t)}}transformFunction(e,t){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments,t)}}transformCase(e,t){return{kind:"CaseNode",value:this.transformNode(e.value,t),when:this.transformNodeList(e.when,t),else:this.transformNode(e.else,t),isStatement:e.isStatement}}transformWhen(e,t){return{kind:"WhenNode",condition:this.transformNode(e.condition,t),result:this.transformNode(e.result,t)}}transformJSONReference(e,t){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference,t),traversal:this.transformNode(e.traversal,t)}}transformJSONPath(e,t){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator,t),pathLegs:this.transformNodeList(e.pathLegs,t)}}transformJSONPathLeg(e,t){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e,t){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator,t),values:this.transformNodeList(e.values,t)}}transformTuple(e,t){return{kind:"TupleNode",values:this.transformNodeList(e.values,t)}}transformMergeQuery(e,t){return{kind:"MergeQueryNode",into:this.transformNode(e.into,t),using:this.transformNode(e.using,t),whens:this.transformNodeList(e.whens,t),with:this.transformNode(e.with,t),top:this.transformNode(e.top,t),endModifiers:this.transformNodeList(e.endModifiers,t),output:this.transformNode(e.output,t),returning:this.transformNode(e.returning,t)}}transformMatched(e,t){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e,t){return{kind:"AddIndexNode",name:this.transformNode(e.name,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists}}transformCast(e,t){return{kind:"CastNode",expression:this.transformNode(e.expression,t),dataType:this.transformNode(e.dataType,t)}}transformFetch(e,t){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount,t),modifier:e.modifier}}transformTop(e,t){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformOutput(e,t){return{kind:"OutputNode",selections:this.transformNodeList(e.selections,t)}}transformDataType(e,t){return e}transformSelectAll(e,t){return e}transformIdentifier(e,t){return e}transformValue(e,t){return e}transformPrimitiveValueList(e,t){return e}transformOperator(e,t){return e}transformDefaultInsertValue(e,t){return e}transformOrAction(e,t){return e}transformCollate(e,t){return e}}Yo=new WeakMap;const Dh=d({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),Rh={json_agg:!0,to_json:!0};var Pn,Vr,zr,ct,Va,Kc,Yc,Xc,Cr,lo,Zc;class Bh extends vl{constructor(t){super();V(this,ct);V(this,Pn);V(this,Vr,new Set);V(this,zr,new Set);G(this,Pn,t)}transformNodeImpl(t,o){if(!me(this,ct,Kc).call(this,t))return super.transformNodeImpl(t,o);const m=me(this,ct,Xc).call(this,t);for(const _e of m)s(this,zr).add(_e);const M=me(this,ct,Yc).call(this,t);for(const _e of M)s(this,Vr).add(_e);const L=super.transformNodeImpl(t,o);for(const _e of M)s(this,Vr).delete(_e);for(const _e of m)s(this,zr).delete(_e);return L}transformSchemableIdentifier(t,o){const m=super.transformSchemableIdentifier(t,o);return m.schema||!s(this,Vr).has(t.identifier.name)?m:{...m,schema:Je.create(s(this,Pn))}}transformReferences(t,o){const m=super.transformReferences(t,o);return m.table.table.schema?m:{...m,table:Li.createWithSchema(s(this,Pn),m.table.table.identifier.name)}}transformAggregateFunction(t,o){return{...super.transformAggregateFunction({...t,aggregated:[]},o),aggregated:me(this,ct,Va).call(this,t,o,"aggregated")}}transformFunction(t,o){return{...super.transformFunction({...t,arguments:[]},o),arguments:me(this,ct,Va).call(this,t,o,"arguments")}}}Pn=new WeakMap,Vr=new WeakMap,zr=new WeakMap,ct=new WeakSet,Va=function(t,o,m){return Rh[t.func]?t[m].map(M=>!Li.is(M)||M.table.schema?this.transformNode(M,o):{...M,table:this.transformIdentifier(M.table.identifier,o)}):this.transformNodeList(t[m],o)},Kc=function(t){return t.kind in Dh},Yc=function(t){const o=new Set;if("name"in t&&t.name&&Wi.is(t.name)&&me(this,ct,lo).call(this,t.name,o),"from"in t&&t.from)for(const m of t.from.froms)me(this,ct,Cr).call(this,m,o);if("into"in t&&t.into&&me(this,ct,Cr).call(this,t.into,o),"table"in t&&t.table&&me(this,ct,Cr).call(this,t.table,o),"joins"in t&&t.joins)for(const m of t.joins)me(this,ct,Cr).call(this,m.table,o);return"using"in t&&t.using&&me(this,ct,Cr).call(this,t.using,o),o},Xc=function(t){const o=new Set;return"with"in t&&t.with&&me(this,ct,Zc).call(this,t.with,o),o},Cr=function(t,o){if(Li.is(t))me(this,ct,lo).call(this,t.table,o);else if(Ri.is(t)&&Li.is(t.node))me(this,ct,lo).call(this,t.node.table,o);else if(Nl.is(t))for(const m of t.items)me(this,ct,Cr).call(this,m,o)},lo=function(t,o){const m=t.identifier.name;!s(this,Vr).has(m)&&!s(this,zr).has(m)&&o.add(m)},Zc=function(t,o){for(const m of t.expressions){const M=m.name.table.table.identifier.name;s(this,zr).has(M)||o.add(M)}};var Qs;class hn{constructor(e){V(this,Qs);G(this,Qs,new Bh(e))}transformQuery(e){return s(this,Qs).transformNode(e.node,e.queryId)}async transformResult(e){return e.result}}Qs=new WeakMap;const eu=d({is(i){return i.kind==="MatchedNode"},create(i,e=!1){return d({kind:"MatchedNode",not:i,bySource:e})}});function mc(i,e,t){return is.create(wo([eu.create(!i.isMatched,i.bySource),...e&&e.length>0?[e.length===3&&t?Di(e[0],e[1],e[2]):Tt(e)]:[]],"and",!1))}function ps(i){return Mt(i)?ht.create([i],[]):Ft(i)?i.toOperationNode():i}var js,Ln,Wn;class yc{constructor(){V(this,js);V(this,Ln);V(this,Wn);et(this,"resolve",e=>{s(this,Ln)&&s(this,Ln).call(this,e)});et(this,"reject",e=>{s(this,Wn)&&s(this,Wn).call(this,e)});G(this,js,new Promise((e,t)=>{G(this,Wn,t),G(this,Ln,e)}))}get promise(){return s(this,js)}}js=new WeakMap,Ln=new WeakMap,Wn=new WeakMap;async function tu(i){const e=new yc,t=new yc;return i.provideConnection(async o=>(e.resolve(o),await t.promise)).catch(o=>e.reject(o)),d({connection:await e.promise,release:t.resolve})}const Mh=d([]);var $r,Vs,za;class iu{constructor(e=Mh){V(this,Vs);V(this,$r);G(this,$r,e)}get plugins(){return s(this,$r)}transformQuery(e,t){for(const o of s(this,$r)){const m=o.transformQuery({node:e,queryId:t});if(m.kind===e.kind)e=m;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${e.kind}`,`but it returned a ${m.kind}`].join(" "))}return e}async executeQuery(e,t){return await this.provideConnection(async o=>{const m=await o.executeQuery(e);return"numUpdatedOrDeletedRows"in m&&ts("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await me(this,Vs,za).call(this,m,t)})}async*stream(e,t,o){const{connection:m,release:M}=await tu(this);try{for await(const L of m.streamQuery(e,t))yield await me(this,Vs,za).call(this,L,o)}finally{M()}}}$r=new WeakMap,Vs=new WeakSet,za=async function(e,t){for(const o of s(this,$r))e=await o.transformResult({result:e,queryId:t});return e};class Mr extends iu{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(e){return new Mr([...this.plugins,e])}withPlugins(e){return new Mr([...this.plugins,...e])}withPluginAtFront(e){return new Mr([e,...this.plugins])}withoutPlugins(){return new Mr([])}}const Zs=new Mr;class ru{constructor(e){et(this,"numChangedRows");this.numChangedRows=e}}var Et;const ur=class ur{constructor(e){V(this,Et);G(this,Et,d(e))}modifyEnd(e){return new ur({...s(this,Et),queryNode:fe.cloneWithEndModifier(s(this,Et).queryNode,e.toOperationNode())})}top(e,t){return new ur({...s(this,Et),queryNode:fe.cloneWithTop(s(this,Et).queryNode,ss(e,t))})}using(...e){return new nr({...s(this,Et),queryNode:Bt.cloneWithUsing(s(this,Et).queryNode,fa("Using",e))})}returning(e){return new ur({...s(this,Et),queryNode:fe.cloneWithReturning(s(this,Et).queryNode,ni(e))})}returningAll(e){return new ur({...s(this,Et),queryNode:fe.cloneWithReturning(s(this,Et).queryNode,ui(e))})}output(e){return new ur({...s(this,Et),queryNode:fe.cloneWithOutput(s(this,Et).queryNode,ni(e))})}outputAll(e){return new ur({...s(this,Et),queryNode:fe.cloneWithOutput(s(this,Et).queryNode,ui(e))})}};Et=new WeakMap;let ko=ur;var Ge,ti,co,Ir;const $i=class $i{constructor(e){V(this,ti);V(this,Ge);G(this,Ge,d(e))}modifyEnd(e){return new $i({...s(this,Ge),queryNode:fe.cloneWithEndModifier(s(this,Ge).queryNode,e.toOperationNode())})}top(e,t){return new $i({...s(this,Ge),queryNode:fe.cloneWithTop(s(this,Ge).queryNode,ss(e,t))})}whenMatched(){return me(this,ti,co).call(this,[])}whenMatchedAnd(...e){return me(this,ti,co).call(this,e)}whenMatchedAndRef(e,t,o){return me(this,ti,co).call(this,[e,t,o],!0)}whenNotMatched(){return me(this,ti,Ir).call(this,[])}whenNotMatchedAnd(...e){return me(this,ti,Ir).call(this,e)}whenNotMatchedAndRef(e,t,o){return me(this,ti,Ir).call(this,[e,t,o],!0)}whenNotMatchedBySource(){return me(this,ti,Ir).call(this,[],!1,!0)}whenNotMatchedBySourceAnd(...e){return me(this,ti,Ir).call(this,e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,o){return me(this,ti,Ir).call(this,[e,t,o],!0,!0)}returning(e){return new $i({...s(this,Ge),queryNode:fe.cloneWithReturning(s(this,Ge).queryNode,ni(e))})}returningAll(e){return new $i({...s(this,Ge),queryNode:fe.cloneWithReturning(s(this,Ge).queryNode,ui(e))})}output(e){return new $i({...s(this,Ge),queryNode:fe.cloneWithOutput(s(this,Ge).queryNode,ni(e))})}outputAll(e){return new $i({...s(this,Ge),queryNode:fe.cloneWithOutput(s(this,Ge).queryNode,ui(e))})}$call(e){return e(this)}$if(e,t){return e?t(this):new $i({...s(this,Ge)})}toOperationNode(){return s(this,Ge).executor.transformQuery(s(this,Ge).queryNode,s(this,Ge).queryId)}compile(){return s(this,Ge).executor.compileQuery(this.toOperationNode(),s(this,Ge).queryId)}async execute(){const e=this.compile(),t=await s(this,Ge).executor.executeQuery(e,s(this,Ge).queryId),{adapter:o}=s(this,Ge).executor,m=e.query;return m.returning&&o.supportsReturning||m.output&&o.supportsOutput?t.rows:[new ru(t.numAffectedRows)]}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=rs){const t=await this.executeTakeFirst();if(t===void 0)throw ns(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}};Ge=new WeakMap,ti=new WeakSet,co=function(e,t){return new $a({...s(this,Ge),queryNode:Bt.cloneWithWhen(s(this,Ge).queryNode,mc({isMatched:!0},e,t))})},Ir=function(e,t=!1,o=!1){const m={...s(this,Ge),queryNode:Bt.cloneWithWhen(s(this,Ge).queryNode,mc({isMatched:!1,bySource:o},e,t))},M=o?$a:nu;return new M(m)};let nr=$i;var yi;class $a{constructor(e){V(this,yi);G(this,yi,d(e))}thenDelete(){return new nr({...s(this,yi),queryNode:Bt.cloneWithThen(s(this,yi).queryNode,ps("delete"))})}thenDoNothing(){return new nr({...s(this,yi),queryNode:Bt.cloneWithThen(s(this,yi).queryNode,ps("do nothing"))})}thenUpdate(e){return new nr({...s(this,yi),queryNode:Bt.cloneWithThen(s(this,yi).queryNode,ps(e(new Ps({queryId:s(this,yi).queryId,executor:Zs,queryNode:rn.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate(t=>t.set(...e))}}yi=new WeakMap;var gr;class nu{constructor(e){V(this,gr);G(this,gr,d(e))}thenDoNothing(){return new nr({...s(this,gr),queryNode:Bt.cloneWithThen(s(this,gr).queryNode,ps("do nothing"))})}thenInsertValues(e){const[t,o]=Qc(e);return new nr({...s(this,gr),queryNode:Bt.cloneWithThen(s(this,gr).queryNode,ps(qt.cloneWith(qt.createWithoutInto(),{columns:t,values:o})))})}}gr=new WeakMap;var Ve;const Lr=class Lr{constructor(e){V(this,Ve);G(this,Ve,d(e))}selectFrom(e){return Ao({queryId:Me(),executor:s(this,Ve).executor,queryNode:Ke.createFrom(In(e),s(this,Ve).withNode)})}selectNoFrom(e){return Ao({queryId:Me(),executor:s(this,Ve).executor,queryNode:Ke.cloneWithSelections(Ke.create(s(this,Ve).withNode),ni(e))})}insertInto(e){return new Fs({queryId:Me(),executor:s(this,Ve).executor,queryNode:qt.create(ft(e),s(this,Ve).withNode)})}replaceInto(e){return new Fs({queryId:Me(),executor:s(this,Ve).executor,queryNode:qt.create(ft(e),s(this,Ve).withNode,!0)})}deleteFrom(e){return new vo({queryId:Me(),executor:s(this,Ve).executor,queryNode:An.create(In(e),s(this,Ve).withNode)})}updateTable(e){return new Ps({queryId:Me(),executor:s(this,Ve).executor,queryNode:rn.create(In(e),s(this,Ve).withNode)})}mergeInto(e){return new ko({queryId:Me(),executor:s(this,Ve).executor,queryNode:Bt.create(yu(e),s(this,Ve).withNode)})}with(e,t){const o=pc(e,t);return new Lr({...s(this,Ve),withNode:s(this,Ve).withNode?hs.cloneWithExpression(s(this,Ve).withNode,o):hs.create(o)})}withRecursive(e,t){const o=pc(e,t);return new Lr({...s(this,Ve),withNode:s(this,Ve).withNode?hs.cloneWithExpression(s(this,Ve).withNode,o):hs.create(o,{recursive:!0})})}withPlugin(e){return new Lr({...s(this,Ve),executor:s(this,Ve).executor.withPlugin(e)})}withoutPlugins(){return new Lr({...s(this,Ve),executor:s(this,Ve).executor.withoutPlugins()})}withSchema(e){return new Lr({...s(this,Ve),executor:s(this,Ve).executor.withPluginAtFront(new hn(e))})}};Ve=new WeakMap;let Ws=Lr;function Uh(){return new Ws({executor:Zs})}function Qh(i,e){return new No({joinNode:tn.create(i,Rs(e))})}function jh(){return new Ua({overNode:bo.create()})}function fa(i,e){if(e.length===3)return zh(i,e[0],e[1],e[2]);if(e.length===2)return Vh(i,e[0],e[1]);if(e.length===1)return $h(i,e[0]);throw new Error("not implemented")}function Vh(i,e,t){return t(Qh(i,e)).toOperationNode()}function zh(i,e,t,o){return tn.createWithOn(i,Rs(e),Di(t,"=",o))}function $h(i,e){return tn.create(i,Rs(e))}const su=d({is(i){return i.kind==="OffsetNode"},create(i){return d({kind:"OffsetNode",offset:i})}}),ou=d({is(i){return i.kind==="GroupByItemNode"},create(i){return d({kind:"GroupByItemNode",groupBy:i})}});function Hh(i){return i=si(i)?i(fn()):i,Is(i).map(ou.create)}const kl=d({is(i){return i.kind==="SetOperationNode"},create(i,e,t){return d({kind:"SetOperationNode",operator:i,expression:e,all:t})}});function gn(i,e,t){return si(e)&&(e=e(Ol())),sr(e)||(e=[e]),e.map(o=>kl.create(i,pn(o),t))}var Yi;const Xo=class Xo{constructor(e){V(this,Yi);G(this,Yi,e)}get expressionType(){}as(e){return new pa(this,e)}or(...e){return new xo(dn.create(s(this,Yi),Tt(e)))}and(...e){return new So(or.create(s(this,Yi),Tt(e)))}$castTo(){return new Xo(s(this,Yi))}$notNull(){return new Xo(s(this,Yi))}toOperationNode(){return s(this,Yi)}};Yi=new WeakMap;let Xe=Xo;var Dn,wr;class pa{constructor(e,t){V(this,Dn);V(this,wr);G(this,Dn,e),G(this,wr,t)}get expression(){return s(this,Dn)}get alias(){return s(this,wr)}toOperationNode(){return Ri.create(s(this,Dn).toOperationNode(),Ft(s(this,wr))?s(this,wr).toOperationNode():Je.create(s(this,wr)))}}Dn=new WeakMap,wr=new WeakMap;var Hr;const Zo=class Zo{constructor(e){V(this,Hr);G(this,Hr,e)}get expressionType(){}as(e){return new pa(this,e)}or(...e){return new Zo(dn.create(s(this,Hr),Tt(e)))}$castTo(){return new Zo(s(this,Hr))}toOperationNode(){return on.create(s(this,Hr))}};Hr=new WeakMap;let xo=Zo;var Jr;const ea=class ea{constructor(e){V(this,Jr);G(this,Jr,e)}get expressionType(){}as(e){return new pa(this,e)}and(...e){return new ea(or.create(s(this,Jr),Tt(e)))}$castTo(){return new ea(s(this,Jr))}toOperationNode(){return on.create(s(this,Jr))}};Jr=new WeakMap;let So=ea;const au={is(i){return i.kind==="FetchNode"},create(i,e){return{kind:"FetchNode",rowCount:ri.create(i),modifier:e}}};function Jh(i,e){if(!ua(i)&&!dl(i))throw new Error(`Invalid fetch row count: ${i}`);if(!Gh(e))throw new Error(`Invalid fetch modifier: ${e}`);return au.create(i,e)}function Gh(i){return i==="only"||i==="with ties"}var ae,Gt,hi;const Ce=class Ce{constructor(e){V(this,Gt);V(this,ae);G(this,ae,d(e))}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new Ce({...s(this,ae),queryNode:fe.cloneWithWhere(s(this,ae).queryNode,Tt(e))})}whereRef(e,t,o){return new Ce({...s(this,ae),queryNode:fe.cloneWithWhere(s(this,ae).queryNode,Di(e,t,o))})}having(...e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithHaving(s(this,ae).queryNode,Tt(e))})}havingRef(e,t,o){return new Ce({...s(this,ae),queryNode:Ke.cloneWithHaving(s(this,ae).queryNode,Di(e,t,o))})}select(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSelections(s(this,ae).queryNode,ni(e))})}distinctOn(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithDistinctOn(s(this,ae).queryNode,Is(e))})}modifyFront(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithFrontModifier(s(this,ae).queryNode,ki.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.createWithExpression(e.toOperationNode()))})}distinct(){return new Ce({...s(this,ae),queryNode:Ke.cloneWithFrontModifier(s(this,ae).queryNode,ki.create("Distinct"))})}forUpdate(e){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("ForUpdate",e?oo(e).map(ft):void 0))})}forShare(e){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("ForShare",e?oo(e).map(ft):void 0))})}forKeyShare(e){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("ForKeyShare",e?oo(e).map(ft):void 0))})}forNoKeyUpdate(e){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("ForNoKeyUpdate",e?oo(e).map(ft):void 0))})}skipLocked(){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("SkipLocked"))})}noWait(){return new Ce({...s(this,ae),queryNode:fe.cloneWithEndModifier(s(this,ae).queryNode,ki.create("NoWait"))})}selectAll(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSelections(s(this,ae).queryNode,ui(e))})}innerJoin(...e){return me(this,Gt,hi).call(this,"InnerJoin",e)}leftJoin(...e){return me(this,Gt,hi).call(this,"LeftJoin",e)}rightJoin(...e){return me(this,Gt,hi).call(this,"RightJoin",e)}fullJoin(...e){return me(this,Gt,hi).call(this,"FullJoin",e)}crossJoin(...e){return me(this,Gt,hi).call(this,"CrossJoin",e)}innerJoinLateral(...e){return me(this,Gt,hi).call(this,"LateralInnerJoin",e)}leftJoinLateral(...e){return me(this,Gt,hi).call(this,"LateralLeftJoin",e)}crossJoinLateral(...e){return me(this,Gt,hi).call(this,"LateralCrossJoin",e)}crossApply(...e){return me(this,Gt,hi).call(this,"CrossApply",e)}outerApply(...e){return me(this,Gt,hi).call(this,"OuterApply",e)}orderBy(...e){return new Ce({...s(this,ae),queryNode:fe.cloneWithOrderByItems(s(this,ae).queryNode,sn(e))})}groupBy(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithGroupByItems(s(this,ae).queryNode,Hh(e))})}limit(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithLimit(s(this,ae).queryNode,ha.create(bt(e)))})}offset(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithOffset(s(this,ae).queryNode,su.create(bt(e)))})}fetch(e,t="only"){return new Ce({...s(this,ae),queryNode:Ke.cloneWithFetch(s(this,ae).queryNode,Jh(e,t))})}top(e,t){return new Ce({...s(this,ae),queryNode:fe.cloneWithTop(s(this,ae).queryNode,ss(e,t))})}union(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("union",e,!1))})}unionAll(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("union",e,!0))})}intersect(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("intersect",e,!1))})}intersectAll(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("intersect",e,!0))})}except(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("except",e,!1))})}exceptAll(e){return new Ce({...s(this,ae),queryNode:Ke.cloneWithSetOperations(s(this,ae).queryNode,gn("except",e,!0))})}as(e){return new Kh(this,e)}clearSelect(){return new Ce({...s(this,ae),queryNode:Ke.cloneWithoutSelections(s(this,ae).queryNode)})}clearWhere(){return new Ce({...s(this,ae),queryNode:fe.cloneWithoutWhere(s(this,ae).queryNode)})}clearLimit(){return new Ce({...s(this,ae),queryNode:Ke.cloneWithoutLimit(s(this,ae).queryNode)})}clearOffset(){return new Ce({...s(this,ae),queryNode:Ke.cloneWithoutOffset(s(this,ae).queryNode)})}clearOrderBy(){return new Ce({...s(this,ae),queryNode:fe.cloneWithoutOrderBy(s(this,ae).queryNode)})}clearGroupBy(){return new Ce({...s(this,ae),queryNode:Ke.cloneWithoutGroupBy(s(this,ae).queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new Ce({...s(this,ae)})}$castTo(){return new Ce(s(this,ae))}$narrowType(){return new Ce(s(this,ae))}$assertType(){return new Ce(s(this,ae))}$asTuple(){return new Xe(this.toOperationNode())}$asScalar(){return new Xe(this.toOperationNode())}withPlugin(e){return new Ce({...s(this,ae),executor:s(this,ae).executor.withPlugin(e)})}toOperationNode(){return s(this,ae).executor.transformQuery(s(this,ae).queryNode,s(this,ae).queryId)}compile(){return s(this,ae).executor.compileQuery(this.toOperationNode(),s(this,ae).queryId)}async execute(){const e=this.compile();return(await s(this,ae).executor.executeQuery(e,s(this,ae).queryId)).rows}async executeTakeFirst(){const[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=rs){const t=await this.executeTakeFirst();if(t===void 0)throw ns(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async*stream(e=100){const t=this.compile(),o=s(this,ae).executor.stream(t,e,s(this,ae).queryId);for await(const m of o)yield*m.rows}async explain(e,t){return await new Ce({...s(this,ae),queryNode:fe.cloneWithExplain(s(this,ae).queryNode,e,t)}).execute()}};ae=new WeakMap,Gt=new WeakSet,hi=function(e,t){return new Ce({...s(this,ae),queryNode:fe.cloneWithJoin(s(this,ae).queryNode,fa(e,t))})};let Ha=Ce;function Ao(i){return new Ha(i)}var Rn,Bn;class Kh{constructor(e,t){V(this,Rn);V(this,Bn);G(this,Rn,e),G(this,Bn,t)}get expression(){return s(this,Rn)}get alias(){return s(this,Bn)}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return Ri.create(s(this,Rn).toOperationNode(),Je.create(s(this,Bn)))}}Rn=new WeakMap,Bn=new WeakMap;const rr=d({is(i){return i.kind==="AggregateFunctionNode"},create(i,e=[]){return d({kind:"AggregateFunctionNode",func:i,aggregated:e})},cloneWithDistinct(i){return d({...i,distinct:!0})},cloneWithOrderBy(i,e,t=!1){const o=t?"withinGroup":"orderBy";return d({...i,[o]:i[o]?an.cloneWithItems(i[o],e):an.create(e)})},cloneWithFilter(i,e){return d({...i,filter:i.filter?Rt.cloneWithOperation(i.filter,"And",e):Rt.create(e)})},cloneWithOrFilter(i,e){return d({...i,filter:i.filter?Rt.cloneWithOperation(i.filter,"Or",e):Rt.create(e)})},cloneWithOver(i,e){return d({...i,over:e})}}),Ja=d({is(i){return i.kind==="FunctionNode"},create(i,e){return d({kind:"FunctionNode",func:i,arguments:e})}});var mt;const fi=class fi{constructor(e){V(this,mt);G(this,mt,d(e))}get expressionType(){}as(e){return new lu(this,e)}distinct(){return new fi({...s(this,mt),aggregateFunctionNode:rr.cloneWithDistinct(s(this,mt).aggregateFunctionNode)})}orderBy(...e){return new fi({...s(this,mt),aggregateFunctionNode:fe.cloneWithOrderByItems(s(this,mt).aggregateFunctionNode,sn(e))})}clearOrderBy(){return new fi({...s(this,mt),aggregateFunctionNode:fe.cloneWithoutOrderBy(s(this,mt).aggregateFunctionNode)})}withinGroupOrderBy(...e){return new fi({...s(this,mt),aggregateFunctionNode:rr.cloneWithOrderBy(s(this,mt).aggregateFunctionNode,sn(e),!0)})}filterWhere(...e){return new fi({...s(this,mt),aggregateFunctionNode:rr.cloneWithFilter(s(this,mt).aggregateFunctionNode,Tt(e))})}filterWhereRef(e,t,o){return new fi({...s(this,mt),aggregateFunctionNode:rr.cloneWithFilter(s(this,mt).aggregateFunctionNode,Di(e,t,o))})}over(e){const t=jh();return new fi({...s(this,mt),aggregateFunctionNode:rr.cloneWithOver(s(this,mt).aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new fi(s(this,mt))}$notNull(){return new fi(s(this,mt))}toOperationNode(){return s(this,mt).aggregateFunctionNode}};mt=new WeakMap;let Cn=fi;var Mn,Un;class lu{constructor(e,t){V(this,Mn);V(this,Un);G(this,Mn,e),G(this,Un,t)}get expression(){return s(this,Mn)}get alias(){return s(this,Un)}toOperationNode(){return Ri.create(s(this,Mn).toOperationNode(),Je.create(s(this,Un)))}}Mn=new WeakMap,Un=new WeakMap;function xl(){const i=(t,o)=>new Xe(Ja.create(t,Is(o??[]))),e=(t,o)=>new Cn({aggregateFunctionNode:rr.create(t,o?Is(o):void 0)});return Object.assign(i,{agg:e,avg(t){return e("avg",[t])},coalesce(...t){return i("coalesce",t)},count(t){return e("count",[t])},countAll(t){return new Cn({aggregateFunctionNode:rr.create("count",ui(t))})},max(t){return e("max",[t])},min(t){return e("min",[t])},sum(t){return e("sum",[t])},any(t){return i("any",[t])},jsonAgg(t){return new Cn({aggregateFunctionNode:rr.create("json_agg",[Mt(t)?ft(t):t.toOperationNode()])})},toJson(t){return new Xe(Ja.create("to_json",[Mt(t)?ft(t):t.toOperationNode()]))}})}const cu=d({is(i){return i.kind==="UnaryOperationNode"},create(i,e){return d({kind:"UnaryOperationNode",operator:i,operand:e})}});function Yh(i,e){return cu.create(ar.create(i),ii(e))}const Ei=d({is(i){return i.kind==="CaseNode"},create(i){return d({kind:"CaseNode",value:i})},cloneWithWhen(i,e){return d({...i,when:d(i.when?[...i.when,e]:[e])})},cloneWithThen(i,e){return d({...i,when:i.when?d([...i.when.slice(0,-1),is.cloneWithResult(i.when[i.when.length-1],e)]):void 0})},cloneWith(i,e){return d({...i,...e})}});var Qn;class Sl{constructor(e){V(this,Qn);G(this,Qn,d(e))}when(...e){return new Al({...s(this,Qn),node:Ei.cloneWithWhen(s(this,Qn).node,is.create(Tt(e)))})}}Qn=new WeakMap;var jn;class Al{constructor(e){V(this,jn);G(this,jn,d(e))}then(e){return new uu({...s(this,jn),node:Ei.cloneWithThen(s(this,jn).node,gl(e)?wl(e):bt(e))})}}jn=new WeakMap;var Ai;class uu{constructor(e){V(this,Ai);G(this,Ai,d(e))}when(...e){return new Al({...s(this,Ai),node:Ei.cloneWithWhen(s(this,Ai).node,is.create(Tt(e)))})}else(e){return new du({...s(this,Ai),node:Ei.cloneWith(s(this,Ai).node,{else:gl(e)?wl(e):bt(e)})})}end(){return new Xe(Ei.cloneWith(s(this,Ai).node,{isStatement:!1}))}endCase(){return new Xe(Ei.cloneWith(s(this,Ai).node,{isStatement:!0}))}}Ai=new WeakMap;var Vn;class du{constructor(e){V(this,Vn);G(this,Vn,d(e))}end(){return new Xe(Ei.cloneWith(s(this,Vn).node,{isStatement:!1}))}endCase(){return new Xe(Ei.cloneWith(s(this,Vn).node,{isStatement:!0}))}}Vn=new WeakMap;const Ga=d({is(i){return i.kind==="JSONPathLegNode"},create(i,e){return d({kind:"JSONPathLegNode",type:i,value:e})}});var Oi,zs,Ka;class Oo{constructor(e){V(this,zs);V(this,Oi);G(this,Oi,e)}at(e){return me(this,zs,Ka).call(this,"ArrayLocation",e)}key(e){return me(this,zs,Ka).call(this,"Member",e)}}Oi=new WeakMap,zs=new WeakSet,Ka=function(e,t){return Cs.is(s(this,Oi))?new Ds(Cs.cloneWithTraversal(s(this,Oi),Sn.is(s(this,Oi).traversal)?Sn.cloneWithLeg(s(this,Oi).traversal,Ga.create(e,t)):_l.cloneWithValue(s(this,Oi).traversal,ri.createImmediate(t)))):new Ds(Sn.cloneWithLeg(s(this,Oi),Ga.create(e,t)))};var Gr;const ta=class ta extends Oo{constructor(t){super(t);V(this,Gr);G(this,Gr,t)}get expressionType(){}as(t){return new hu(this,t)}$castTo(){return new ta(s(this,Gr))}$notNull(){return new ta(s(this,Gr))}toOperationNode(){return s(this,Gr)}};Gr=new WeakMap;let Ds=ta;var zn,br;class hu{constructor(e,t){V(this,zn);V(this,br);G(this,zn,e),G(this,br,t)}get expression(){return s(this,zn)}get alias(){return s(this,br)}toOperationNode(){return Ri.create(s(this,zn).toOperationNode(),Ft(s(this,br))?s(this,br).toOperationNode():Je.create(s(this,br)))}}zn=new WeakMap,br=new WeakMap;const Ya=d({is(i){return i.kind==="TupleNode"},create(i){return d({kind:"TupleNode",values:d(i)})}}),Xh=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],Zh=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],fu=d({is(i){return i.kind==="DataTypeNode"},create(i){return d({kind:"DataTypeNode",dataType:i})}});function pu(i){return!!(Xh.includes(i)||Zh.some(e=>e.test(i)))}function ln(i){if(Ft(i))return i.toOperationNode();if(pu(i))return fu.create(i);throw new Error(`invalid column data type ${JSON.stringify(i)}`)}const _u=d({is(i){return i.kind==="CastNode"},create(i,e){return d({kind:"CastNode",expression:i,dataType:e})}});function Ol(i=Zs){function e(m,M,L){return new Xe(bl(m,M,L))}function t(m,M){return new Xe(Yh(m,M))}const o=Object.assign(e,{fn:void 0,eb:void 0,selectFrom(m){return Ao({queryId:Me(),executor:i,queryNode:Ke.createFrom(In(m))})},case(m){return new Sl({node:Ei.create(kr(m)?void 0:ii(m))})},ref(m,M){return kr(M)?new Xe(lr(m)):new Oo(bh(m,M))},jsonPath(){return new Oo(Sn.create())},table(m){return new Xe(ft(m))},val(m){return new Xe(bt(m))},refTuple(...m){return new Xe(Ya.create(m.map(ii)))},tuple(...m){return new Xe(Ya.create(m.map(bt)))},lit(m){return new Xe(wl(m))},unary:t,not(m){return t("not",m)},exists(m){return t("exists",m)},neg(m){return t("-",m)},between(m,M,L){return new Xe(nn.create(ii(m),ar.create("between"),or.create(bt(M),bt(L))))},betweenSymmetric(m,M,L){return new Xe(nn.create(ii(m),ar.create("between symmetric"),or.create(bt(M),bt(L))))},and(m){return sr(m)?new Xe(wo(m,"and")):new Xe(uc(m,"and"))},or(m){return sr(m)?new Xe(wo(m,"or")):new Xe(uc(m,"or"))},parens(...m){const M=Tt(m);return on.is(M)?new Xe(M):new Xe(on.create(M))},cast(m,M){return new Xe(_u.create(ii(m),ln(M)))},withSchema(m){return Ol(i.withPluginAtFront(new hn(m)))}});return o.fn=xl(),o.eb=o,o}function fn(i){return Ol()}function pn(i){if(Ft(i))return i.toOperationNode();if(si(i))return i(fn()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(i)}`)}function mu(i){if(Ft(i))return i.toOperationNode();if(si(i))return i(fn()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(i)}`)}function eo(i){return fl(i)||vc(i)||si(i)}var $n;class ef{constructor(e){V(this,$n);G(this,$n,e)}get table(){return s(this,$n)}as(e){return new tf(s(this,$n),e)}}$n=new WeakMap;var Hn,Jn;class tf{constructor(e,t){V(this,Hn);V(this,Jn);G(this,Hn,e),G(this,Jn,t)}get table(){return s(this,Hn)}get alias(){return s(this,Jn)}toOperationNode(){return Ri.create(ft(s(this,Hn)),Je.create(s(this,Jn)))}}Hn=new WeakMap,Jn=new WeakMap;function rf(i){return qi(i)&&Ft(i)&&Mt(i.table)&&Mt(i.alias)}function In(i){return sr(i)?i.map(e=>Rs(e)):[Rs(i)]}function Rs(i){return Mt(i)?yu(i):rf(i)?i.toOperationNode():mu(i)}function yu(i){const e=" as ";if(i.includes(e)){const[t,o]=i.split(e).map(gu);return Ri.create(ft(t),Je.create(o))}else return ft(i)}function ft(i){const e=".";if(i.includes(e)){const[t,o]=i.split(e).map(gu);return Li.createWithSchema(t,o)}else return Li.create(i)}function gu(i){return i.trim()}const Cl=d({is(i){return i.kind==="AddColumnNode"},create(i){return d({kind:"AddColumnNode",column:i})}}),st=d({is(i){return i.kind==="ColumnDefinitionNode"},create(i,e){return d({kind:"ColumnDefinitionNode",column:pt.create(i),dataType:e})},cloneWithFrontModifier(i,e){return d({...i,frontModifiers:i.frontModifiers?d([...i.frontModifiers,e]):[e]})},cloneWithEndModifier(i,e){return d({...i,endModifiers:i.endModifiers?d([...i.endModifiers,e]):[e]})},cloneWith(i,e){return d({...i,...e})}}),Il=d({is(i){return i.kind==="DropColumnNode"},create(i){return d({kind:"DropColumnNode",column:pt.create(i)})}}),Tl=d({is(i){return i.kind==="RenameColumnNode"},create(i,e){return d({kind:"RenameColumnNode",column:pt.create(i),renameTo:pt.create(e)})}}),_a=d({is(i){return i.kind==="CheckConstraintNode"},create(i,e){return d({kind:"CheckConstraintNode",expression:i,name:e?Je.create(e):void 0})}}),wu=["no action","restrict","cascade","set null","set default"],_s=d({is(i){return i.kind==="ReferencesNode"},create(i,e){return d({kind:"ReferencesNode",table:i,columns:d([...e])})},cloneWithOnDelete(i,e){return d({...i,onDelete:e})},cloneWithOnUpdate(i,e){return d({...i,onUpdate:e})}});function bu(i){return Ft(i)?i.toOperationNode():ri.createImmediate(i)}const fs=d({is(i){return i.kind==="GeneratedNode"},create(i){return d({kind:"GeneratedNode",...i})},createWithExpression(i){return d({kind:"GeneratedNode",always:!0,expression:i})},cloneWith(i,e){return d({...i,...e})}}),Nu=d({is(i){return i.kind==="DefaultValueNode"},create(i){return d({kind:"DefaultValueNode",defaultValue:i})}});function Co(i){if(wu.includes(i))return i;throw new Error(`invalid OnModifyForeignAction ${i}`)}var ze;const _t=class _t{constructor(e){V(this,ze);G(this,ze,e)}autoIncrement(){return new _t(st.cloneWith(s(this,ze),{autoIncrement:!0}))}identity(){return new _t(st.cloneWith(s(this,ze),{identity:!0}))}primaryKey(){return new _t(st.cloneWith(s(this,ze),{primaryKey:!0}))}references(e){const t=lr(e);if(!t.table||da.is(t.column))throw new Error(`invalid call references('${e}'). The reference must have format table.column or schema.table.column`);return new _t(st.cloneWith(s(this,ze),{references:_s.create(t.table,[t.column])}))}onDelete(e){if(!s(this,ze).references)throw new Error("on delete constraint can only be added for foreign keys");return new _t(st.cloneWith(s(this,ze),{references:_s.cloneWithOnDelete(s(this,ze).references,Co(e))}))}onUpdate(e){if(!s(this,ze).references)throw new Error("on update constraint can only be added for foreign keys");return new _t(st.cloneWith(s(this,ze),{references:_s.cloneWithOnUpdate(s(this,ze).references,Co(e))}))}unique(){return new _t(st.cloneWith(s(this,ze),{unique:!0}))}notNull(){return new _t(st.cloneWith(s(this,ze),{notNull:!0}))}unsigned(){return new _t(st.cloneWith(s(this,ze),{unsigned:!0}))}defaultTo(e){return new _t(st.cloneWith(s(this,ze),{defaultTo:Nu.create(bu(e))}))}check(e){return new _t(st.cloneWith(s(this,ze),{check:_a.create(e.toOperationNode())}))}generatedAlwaysAs(e){return new _t(st.cloneWith(s(this,ze),{generated:fs.createWithExpression(e.toOperationNode())}))}generatedAlwaysAsIdentity(){return new _t(st.cloneWith(s(this,ze),{generated:fs.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new _t(st.cloneWith(s(this,ze),{generated:fs.create({identity:!0,byDefault:!0})}))}stored(){if(!s(this,ze).generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new _t(st.cloneWith(s(this,ze),{generated:fs.cloneWith(s(this,ze).generated,{stored:!0})}))}modifyFront(e){return new _t(st.cloneWithFrontModifier(s(this,ze),e.toOperationNode()))}nullsNotDistinct(){return new _t(st.cloneWith(s(this,ze),{nullsNotDistinct:!0}))}ifNotExists(){return new _t(st.cloneWith(s(this,ze),{ifNotExists:!0}))}modifyEnd(e){return new _t(st.cloneWithEndModifier(s(this,ze),e.toOperationNode()))}$call(e){return e(this)}toOperationNode(){return s(this,ze)}};ze=new WeakMap;let xr=_t;const Fl=d({is(i){return i.kind==="ModifyColumnNode"},create(i){return d({kind:"ModifyColumnNode",column:i})}}),Ji=d({is(i){return i.kind==="ForeignKeyConstraintNode"},create(i,e,t,o){return d({kind:"ForeignKeyConstraintNode",columns:i,references:_s.create(e,t),name:o?Je.create(o):void 0})},cloneWith(i,e){return d({...i,...e})}});var gi;const dr=class dr{constructor(e){V(this,gi);G(this,gi,e)}onDelete(e){return new dr(Ji.cloneWith(s(this,gi),{onDelete:Co(e)}))}onUpdate(e){return new dr(Ji.cloneWith(s(this,gi),{onUpdate:Co(e)}))}deferrable(){return new dr(Ji.cloneWith(s(this,gi),{deferrable:!0}))}notDeferrable(){return new dr(Ji.cloneWith(s(this,gi),{deferrable:!1}))}initiallyDeferred(){return new dr(Ji.cloneWith(s(this,gi),{initiallyDeferred:!0}))}initiallyImmediate(){return new dr(Ji.cloneWith(s(this,gi),{initiallyDeferred:!1}))}$call(e){return e(this)}toOperationNode(){return s(this,gi)}};gi=new WeakMap;let Bs=dr;const ms=d({is(i){return i.kind==="AddConstraintNode"},create(i){return d({kind:"AddConstraintNode",constraint:i})}}),_r=d({is(i){return i.kind==="UniqueConstraintNode"},create(i,e,t){return d({kind:"UniqueConstraintNode",columns:d(i.map(pt.create)),name:e?Je.create(e):void 0,nullsNotDistinct:t})},cloneWith(i,e){return d({...i,...e})}}),ys=d({is(i){return i.kind==="DropConstraintNode"},create(i){return d({kind:"DropConstraintNode",constraintName:Je.create(i)})},cloneWith(i,e){return d({...i,...e})}}),bn=d({is(i){return i.kind==="AlterColumnNode"},create(i,e,t){return d({kind:"AlterColumnNode",column:pt.create(i),[e]:t})}});var Xi;class Pl{constructor(e){V(this,Xi);G(this,Xi,e)}setDataType(e){return new Nn(bn.create(s(this,Xi),"dataType",ln(e)))}setDefault(e){return new Nn(bn.create(s(this,Xi),"setDefault",bu(e)))}dropDefault(){return new Nn(bn.create(s(this,Xi),"dropDefault",!0))}setNotNull(){return new Nn(bn.create(s(this,Xi),"setNotNull",!0))}dropNotNull(){return new Nn(bn.create(s(this,Xi),"dropNotNull",!0))}$call(e){return e(this)}}Xi=new WeakMap;var $s;class Nn{constructor(e){V(this,$s);G(this,$s,e)}toOperationNode(){return s(this,$s)}}$s=new WeakMap;var wi;class wn{constructor(e){V(this,wi);G(this,wi,d(e))}toOperationNode(){return s(this,wi).executor.transformQuery(s(this,wi).node,s(this,wi).queryId)}compile(){return s(this,wi).executor.compileQuery(this.toOperationNode(),s(this,wi).queryId)}async execute(){await s(this,wi).executor.executeQuery(this.compile(),s(this,wi).queryId)}}wi=new WeakMap;var lt;const hr=class hr{constructor(e){V(this,lt);G(this,lt,d(e))}onDelete(e){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.onDelete(e)})}onUpdate(e){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.onUpdate(e)})}deferrable(){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.deferrable()})}notDeferrable(){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.notDeferrable()})}initiallyDeferred(){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.initiallyDeferred()})}initiallyImmediate(){return new hr({...s(this,lt),constraintBuilder:s(this,lt).constraintBuilder.initiallyImmediate()})}$call(e){return e(this)}toOperationNode(){return s(this,lt).executor.transformQuery(He.cloneWithTableProps(s(this,lt).node,{addConstraint:ms.create(s(this,lt).constraintBuilder.toOperationNode())}),s(this,lt).queryId)}compile(){return s(this,lt).executor.compileQuery(this.toOperationNode(),s(this,lt).queryId)}async execute(){await s(this,lt).executor.executeQuery(this.compile(),s(this,lt).queryId)}};lt=new WeakMap;let Xa=hr;var wt;const vs=class vs{constructor(e){V(this,wt);G(this,wt,d(e))}ifExists(){return new vs({...s(this,wt),node:He.cloneWithTableProps(s(this,wt).node,{dropConstraint:ys.cloneWith(s(this,wt).node.dropConstraint,{ifExists:!0})})})}cascade(){return new vs({...s(this,wt),node:He.cloneWithTableProps(s(this,wt).node,{dropConstraint:ys.cloneWith(s(this,wt).node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new vs({...s(this,wt),node:He.cloneWithTableProps(s(this,wt).node,{dropConstraint:ys.cloneWith(s(this,wt).node.dropConstraint,{modifier:"restrict"})})})}$call(e){return e(this)}toOperationNode(){return s(this,wt).executor.transformQuery(s(this,wt).node,s(this,wt).queryId)}compile(){return s(this,wt).executor.compileQuery(this.toOperationNode(),s(this,wt).queryId)}async execute(){await s(this,wt).executor.executeQuery(this.compile(),s(this,wt).queryId)}};wt=new WeakMap;let Io=vs;const Ur=d({is(i){return i.kind==="PrimaryKeyConstraintNode"},create(i,e){return d({kind:"PrimaryKeyConstraintNode",columns:d(i.map(pt.create)),name:e?Je.create(e):void 0})},cloneWith(i,e){return d({...i,...e})}}),Tr=d({is(i){return i.kind==="AddIndexNode"},create(i){return d({kind:"AddIndexNode",name:Je.create(i)})},cloneWith(i,e){return d({...i,...e})},cloneWithColumns(i,e){return d({...i,columns:[...i.columns||[],...e]})}});var it;const Wr=class Wr{constructor(e){V(this,it);G(this,it,d(e))}unique(){return new Wr({...s(this,it),node:He.cloneWithTableProps(s(this,it).node,{addIndex:Tr.cloneWith(s(this,it).node.addIndex,{unique:!0})})})}column(e){return new Wr({...s(this,it),node:He.cloneWithTableProps(s(this,it).node,{addIndex:Tr.cloneWithColumns(s(this,it).node.addIndex,[go(e)])})})}columns(e){return new Wr({...s(this,it),node:He.cloneWithTableProps(s(this,it).node,{addIndex:Tr.cloneWithColumns(s(this,it).node.addIndex,e.map(go))})})}expression(e){return new Wr({...s(this,it),node:He.cloneWithTableProps(s(this,it).node,{addIndex:Tr.cloneWithColumns(s(this,it).node.addIndex,[e.toOperationNode()])})})}using(e){return new Wr({...s(this,it),node:He.cloneWithTableProps(s(this,it).node,{addIndex:Tr.cloneWith(s(this,it).node.addIndex,{using:ht.createWithSql(e)})})})}$call(e){return e(this)}toOperationNode(){return s(this,it).executor.transformQuery(s(this,it).node,s(this,it).queryId)}compile(){return s(this,it).executor.compileQuery(this.toOperationNode(),s(this,it).queryId)}async execute(){await s(this,it).executor.executeQuery(this.compile(),s(this,it).queryId)}};it=new WeakMap;let Za=Wr;var Ci;const Dr=class Dr{constructor(e){V(this,Ci);G(this,Ci,e)}nullsNotDistinct(){return new Dr(_r.cloneWith(s(this,Ci),{nullsNotDistinct:!0}))}deferrable(){return new Dr(_r.cloneWith(s(this,Ci),{deferrable:!0}))}notDeferrable(){return new Dr(_r.cloneWith(s(this,Ci),{deferrable:!1}))}initiallyDeferred(){return new Dr(_r.cloneWith(s(this,Ci),{initiallyDeferred:!0}))}initiallyImmediate(){return new Dr(_r.cloneWith(s(this,Ci),{initiallyDeferred:!1}))}$call(e){return e(this)}toOperationNode(){return s(this,Ci)}};Ci=new WeakMap;let To=Dr;var Zi;const En=class En{constructor(e){V(this,Zi);G(this,Zi,e)}deferrable(){return new En(Ur.cloneWith(s(this,Zi),{deferrable:!0}))}notDeferrable(){return new En(Ur.cloneWith(s(this,Zi),{deferrable:!1}))}initiallyDeferred(){return new En(Ur.cloneWith(s(this,Zi),{initiallyDeferred:!0}))}initiallyImmediate(){return new En(Ur.cloneWith(s(this,Zi),{initiallyDeferred:!1}))}$call(e){return e(this)}toOperationNode(){return s(this,Zi)}};Zi=new WeakMap;let Fo=En;var Hs;class qu{constructor(e){V(this,Hs);G(this,Hs,e)}$call(e){return e(this)}toOperationNode(){return s(this,Hs)}}Hs=new WeakMap;const Eu=d({is(i){return i.kind==="RenameConstraintNode"},create(i,e){return d({kind:"RenameConstraintNode",oldName:Je.create(i),newName:Je.create(e)})}});var Re;class vu{constructor(e){V(this,Re);G(this,Re,d(e))}renameTo(e){return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{renameTo:ft(e)})})}setSchema(e){return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{setSchema:Je.create(e)})})}alterColumn(e,t){const o=t(new Pl(e));return new mr({...s(this,Re),node:He.cloneWithColumnAlteration(s(this,Re).node,o.toOperationNode())})}dropColumn(e){return new mr({...s(this,Re),node:He.cloneWithColumnAlteration(s(this,Re).node,Il.create(e))})}renameColumn(e,t){return new mr({...s(this,Re),node:He.cloneWithColumnAlteration(s(this,Re).node,Tl.create(e,t))})}addColumn(e,t,o=ei){const m=o(new xr(st.create(e,ln(t))));return new mr({...s(this,Re),node:He.cloneWithColumnAlteration(s(this,Re).node,Cl.create(m.toOperationNode()))})}modifyColumn(e,t,o=ei){const m=o(new xr(st.create(e,ln(t))));return new mr({...s(this,Re),node:He.cloneWithColumnAlteration(s(this,Re).node,Fl.create(m.toOperationNode()))})}addUniqueConstraint(e,t,o=ei){const m=o(new To(_r.create(t,e)));return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{addConstraint:ms.create(m.toOperationNode())})})}addCheckConstraint(e,t,o=ei){const m=o(new qu(_a.create(t.toOperationNode(),e)));return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{addConstraint:ms.create(m.toOperationNode())})})}addForeignKeyConstraint(e,t,o,m,M=ei){const L=M(new Bs(Ji.create(t.map(pt.create),ft(o),m.map(pt.create),e)));return new Xa({...s(this,Re),constraintBuilder:L})}addPrimaryKeyConstraint(e,t,o=ei){const m=o(new Fo(Ur.create(t,e)));return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{addConstraint:ms.create(m.toOperationNode())})})}dropConstraint(e){return new Io({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{dropConstraint:ys.create(e)})})}renameConstraint(e,t){return new Io({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{renameConstraint:Eu.create(e,t)})})}addIndex(e){return new Za({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{addIndex:Tr.create(e)})})}dropIndex(e){return new wn({...s(this,Re),node:He.cloneWithTableProps(s(this,Re).node,{dropIndex:xn.create(e)})})}$call(e){return e(this)}}Re=new WeakMap;var yt;const Rr=class Rr{constructor(e){V(this,yt);G(this,yt,d(e))}alterColumn(e,t){const o=t(new Pl(e));return new Rr({...s(this,yt),node:He.cloneWithColumnAlteration(s(this,yt).node,o.toOperationNode())})}dropColumn(e){return new Rr({...s(this,yt),node:He.cloneWithColumnAlteration(s(this,yt).node,Il.create(e))})}renameColumn(e,t){return new Rr({...s(this,yt),node:He.cloneWithColumnAlteration(s(this,yt).node,Tl.create(e,t))})}addColumn(e,t,o=ei){const m=o(new xr(st.create(e,ln(t))));return new Rr({...s(this,yt),node:He.cloneWithColumnAlteration(s(this,yt).node,Cl.create(m.toOperationNode()))})}modifyColumn(e,t,o=ei){const m=o(new xr(st.create(e,ln(t))));return new Rr({...s(this,yt),node:He.cloneWithColumnAlteration(s(this,yt).node,Fl.create(m.toOperationNode()))})}toOperationNode(){return s(this,yt).executor.transformQuery(s(this,yt).node,s(this,yt).queryId)}compile(){return s(this,yt).executor.compileQuery(this.toOperationNode(),s(this,yt).queryId)}async execute(){await s(this,yt).executor.executeQuery(this.compile(),s(this,yt).queryId)}};yt=new WeakMap;let mr=Rr;class ku extends vl{transformPrimitiveValueList(e){return Xs.create(e.values.map(ri.createImmediate))}transformValue(e){return ri.createImmediate(e.value)}}var $e;const pi=class pi{constructor(e){V(this,$e);G(this,$e,d(e))}ifNotExists(){return new pi({...s(this,$e),node:xi.cloneWith(s(this,$e).node,{ifNotExists:!0})})}unique(){return new pi({...s(this,$e),node:xi.cloneWith(s(this,$e).node,{unique:!0})})}nullsNotDistinct(){return new pi({...s(this,$e),node:xi.cloneWith(s(this,$e).node,{nullsNotDistinct:!0})})}on(e){return new pi({...s(this,$e),node:xi.cloneWith(s(this,$e).node,{table:ft(e)})})}column(e){return new pi({...s(this,$e),node:xi.cloneWithColumns(s(this,$e).node,[go(e)])})}columns(e){return new pi({...s(this,$e),node:xi.cloneWithColumns(s(this,$e).node,e.map(go))})}expression(e){return new pi({...s(this,$e),node:xi.cloneWithColumns(s(this,$e).node,[e.toOperationNode()])})}using(e){return new pi({...s(this,$e),node:xi.cloneWith(s(this,$e).node,{using:ht.createWithSql(e)})})}where(...e){const t=new ku;return new pi({...s(this,$e),node:fe.cloneWithWhere(s(this,$e).node,t.transformNode(Tt(e),s(this,$e).queryId))})}$call(e){return e(this)}toOperationNode(){return s(this,$e).executor.transformQuery(s(this,$e).node,s(this,$e).queryId)}compile(){return s(this,$e).executor.compileQuery(this.toOperationNode(),s(this,$e).queryId)}async execute(){await s(this,$e).executor.executeQuery(this.compile(),s(this,$e).queryId)}};$e=new WeakMap;let Po=pi;var Kt;const zl=class zl{constructor(e){V(this,Kt);G(this,Kt,d(e))}ifNotExists(){return new zl({...s(this,Kt),node:hl.cloneWith(s(this,Kt).node,{ifNotExists:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Kt).executor.transformQuery(s(this,Kt).node,s(this,Kt).queryId)}compile(){return s(this,Kt).executor.compileQuery(this.toOperationNode(),s(this,Kt).queryId)}async execute(){await s(this,Kt).executor.executeQuery(this.compile(),s(this,Kt).queryId)}};Kt=new WeakMap;let Lo=zl;function nf(i){if(Ec.includes(i))return i;throw new Error(`invalid OnCommitAction ${i}`)}var Be;const Jt=class Jt{constructor(e){V(this,Be);G(this,Be,d(e))}temporary(){return new Jt({...s(this,Be),node:jt.cloneWith(s(this,Be).node,{temporary:!0})})}onCommit(e){return new Jt({...s(this,Be),node:jt.cloneWith(s(this,Be).node,{onCommit:nf(e)})})}ifNotExists(){return new Jt({...s(this,Be),node:jt.cloneWith(s(this,Be).node,{ifNotExists:!0})})}addColumn(e,t,o=ei){const m=o(new xr(st.create(e,ln(t))));return new Jt({...s(this,Be),node:jt.cloneWithColumn(s(this,Be).node,m.toOperationNode())})}addPrimaryKeyConstraint(e,t,o=ei){const m=o(new Fo(Ur.create(t,e)));return new Jt({...s(this,Be),node:jt.cloneWithConstraint(s(this,Be).node,m.toOperationNode())})}addUniqueConstraint(e,t,o=ei){const m=o(new To(_r.create(t,e)));return new Jt({...s(this,Be),node:jt.cloneWithConstraint(s(this,Be).node,m.toOperationNode())})}addCheckConstraint(e,t,o=ei){const m=o(new qu(_a.create(t.toOperationNode(),e)));return new Jt({...s(this,Be),node:jt.cloneWithConstraint(s(this,Be).node,m.toOperationNode())})}addForeignKeyConstraint(e,t,o,m,M=ei){const L=M(new Bs(Ji.create(t.map(pt.create),ft(o),m.map(pt.create),e)));return new Jt({...s(this,Be),node:jt.cloneWithConstraint(s(this,Be).node,L.toOperationNode())})}modifyFront(e){return new Jt({...s(this,Be),node:jt.cloneWithFrontModifier(s(this,Be).node,e.toOperationNode())})}modifyEnd(e){return new Jt({...s(this,Be),node:jt.cloneWithEndModifier(s(this,Be).node,e.toOperationNode())})}as(e){return new Jt({...s(this,Be),node:jt.cloneWith(s(this,Be).node,{selectQuery:pn(e)})})}$call(e){return e(this)}toOperationNode(){return s(this,Be).executor.transformQuery(s(this,Be).node,s(this,Be).queryId)}compile(){return s(this,Be).executor.compileQuery(this.toOperationNode(),s(this,Be).queryId)}async execute(){await s(this,Be).executor.executeQuery(this.compile(),s(this,Be).queryId)}};Be=new WeakMap;let Wo=Jt;var At;const ks=class ks{constructor(e){V(this,At);G(this,At,d(e))}on(e){return new ks({...s(this,At),node:xn.cloneWith(s(this,At).node,{table:ft(e)})})}ifExists(){return new ks({...s(this,At),node:xn.cloneWith(s(this,At).node,{ifExists:!0})})}cascade(){return new ks({...s(this,At),node:xn.cloneWith(s(this,At).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,At).executor.transformQuery(s(this,At).node,s(this,At).queryId)}compile(){return s(this,At).executor.compileQuery(this.toOperationNode(),s(this,At).queryId)}async execute(){await s(this,At).executor.executeQuery(this.compile(),s(this,At).queryId)}};At=new WeakMap;let Do=ks;var Lt;const ia=class ia{constructor(e){V(this,Lt);G(this,Lt,d(e))}ifExists(){return new ia({...s(this,Lt),node:_o.cloneWith(s(this,Lt).node,{ifExists:!0})})}cascade(){return new ia({...s(this,Lt),node:_o.cloneWith(s(this,Lt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Lt).executor.transformQuery(s(this,Lt).node,s(this,Lt).queryId)}compile(){return s(this,Lt).executor.compileQuery(this.toOperationNode(),s(this,Lt).queryId)}async execute(){await s(this,Lt).executor.executeQuery(this.compile(),s(this,Lt).queryId)}};Lt=new WeakMap;let Ro=ia;var Wt;const ra=class ra{constructor(e){V(this,Wt);G(this,Wt,d(e))}ifExists(){return new ra({...s(this,Wt),node:mo.cloneWith(s(this,Wt).node,{ifExists:!0})})}cascade(){return new ra({...s(this,Wt),node:mo.cloneWith(s(this,Wt).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Wt).executor.transformQuery(s(this,Wt).node,s(this,Wt).queryId)}compile(){return s(this,Wt).executor.compileQuery(this.toOperationNode(),s(this,Wt).queryId)}async execute(){await s(this,Wt).executor.executeQuery(this.compile(),s(this,Wt).queryId)}};Wt=new WeakMap;let Bo=ra;const Gi=d({is(i){return i.kind==="CreateViewNode"},create(i){return d({kind:"CreateViewNode",name:Wi.create(i)})},cloneWith(i,e){return d({...i,...e})}});var na;class sf{constructor(){V(this,na,new ku)}transformQuery(e){return s(this,na).transformNode(e.node,e.queryId)}transformResult(e){return Promise.resolve(e.result)}}na=new WeakMap;var dt;const fr=class fr{constructor(e){V(this,dt);G(this,dt,d(e))}temporary(){return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{temporary:!0})})}materialized(){return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{materialized:!0})})}ifNotExists(){return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{ifNotExists:!0})})}orReplace(){return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{orReplace:!0})})}columns(e){return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{columns:e.map(Wc)})})}as(e){const t=e.withPlugin(new sf).toOperationNode();return new fr({...s(this,dt),node:Gi.cloneWith(s(this,dt).node,{as:t})})}$call(e){return e(this)}toOperationNode(){return s(this,dt).executor.transformQuery(s(this,dt).node,s(this,dt).queryId)}compile(){return s(this,dt).executor.compileQuery(this.toOperationNode(),s(this,dt).queryId)}async execute(){await s(this,dt).executor.executeQuery(this.compile(),s(this,dt).queryId)}};dt=new WeakMap;let Mo=fr;const gs=d({is(i){return i.kind==="DropViewNode"},create(i){return d({kind:"DropViewNode",name:Wi.create(i)})},cloneWith(i,e){return d({...i,...e})}});var Ot;const xs=class xs{constructor(e){V(this,Ot);G(this,Ot,d(e))}materialized(){return new xs({...s(this,Ot),node:gs.cloneWith(s(this,Ot).node,{materialized:!0})})}ifExists(){return new xs({...s(this,Ot),node:gs.cloneWith(s(this,Ot).node,{ifExists:!0})})}cascade(){return new xs({...s(this,Ot),node:gs.cloneWith(s(this,Ot).node,{cascade:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Ot).executor.transformQuery(s(this,Ot).node,s(this,Ot).queryId)}compile(){return s(this,Ot).executor.compileQuery(this.toOperationNode(),s(this,Ot).queryId)}async execute(){await s(this,Ot).executor.executeQuery(this.compile(),s(this,Ot).queryId)}};Ot=new WeakMap;let Uo=xs;const Ll=d({is(i){return i.kind==="CreateTypeNode"},create(i){return d({kind:"CreateTypeNode",name:i})},cloneWithEnum(i,e){return d({...i,enum:Xs.create(e.map(ri.createImmediate))})}});var Yt;const $l=class $l{constructor(e){V(this,Yt);G(this,Yt,d(e))}toOperationNode(){return s(this,Yt).executor.transformQuery(s(this,Yt).node,s(this,Yt).queryId)}asEnum(e){return new $l({...s(this,Yt),node:Ll.cloneWithEnum(s(this,Yt).node,e)})}$call(e){return e(this)}compile(){return s(this,Yt).executor.compileQuery(this.toOperationNode(),s(this,Yt).queryId)}async execute(){await s(this,Yt).executor.executeQuery(this.compile(),s(this,Yt).queryId)}};Yt=new WeakMap;let Qo=$l;const Wl=d({is(i){return i.kind==="DropTypeNode"},create(i){return d({kind:"DropTypeNode",name:i})},cloneWith(i,e){return d({...i,...e})}});var Xt;const Hl=class Hl{constructor(e){V(this,Xt);G(this,Xt,d(e))}ifExists(){return new Hl({...s(this,Xt),node:Wl.cloneWith(s(this,Xt).node,{ifExists:!0})})}$call(e){return e(this)}toOperationNode(){return s(this,Xt).executor.transformQuery(s(this,Xt).node,s(this,Xt).queryId)}compile(){return s(this,Xt).executor.compileQuery(this.toOperationNode(),s(this,Xt).queryId)}async execute(){await s(this,Xt).executor.executeQuery(this.compile(),s(this,Xt).queryId)}};Xt=new WeakMap;let jo=Hl;function gc(i){const e=".";if(i.includes(e)){const t=i.split(e).map(of);if(t.length===2)return Wi.createWithSchema(t[0],t[1]);throw new Error(`invalid schemable identifier ${i}`)}else return Wi.create(i)}function of(i){return i.trim()}const ws=d({is(i){return i.kind==="RefreshMaterializedViewNode"},create(i){return d({kind:"RefreshMaterializedViewNode",name:Wi.create(i)})},cloneWith(i,e){return d({...i,...e})}});var Ct;const Ss=class Ss{constructor(e){V(this,Ct);G(this,Ct,d(e))}concurrently(){return new Ss({...s(this,Ct),node:ws.cloneWith(s(this,Ct).node,{concurrently:!0,withNoData:!1})})}withData(){return new Ss({...s(this,Ct),node:ws.cloneWith(s(this,Ct).node,{withNoData:!1})})}withNoData(){return new Ss({...s(this,Ct),node:ws.cloneWith(s(this,Ct).node,{withNoData:!0,concurrently:!1})})}$call(e){return e(this)}toOperationNode(){return s(this,Ct).executor.transformQuery(s(this,Ct).node,s(this,Ct).queryId)}compile(){return s(this,Ct).executor.compileQuery(this.toOperationNode(),s(this,Ct).queryId)}async execute(){await s(this,Ct).executor.executeQuery(this.compile(),s(this,Ct).queryId)}};Ct=new WeakMap;let Vo=Ss;var Nt;const As=class As{constructor(e){V(this,Nt);G(this,Nt,e)}createTable(e){return new Wo({queryId:Me(),executor:s(this,Nt),node:jt.create(ft(e))})}dropTable(e){return new Bo({queryId:Me(),executor:s(this,Nt),node:mo.create(ft(e))})}createIndex(e){return new Po({queryId:Me(),executor:s(this,Nt),node:xi.create(e)})}dropIndex(e){return new Do({queryId:Me(),executor:s(this,Nt),node:xn.create(e)})}createSchema(e){return new Lo({queryId:Me(),executor:s(this,Nt),node:hl.create(e)})}dropSchema(e){return new Ro({queryId:Me(),executor:s(this,Nt),node:_o.create(e)})}alterTable(e){return new vu({queryId:Me(),executor:s(this,Nt),node:He.create(ft(e))})}createView(e){return new Mo({queryId:Me(),executor:s(this,Nt),node:Gi.create(e)})}refreshMaterializedView(e){return new Vo({queryId:Me(),executor:s(this,Nt),node:ws.create(e)})}dropView(e){return new Uo({queryId:Me(),executor:s(this,Nt),node:gs.create(e)})}createType(e){return new Qo({queryId:Me(),executor:s(this,Nt),node:Ll.create(gc(e))})}dropType(e){return new jo({queryId:Me(),executor:s(this,Nt),node:Wl.create(gc(e))})}withPlugin(e){return new As(s(this,Nt).withPlugin(e))}withoutPlugins(){return new As(s(this,Nt).withoutPlugins())}withSchema(e){return new As(s(this,Nt).withPluginAtFront(new hn(e)))}};Nt=new WeakMap;let zo=As;class xu{ref(e){return new gh(e)}table(e){return new ef(e)}}var Gn;class Su{constructor(e){V(this,Gn);G(this,Gn,e)}async provideConnection(e){const t=await s(this,Gn).acquireConnection();try{return await e(t)}finally{await s(this,Gn).releaseConnection(t)}}}Gn=new WeakMap;var Ii,Ti,er;const Br=class Br extends iu{constructor(t,o,m,M=[]){super(M);V(this,Ii);V(this,Ti);V(this,er);G(this,Ii,t),G(this,Ti,o),G(this,er,m)}get adapter(){return s(this,Ti)}compileQuery(t,o){return s(this,Ii).compileQuery(t,o)}provideConnection(t){return s(this,er).provideConnection(t)}withPlugins(t){return new Br(s(this,Ii),s(this,Ti),s(this,er),[...this.plugins,...t])}withPlugin(t){return new Br(s(this,Ii),s(this,Ti),s(this,er),[...this.plugins,t])}withPluginAtFront(t){return new Br(s(this,Ii),s(this,Ti),s(this,er),[t,...this.plugins])}withConnectionProvider(t){return new Br(s(this,Ii),s(this,Ti),t,[...this.plugins])}withoutPlugins(){return new Br(s(this,Ii),s(this,Ti),s(this,er),[])}};Ii=new WeakMap,Ti=new WeakMap,er=new WeakMap;let $o=Br;function Oa(){return typeof performance<"u"&&si(performance.now)?performance.now():Date.now()}var It,Nr,tr,Kn,ir,Js,Ut,Au,Ou,el,tl,il;class af{constructor(e,t){V(this,Ut);V(this,It);V(this,Nr);V(this,tr);V(this,Kn);V(this,ir);V(this,Js,new WeakSet);G(this,Kn,!1),G(this,It,e),G(this,Nr,t)}async init(){if(s(this,ir))throw new Error("driver has already been destroyed");s(this,tr)||G(this,tr,s(this,It).init().then(()=>{G(this,Kn,!0)}).catch(e=>(G(this,tr,void 0),Promise.reject(e)))),await s(this,tr)}async acquireConnection(){if(s(this,ir))throw new Error("driver has already been destroyed");s(this,Kn)||await this.init();const e=await s(this,It).acquireConnection();return s(this,Js).has(e)||(me(this,Ut,Au).call(this)&&me(this,Ut,Ou).call(this,e),s(this,Js).add(e)),e}async releaseConnection(e){await s(this,It).releaseConnection(e)}beginTransaction(e,t){return s(this,It).beginTransaction(e,t)}commitTransaction(e){return s(this,It).commitTransaction(e)}rollbackTransaction(e){return s(this,It).rollbackTransaction(e)}savepoint(e,t,o){if(s(this,It).savepoint)return s(this,It).savepoint(e,t,o);throw new Error("The `savepoint` method is not supported by this driver")}rollbackToSavepoint(e,t,o){if(s(this,It).rollbackToSavepoint)return s(this,It).rollbackToSavepoint(e,t,o);throw new Error("The `rollbackToSavepoint` method is not supported by this driver")}releaseSavepoint(e,t,o){if(s(this,It).releaseSavepoint)return s(this,It).releaseSavepoint(e,t,o);throw new Error("The `releaseSavepoint` method is not supported by this driver")}async destroy(){s(this,tr)&&(await s(this,tr),s(this,ir)||G(this,ir,s(this,It).destroy().catch(e=>(G(this,ir,void 0),Promise.reject(e)))),await s(this,ir))}}It=new WeakMap,Nr=new WeakMap,tr=new WeakMap,Kn=new WeakMap,ir=new WeakMap,Js=new WeakMap,Ut=new WeakSet,Au=function(){return s(this,Nr).isLevelEnabled("query")||s(this,Nr).isLevelEnabled("error")},Ou=function(e){const t=e.executeQuery,o=e.streamQuery,m=this;e.executeQuery=async M=>{var ke,se;let L;const _e=Oa();try{return await t.call(e,M)}catch(xe){throw L=xe,await me(ke=m,Ut,el).call(ke,xe,M,_e),xe}finally{L||await me(se=m,Ut,tl).call(se,M,_e)}},e.streamQuery=async function*(M,L){var se,xe;let _e;const ke=Oa();try{for await(const le of o.call(e,M,L))yield le}catch(le){throw _e=le,await me(se=m,Ut,el).call(se,le,M,ke),le}finally{_e||await me(xe=m,Ut,tl).call(xe,M,ke,!0)}}},el=async function(e,t,o){await s(this,Nr).error(()=>({level:"error",error:e,query:t,queryDurationMillis:me(this,Ut,il).call(this,o)}))},tl=async function(e,t,o=!1){await s(this,Nr).query(()=>({level:"query",isStream:o,query:e,queryDurationMillis:me(this,Ut,il).call(this,t)}))},il=function(e){return Oa()-e};const lf=()=>{};var Gs,qr,sa,Cu;class ma{constructor(e){V(this,sa);V(this,Gs);V(this,qr);G(this,Gs,e)}async provideConnection(e){for(;s(this,qr);)await s(this,qr).catch(lf);return G(this,qr,me(this,sa,Cu).call(this,e).finally(()=>{G(this,qr,void 0)})),s(this,qr)}}Gs=new WeakMap,qr=new WeakMap,sa=new WeakSet,Cu=async function(e){return await e(s(this,Gs))};const Iu=["read only","read write"],Tu=["read uncommitted","read committed","repeatable read","serializable","snapshot"];function Dl(i){if(i.accessMode&&!Iu.includes(i.accessMode))throw new Error(`invalid transaction access mode ${i.accessMode}`);if(i.isolationLevel&&!Tu.includes(i.isolationLevel))throw new Error(`invalid transaction isolation level ${i.isolationLevel}`)}d(["query","error"]);var Er,Kr;class Fu{constructor(e){V(this,Er);V(this,Kr);si(e)?(G(this,Kr,e),G(this,Er,d({query:!0,error:!0}))):(G(this,Kr,cf),G(this,Er,d({query:e.includes("query"),error:e.includes("error")})))}isLevelEnabled(e){return s(this,Er)[e]}async query(e){s(this,Er).query&&await s(this,Kr).call(this,e())}async error(e){s(this,Er).error&&await s(this,Kr).call(this,e())}}Er=new WeakMap,Kr=new WeakMap;function cf(i){if(i.level==="query"){const e=`kysely:query:${i.isStream?"stream:":""}`;console.log(`${e} ${i.query.sql}`),console.log(`${e} duration: ${i.queryDurationMillis.toFixed(1)}ms`)}else i.level==="error"&&(i.error instanceof Error?console.error(`kysely:error: ${i.error.stack??i.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:i.error,query:i.query.sql,queryDurationMillis:i.queryDurationMillis})}`))}function Pu(i){return qi(i)&&si(i.compile)}Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));var vt;const vn=class vn extends Ws{constructor(t){let o,m;if(Lu(t))o={executor:t.executor},m={...t};else{const M=t.dialect,L=M.createDriver(),_e=M.createQueryCompiler(),ke=M.createAdapter(),se=new Fu(t.log??[]),xe=new af(L,se),le=new Su(xe),Se=new $o(_e,ke,le,t.plugins??[]);o={executor:Se},m={config:t,executor:Se,dialect:M,driver:xe}}super(o);V(this,vt);G(this,vt,d(m))}get schema(){return new zo(s(this,vt).executor)}get dynamic(){return new xu}get introspection(){return s(this,vt).dialect.createIntrospector(this.withoutPlugins())}case(t){return new Sl({node:Ei.create(kr(t)?void 0:pn(t))})}get fn(){return xl()}transaction(){return new Ho({...s(this,vt)})}startTransaction(){return new Jo({...s(this,vt)})}connection(){return new Wu({...s(this,vt)})}withPlugin(t){return new vn({...s(this,vt),executor:s(this,vt).executor.withPlugin(t)})}withoutPlugins(){return new vn({...s(this,vt),executor:s(this,vt).executor.withoutPlugins()})}withSchema(t){return new vn({...s(this,vt),executor:s(this,vt).executor.withPluginAtFront(new hn(t))})}withTables(){return new vn({...s(this,vt)})}async destroy(){await s(this,vt).driver.destroy()}get isTransaction(){return!1}getExecutor(){return s(this,vt).executor}executeQuery(t,o=Me()){const m=Pu(t)?t.compile():t;return this.getExecutor().executeQuery(m,o)}async[Symbol.asyncDispose](){await this.destroy()}};vt=new WeakMap;let es=vn;var bi;const kn=class kn extends es{constructor(t){super(t);V(this,bi);G(this,bi,t)}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(t){return new kn({...s(this,bi),executor:s(this,bi).executor.withPlugin(t)})}withoutPlugins(){return new kn({...s(this,bi),executor:s(this,bi).executor.withoutPlugins()})}withSchema(t){return new kn({...s(this,bi),executor:s(this,bi).executor.withPluginAtFront(new hn(t))})}withTables(){return new kn({...s(this,bi)})}};bi=new WeakMap;let Ms=kn;function Lu(i){return qi(i)&&qi(i.config)&&qi(i.driver)&&qi(i.executor)&&qi(i.dialect)}var Yr;class Wu{constructor(e){V(this,Yr);G(this,Yr,d(e))}async execute(e){return s(this,Yr).executor.provideConnection(async t=>{const o=s(this,Yr).executor.withConnectionProvider(new ma(t)),m=new es({...s(this,Yr),executor:o});return await e(m)})}}Yr=new WeakMap;var li;const oa=class oa{constructor(e){V(this,li);G(this,li,d(e))}setAccessMode(e){return new oa({...s(this,li),accessMode:e})}setIsolationLevel(e){return new oa({...s(this,li),isolationLevel:e})}async execute(e){const{isolationLevel:t,accessMode:o,...m}=s(this,li),M={isolationLevel:t,accessMode:o};return Dl(M),s(this,li).executor.provideConnection(async L=>{const _e=s(this,li).executor.withConnectionProvider(new ma(L)),ke=new Ms({...m,executor:_e});try{await s(this,li).driver.beginTransaction(L,M);const se=await e(ke);return await s(this,li).driver.commitTransaction(L),se}catch(se){throw await s(this,li).driver.rollbackTransaction(L),se}})}};li=new WeakMap;let Ho=oa;var Fi;const aa=class aa{constructor(e){V(this,Fi);G(this,Fi,d(e))}setAccessMode(e){return new aa({...s(this,Fi),accessMode:e})}setIsolationLevel(e){return new aa({...s(this,Fi),isolationLevel:e})}async execute(){const{isolationLevel:e,accessMode:t,...o}=s(this,Fi),m={isolationLevel:e,accessMode:t};Dl(m);const M=await tu(s(this,Fi).executor);return await s(this,Fi).driver.beginTransaction(M.connection,m),new Go({...o,connection:M,executor:s(this,Fi).executor.withConnectionProvider(new ma(M.connection))})}};Fi=new WeakMap;let Jo=aa;var rt,Xr,Zt;const Hi=class Hi extends Ms{constructor(t){const o={isCommitted:!1,isRolledBack:!1};t={...t,executor:new rl(t.executor,o)};const{connection:m,...M}=t;super(M);V(this,rt);V(this,Xr);V(this,Zt);G(this,rt,d(t)),G(this,Zt,o);const L=Me();G(this,Xr,_e=>t.executor.compileQuery(_e,L))}get isCommitted(){return s(this,Zt).isCommitted}get isRolledBack(){return s(this,Zt).isRolledBack}commit(){return Fr(s(this,Zt)),new qn(async()=>{await s(this,rt).driver.commitTransaction(s(this,rt).connection.connection),s(this,Zt).isCommitted=!0,s(this,rt).connection.release()})}rollback(){return Fr(s(this,Zt)),new qn(async()=>{await s(this,rt).driver.rollbackTransaction(s(this,rt).connection.connection),s(this,Zt).isRolledBack=!0,s(this,rt).connection.release()})}savepoint(t){return Fr(s(this,Zt)),new qn(async()=>{var o,m;return await((m=(o=s(this,rt).driver).savepoint)==null?void 0:m.call(o,s(this,rt).connection.connection,t,s(this,Xr))),new Hi({...s(this,rt)})})}rollbackToSavepoint(t){return Fr(s(this,Zt)),new qn(async()=>{var o,m;return await((m=(o=s(this,rt).driver).rollbackToSavepoint)==null?void 0:m.call(o,s(this,rt).connection.connection,t,s(this,Xr))),new Hi({...s(this,rt)})})}releaseSavepoint(t){return Fr(s(this,Zt)),new qn(async()=>{var o,m;return await((m=(o=s(this,rt).driver).releaseSavepoint)==null?void 0:m.call(o,s(this,rt).connection.connection,t,s(this,Xr))),new Hi({...s(this,rt)})})}withPlugin(t){return new Hi({...s(this,rt),executor:s(this,rt).executor.withPlugin(t)})}withoutPlugins(){return new Hi({...s(this,rt),executor:s(this,rt).executor.withoutPlugins()})}withSchema(t){return new Hi({...s(this,rt),executor:s(this,rt).executor.withPluginAtFront(new hn(t))})}withTables(){return new Hi({...s(this,rt)})}};rt=new WeakMap,Xr=new WeakMap,Zt=new WeakMap;let Go=Hi;var Ks;class qn{constructor(e){V(this,Ks);G(this,Ks,e)}async execute(){return await s(this,Ks).call(this)}}Ks=new WeakMap;function Fr(i){if(i.isCommitted)throw new Error("Transaction is already committed");if(i.isRolledBack)throw new Error("Transaction is already rolled back")}var kt,Ni;const pr=class pr{constructor(e,t){V(this,kt);V(this,Ni);e instanceof pr?G(this,kt,s(e,kt)):G(this,kt,e),G(this,Ni,t)}get adapter(){return s(this,kt).adapter}get plugins(){return s(this,kt).plugins}transformQuery(e,t){return s(this,kt).transformQuery(e,t)}compileQuery(e,t){return s(this,kt).compileQuery(e,t)}provideConnection(e){return s(this,kt).provideConnection(e)}executeQuery(e,t){return Fr(s(this,Ni)),s(this,kt).executeQuery(e,t)}stream(e,t,o){return Fr(s(this,Ni)),s(this,kt).stream(e,t,o)}withConnectionProvider(e){return new pr(s(this,kt).withConnectionProvider(e),s(this,Ni))}withPlugin(e){return new pr(s(this,kt).withPlugin(e),s(this,Ni))}withPlugins(e){return new pr(s(this,kt).withPlugins(e),s(this,Ni))}withPluginAtFront(e){return new pr(s(this,kt).withPluginAtFront(e),s(this,Ni))}withoutPlugins(){return new pr(s(this,kt).withoutPlugins(),s(this,Ni))}};kt=new WeakMap,Ni=new WeakMap;let rl=pr;var Dt,ci,uo,sl,ol;const Os=class Os{constructor(e){V(this,ci);V(this,Dt);G(this,Dt,d(e))}get expressionType(){}get isRawBuilder(){return!0}as(e){return new uf(this,e)}$castTo(){return new Os({...s(this,Dt)})}$notNull(){return new Os(s(this,Dt))}withPlugin(e){return new Os({...s(this,Dt),plugins:s(this,Dt).plugins!==void 0?d([...s(this,Dt).plugins,e]):d([e])})}toOperationNode(){return me(this,ci,sl).call(this,me(this,ci,uo).call(this))}compile(e){return me(this,ci,ol).call(this,me(this,ci,uo).call(this,e))}async execute(e){const t=me(this,ci,uo).call(this,e);return t.executeQuery(me(this,ci,ol).call(this,t),s(this,Dt).queryId)}};Dt=new WeakMap,ci=new WeakSet,uo=function(e){const t=e!==void 0?e.getExecutor():Zs;return s(this,Dt).plugins!==void 0?t.withPlugins(s(this,Dt).plugins):t},sl=function(e){return e.transformQuery(s(this,Dt).rawNode,s(this,Dt).queryId)},ol=function(e){return e.compileQuery(me(this,ci,sl).call(this,e),s(this,Dt).queryId)};let nl=Os;function ji(i){return new nl(i)}var Zr,vr;class uf{constructor(e,t){V(this,Zr);V(this,vr);G(this,Zr,e),G(this,vr,t)}get expression(){return s(this,Zr)}get alias(){return s(this,vr)}get rawBuilder(){return s(this,Zr)}toOperationNode(){return Ri.create(s(this,Zr).toOperationNode(),Ft(s(this,vr))?s(this,vr).toOperationNode():Je.create(s(this,vr)))}}Zr=new WeakMap,vr=new WeakMap;const cn=Object.assign((i,...e)=>ji({queryId:Me(),rawNode:ht.create(i,(e==null?void 0:e.map(wc))??[])}),{ref(i){return ji({queryId:Me(),rawNode:ht.createWithChild(lr(i))})},val(i){return ji({queryId:Me(),rawNode:ht.createWithChild(bt(i))})},value(i){return this.val(i)},table(i){return ji({queryId:Me(),rawNode:ht.createWithChild(ft(i))})},id(...i){const e=new Array(i.length+1).fill(".");return e[0]="",e[e.length-1]="",ji({queryId:Me(),rawNode:ht.create(e,i.map(Je.create))})},lit(i){return ji({queryId:Me(),rawNode:ht.createWithChild(ri.createImmediate(i))})},literal(i){return this.lit(i)},raw(i){return ji({queryId:Me(),rawNode:ht.createWithSql(i)})},join(i,e=cn`, `){const t=new Array(Math.max(2*i.length-1,0)),o=e.toOperationNode();for(let m=0;m<i.length;++m)t[2*m]=wc(i[m]),m!==i.length-1&&(t[2*m+1]=o);return ji({queryId:Me(),rawNode:ht.createWithChildren(t)})}});function wc(i){return Ft(i)?i.toOperationNode():bt(i)}var la;class Du{constructor(){et(this,"nodeStack",[]);V(this,la,d({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)}));et(this,"visitNode",e=>{this.nodeStack.push(e),s(this,la)[e.kind](e),this.nodeStack.pop()})}get parentNode(){return this.nodeStack[this.nodeStack.length-2]}}la=new WeakMap;const df=/'/g;var Yn,en;class Rl extends Du{constructor(){super(...arguments);V(this,Yn,"");V(this,en,[])}get numParameters(){return s(this,en).length}compileQuery(t,o){return G(this,Yn,""),G(this,en,[]),this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(t),d({query:t,queryId:o,sql:this.getSql(),parameters:[...s(this,en)]})}getSql(){return s(this,Yn)}visitSelectQuery(t){var m,M;const o=this.parentNode!==void 0&&!on.is(this.parentNode)&&!qt.is(this.parentNode)&&!jt.is(this.parentNode)&&!Gi.is(this.parentNode)&&!kl.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),o&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("select"),t.distinctOn&&(this.append(" "),this.compileDistinctOn(t.distinctOn)),(m=t.frontModifiers)!=null&&m.length&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.top&&(this.append(" "),this.visitNode(t.top)),t.selections&&(this.append(" "),this.compileList(t.selections)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.groupBy&&(this.append(" "),this.visitNode(t.groupBy)),t.having&&(this.append(" "),this.visitNode(t.having)),t.setOperations&&(this.append(" "),this.compileList(t.setOperations," ")),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.offset&&(this.append(" "),this.visitNode(t.offset)),t.fetch&&(this.append(" "),this.visitNode(t.fetch)),(M=t.endModifiers)!=null&&M.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...t.endModifiers])," ")),o&&this.append(")")}visitFrom(t){this.append("from "),this.compileList(t.froms)}visitSelection(t){this.visitNode(t.selection)}visitColumn(t){this.visitNode(t.column)}compileDistinctOn(t){this.append("distinct on ("),this.compileList(t),this.append(")")}compileList(t,o=", "){const m=t.length-1;for(let M=0;M<=m;M++)this.visitNode(t[M]),M<m&&this.append(o)}visitWhere(t){this.append("where "),this.visitNode(t.where)}visitHaving(t){this.append("having "),this.visitNode(t.having)}visitInsertQuery(t){var M;const o=this.nodeStack.find(fe.is),m=o!==t;!m&&t.explain&&(this.visitNode(t.explain),this.append(" ")),m&&!Bt.is(o)&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append(t.replace?"replace":"insert"),t.ignore&&(ts("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),t.orAction&&(this.append(" "),this.visitNode(t.orAction)),t.top&&(this.append(" "),this.visitNode(t.top)),t.into&&(this.append(" into "),this.visitNode(t.into)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.output&&(this.append(" "),this.visitNode(t.output)),t.values&&(this.append(" "),this.visitNode(t.values)),t.defaultValues&&(this.append(" "),this.append("default values")),t.onConflict&&(this.append(" "),this.visitNode(t.onConflict)),t.onDuplicateKey&&(this.append(" "),this.visitNode(t.onDuplicateKey)),t.returning&&(this.append(" "),this.visitNode(t.returning)),m&&!Bt.is(o)&&this.append(")"),(M=t.endModifiers)!=null&&M.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitValues(t){this.append("values "),this.compileList(t.values)}visitDeleteQuery(t){var m;const o=this.nodeStack.find(fe.is)!==t;!o&&t.explain&&(this.visitNode(t.explain),this.append(" ")),o&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("delete "),t.top&&(this.visitNode(t.top),this.append(" ")),this.visitNode(t.from),t.output&&(this.append(" "),this.visitNode(t.output)),t.using&&(this.append(" "),this.visitNode(t.using)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.returning&&(this.append(" "),this.visitNode(t.returning)),o&&this.append(")"),(m=t.endModifiers)!=null&&m.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitReturning(t){this.append("returning "),this.compileList(t.selections)}visitAlias(t){this.visitNode(t.node),this.append(" as "),this.visitNode(t.alias)}visitReference(t){t.table&&(this.visitNode(t.table),this.append(".")),this.visitNode(t.column)}visitSelectAll(t){this.append("*")}visitIdentifier(t){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(t),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(t){if(!Mt(t.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(t.name))}visitAnd(t){this.visitNode(t.left),this.append(" and "),this.visitNode(t.right)}visitOr(t){this.visitNode(t.left),this.append(" or "),this.visitNode(t.right)}visitValue(t){t.immediate?this.appendImmediateValue(t.value):this.appendValue(t.value)}visitValueList(t){this.append("("),this.compileList(t.values),this.append(")")}visitTuple(t){this.append("("),this.compileList(t.values),this.append(")")}visitPrimitiveValueList(t){this.append("(");const{values:o}=t;for(let m=0;m<o.length;++m)this.appendValue(o[m]),m!==o.length-1&&this.append(", ");this.append(")")}visitParens(t){this.append("("),this.visitNode(t.node),this.append(")")}visitJoin(t){this.append(ff[t.joinType]),this.append(" "),this.visitNode(t.table),t.on&&(this.append(" "),this.visitNode(t.on))}visitOn(t){this.append("on "),this.visitNode(t.on)}visitRaw(t){const{sqlFragments:o,parameters:m}=t;for(let M=0;M<o.length;++M)this.append(o[M]),m.length>M&&this.visitNode(m[M])}visitOperator(t){this.append(t.operator)}visitTable(t){this.visitNode(t.table)}visitSchemableIdentifier(t){t.schema&&(this.visitNode(t.schema),this.append(".")),this.visitNode(t.identifier)}visitCreateTable(t){this.append("create "),t.frontModifiers&&t.frontModifiers.length>0&&(this.compileList(t.frontModifiers," "),this.append(" ")),t.temporary&&this.append("temporary "),this.append("table "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.table),t.selectQuery?(this.append(" as "),this.visitNode(t.selectQuery)):(this.append(" ("),this.compileList([...t.columns,...t.constraints??[]]),this.append(")"),t.onCommit&&(this.append(" on commit "),this.append(t.onCommit)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," ")))}visitColumnDefinition(t){t.ifNotExists&&this.append("if not exists "),this.visitNode(t.column),this.append(" "),this.visitNode(t.dataType),t.unsigned&&this.append(" unsigned"),t.frontModifiers&&t.frontModifiers.length>0&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.generated&&(this.append(" "),this.visitNode(t.generated)),t.identity&&this.append(" identity"),t.defaultTo&&(this.append(" "),this.visitNode(t.defaultTo)),t.notNull&&this.append(" not null"),t.unique&&this.append(" unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.primaryKey&&this.append(" primary key"),t.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),t.references&&(this.append(" "),this.visitNode(t.references)),t.check&&(this.append(" "),this.visitNode(t.check)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(t){this.append("references "),this.visitNode(t.table),this.append(" ("),this.compileList(t.columns),this.append(")"),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate))}visitDropTable(t){this.append("drop table "),t.ifExists&&this.append("if exists "),this.visitNode(t.table),t.cascade&&this.append(" cascade")}visitDataType(t){this.append(t.dataType)}visitOrderBy(t){this.append("order by "),this.compileList(t.items)}visitOrderByItem(t){this.visitNode(t.orderBy),t.collation&&(this.append(" "),this.visitNode(t.collation)),t.direction&&(this.append(" "),this.visitNode(t.direction)),t.nulls&&(this.append(" nulls "),this.append(t.nulls))}visitGroupBy(t){this.append("group by "),this.compileList(t.items)}visitGroupByItem(t){this.visitNode(t.groupBy)}visitUpdateQuery(t){var M;const o=this.nodeStack.find(fe.is),m=o!==t;if(!m&&t.explain&&(this.visitNode(t.explain),this.append(" ")),m&&!Bt.is(o)&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("update "),t.top&&(this.visitNode(t.top),this.append(" ")),t.table&&(this.visitNode(t.table),this.append(" ")),this.append("set "),t.updates&&this.compileList(t.updates),t.output&&(this.append(" "),this.visitNode(t.output)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins){if(!t.from)throw new Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(t.joins," ")}t.where&&(this.append(" "),this.visitNode(t.where)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.returning&&(this.append(" "),this.visitNode(t.returning)),m&&!Bt.is(o)&&this.append(")"),(M=t.endModifiers)!=null&&M.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitColumnUpdate(t){this.visitNode(t.column),this.append(" = "),this.visitNode(t.value)}visitLimit(t){this.append("limit "),this.visitNode(t.limit)}visitOffset(t){this.append("offset "),this.visitNode(t.offset)}visitOnConflict(t){this.append("on conflict"),t.columns?(this.append(" ("),this.compileList(t.columns),this.append(")")):t.constraint?(this.append(" on constraint "),this.visitNode(t.constraint)):t.indexExpression&&(this.append(" ("),this.visitNode(t.indexExpression),this.append(")")),t.indexWhere&&(this.append(" "),this.visitNode(t.indexWhere)),t.doNothing===!0?this.append(" do nothing"):t.updates&&(this.append(" do update set "),this.compileList(t.updates),t.updateWhere&&(this.append(" "),this.visitNode(t.updateWhere)))}visitOnDuplicateKey(t){this.append("on duplicate key update "),this.compileList(t.updates)}visitCreateIndex(t){this.append("create "),t.unique&&this.append("unique "),this.append("index "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.using&&(this.append(" using "),this.visitNode(t.using)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.where&&(this.append(" "),this.visitNode(t.where))}visitDropIndex(t){this.append("drop index "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.cascade&&this.append(" cascade")}visitCreateSchema(t){this.append("create schema "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.schema)}visitDropSchema(t){this.append("drop schema "),t.ifExists&&this.append("if exists "),this.visitNode(t.schema),t.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("primary key ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}buildDeferrable(t){t.deferrable!==void 0&&(t.deferrable?this.append(" deferrable"):this.append(" not deferrable")),t.initiallyDeferred!==void 0&&(t.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}visitCheckConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("check ("),this.visitNode(t.expression),this.append(")")}visitForeignKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("foreign key ("),this.compileList(t.columns),this.append(") "),this.visitNode(t.references),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate)),this.buildDeferrable(t)}visitList(t){this.compileList(t.items)}visitWith(t){this.append("with "),t.recursive&&this.append("recursive "),this.compileList(t.expressions)}visitCommonTableExpression(t){this.visitNode(t.name),this.append(" as "),po(t.materialized)&&(t.materialized||this.append("not "),this.append("materialized ")),this.visitNode(t.expression)}visitCommonTableExpressionName(t){this.visitNode(t.table),t.columns&&(this.append("("),this.compileList(t.columns),this.append(")"))}visitAlterTable(t){this.append("alter table "),this.visitNode(t.table),this.append(" "),t.renameTo&&(this.append("rename to "),this.visitNode(t.renameTo)),t.setSchema&&(this.append("set schema "),this.visitNode(t.setSchema)),t.addConstraint&&this.visitNode(t.addConstraint),t.dropConstraint&&this.visitNode(t.dropConstraint),t.renameConstraint&&this.visitNode(t.renameConstraint),t.columnAlterations&&this.compileColumnAlterations(t.columnAlterations),t.addIndex&&this.visitNode(t.addIndex),t.dropIndex&&this.visitNode(t.dropIndex)}visitAddColumn(t){this.append("add column "),this.visitNode(t.column)}visitRenameColumn(t){this.append("rename column "),this.visitNode(t.column),this.append(" to "),this.visitNode(t.renameTo)}visitDropColumn(t){this.append("drop column "),this.visitNode(t.column)}visitAlterColumn(t){this.append("alter column "),this.visitNode(t.column),this.append(" "),t.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(t.dataType),t.dataTypeExpression&&(this.append("using "),this.visitNode(t.dataTypeExpression))),t.setDefault&&(this.append("set default "),this.visitNode(t.setDefault)),t.dropDefault&&this.append("drop default"),t.setNotNull&&this.append("set not null"),t.dropNotNull&&this.append("drop not null")}visitModifyColumn(t){this.append("modify column "),this.visitNode(t.column)}visitAddConstraint(t){this.append("add "),this.visitNode(t.constraint)}visitDropConstraint(t){this.append("drop constraint "),t.ifExists&&this.append("if exists "),this.visitNode(t.constraintName),t.modifier==="cascade"?this.append(" cascade"):t.modifier==="restrict"&&this.append(" restrict")}visitRenameConstraint(t){this.append("rename constraint "),this.visitNode(t.oldName),this.append(" to "),this.visitNode(t.newName)}visitSetOperation(t){this.append(t.operator),this.append(" "),t.all&&this.append("all "),this.visitNode(t.expression)}visitCreateView(t){this.append("create "),t.orReplace&&this.append("or replace "),t.materialized&&this.append("materialized "),t.temporary&&this.append("temporary "),this.append("view "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),this.append(" "),t.columns&&(this.append("("),this.compileList(t.columns),this.append(") ")),t.as&&(this.append("as "),this.visitNode(t.as))}visitRefreshMaterializedView(t){this.append("refresh materialized view "),t.concurrently&&this.append("concurrently "),this.visitNode(t.name),t.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(t){this.append("drop "),t.materialized&&this.append("materialized "),this.append("view "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.cascade&&this.append(" cascade")}visitGenerated(t){this.append("generated "),t.always&&this.append("always "),t.byDefault&&this.append("by default "),this.append("as "),t.identity&&this.append("identity"),t.expression&&(this.append("("),this.visitNode(t.expression),this.append(")")),t.stored&&this.append(" stored")}visitDefaultValue(t){this.append("default "),this.visitNode(t.defaultValue)}visitSelectModifier(t){t.rawModifier?this.visitNode(t.rawModifier):this.append(hf[t.modifier]),t.of&&(this.append(" of "),this.compileList(t.of,", "))}visitCreateType(t){this.append("create type "),this.visitNode(t.name),t.enum&&(this.append(" as enum "),this.visitNode(t.enum))}visitDropType(t){this.append("drop type "),t.ifExists&&this.append("if exists "),this.visitNode(t.name)}visitExplain(t){this.append("explain"),(t.options||t.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),t.options&&(this.visitNode(t.options),t.format&&this.append(this.getExplainOptionsDelimiter())),t.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(t.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(t){this.append("default")}visitAggregateFunction(t){this.append(t.func),this.append("("),t.distinct&&this.append("distinct "),this.compileList(t.aggregated),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),this.append(")"),t.withinGroup&&(this.append(" within group ("),this.visitNode(t.withinGroup),this.append(")")),t.filter&&(this.append(" filter("),this.visitNode(t.filter),this.append(")")),t.over&&(this.append(" "),this.visitNode(t.over))}visitOver(t){this.append("over("),t.partitionBy&&(this.visitNode(t.partitionBy),t.orderBy&&this.append(" ")),t.orderBy&&this.visitNode(t.orderBy),this.append(")")}visitPartitionBy(t){this.append("partition by "),this.compileList(t.items)}visitPartitionByItem(t){this.visitNode(t.partitionBy)}visitBinaryOperation(t){this.visitNode(t.leftOperand),this.append(" "),this.visitNode(t.operator),this.append(" "),this.visitNode(t.rightOperand)}visitUnaryOperation(t){this.visitNode(t.operator),this.isMinusOperator(t.operator)||this.append(" "),this.visitNode(t.operand)}isMinusOperator(t){return ar.is(t)&&t.operator==="-"}visitUsing(t){this.append("using "),this.compileList(t.tables)}visitFunction(t){this.append(t.func),this.append("("),this.compileList(t.arguments),this.append(")")}visitCase(t){this.append("case"),t.value&&(this.append(" "),this.visitNode(t.value)),t.when&&(this.append(" "),this.compileList(t.when," ")),t.else&&(this.append(" else "),this.visitNode(t.else)),this.append(" end"),t.isStatement&&this.append(" case")}visitWhen(t){this.append("when "),this.visitNode(t.condition),t.result&&(this.append(" then "),this.visitNode(t.result))}visitJSONReference(t){this.visitNode(t.reference),this.visitNode(t.traversal)}visitJSONPath(t){t.inOperator&&this.visitNode(t.inOperator),this.append("'$");for(const o of t.pathLegs)this.visitNode(o);this.append("'")}visitJSONPathLeg(t){const o=t.type==="ArrayLocation";this.append(o?"[":"."),this.append(String(t.value)),o&&this.append("]")}visitJSONOperatorChain(t){for(let o=0,m=t.values.length;o<m;o++)o===m-1?this.visitNode(t.operator):this.append("->"),this.visitNode(t.values[o])}visitMergeQuery(t){var o;t.with&&(this.visitNode(t.with),this.append(" ")),this.append("merge "),t.top&&(this.visitNode(t.top),this.append(" ")),this.append("into "),this.visitNode(t.into),t.using&&(this.append(" "),this.visitNode(t.using)),t.whens&&(this.append(" "),this.compileList(t.whens," ")),t.returning&&(this.append(" "),this.visitNode(t.returning)),t.output&&(this.append(" "),this.visitNode(t.output)),(o=t.endModifiers)!=null&&o.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitMatched(t){t.not&&this.append("not "),this.append("matched"),t.bySource&&this.append(" by source")}visitAddIndex(t){this.append("add "),t.unique&&this.append("unique "),this.append("index "),this.visitNode(t.name),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.using&&(this.append(" using "),this.visitNode(t.using))}visitCast(t){this.append("cast("),this.visitNode(t.expression),this.append(" as "),this.visitNode(t.dataType),this.append(")")}visitFetch(t){this.append("fetch next "),this.visitNode(t.rowCount),this.append(` rows ${t.modifier}`)}visitOutput(t){this.append("output "),this.compileList(t.selections)}visitTop(t){this.append(`top(${t.expression})`),t.modifiers&&this.append(` ${t.modifiers}`)}visitOrAction(t){this.append(t.action)}visitCollate(t){this.append("collate "),this.visitNode(t.collation)}append(t){G(this,Yn,s(this,Yn)+t)}appendValue(t){this.addParameter(t),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(t){const o=this.getLeftIdentifierWrapper(),m=this.getRightIdentifierWrapper();let M="";for(const L of t)M+=L,L===o?M+=o:L===m&&(M+=m);return M}sanitizeStringLiteral(t){return t.replace(df,"''")}addParameter(t){s(this,en).push(t)}appendImmediateValue(t){if(Mt(t))this.appendStringLiteral(t);else if(ua(t)||po(t))this.append(t.toString());else if(ul(t))this.append("null");else if(yh(t))this.appendImmediateValue(t.toISOString());else if(dl(t))this.appendImmediateValue(t.toString());else throw new Error(`invalid immediate value ${t}`)}appendStringLiteral(t){this.append("'"),this.append(this.sanitizeStringLiteral(t)),this.append("'")}sortSelectModifiers(t){return t.sort((o,m)=>o.modifier&&m.modifier?bc[o.modifier]-bc[m.modifier]:1),d(t)}compileColumnAlterations(t){this.compileList(t)}announcesNewColumnDataType(){return!0}}Yn=new WeakMap,en=new WeakMap;const hf=d({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),bc=d({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),ff=d({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"}),ho=d({raw(i,e=[]){return d({sql:i,query:ht.createWithSql(i),parameters:d(e),queryId:Me()})}});class al{async init(){}async acquireConnection(){return new pf}async beginTransaction(){}async commitTransaction(){}async rollbackTransaction(){}async releaseConnection(){}async destroy(){}async releaseSavepoint(){}async rollbackToSavepoint(){}async savepoint(){}}class pf{async executeQuery(){return{rows:[]}}async*streamQuery(){}}class Bl{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}get supportsOutput(){return!1}}const _f=/"/g;class Ml extends Rl{visitOrAction(e){this.append("or "),this.append(e.action)}getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(e){return e.replace(_f,'""')}visitDefaultInsertValue(e){this.append("null")}}const Ul="kysely_migration",Ql="kysely_migration_lock";d({__noMigrations__:!0});var Xn,un,ll,Ru;class jl{constructor(e){V(this,un);V(this,Xn);G(this,Xn,e)}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){return await me(this,un,Ru).call(this,e)}async getMetadata(e){return{tables:await this.getTables(e)}}}Xn=new WeakMap,un=new WeakSet,ll=function(e,t){let o=e.selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select(["name","sql","type"]).orderBy("name");return t.withInternalKyselyTables||(o=o.where("name","!=",Ul).where("name","!=",Ql)),o},Ru=async function(e){var M;const t=await me(this,un,ll).call(this,s(this,Xn),e).execute(),o=await s(this,Xn).with("table_list",L=>me(this,un,ll).call(this,L,e)).selectFrom(["table_list as tl",cn`pragma_table_info(tl.name)`.as("p")]).select(["tl.name as table","p.cid","p.name","p.type","p.notnull","p.dflt_value","p.pk"]).orderBy("tl.name").orderBy("p.cid").execute(),m={};for(const L of o)m[M=L.table]??(m[M]=[]),m[L.table].push(L);return t.map(({name:L,sql:_e,type:ke})=>{var le,Se,ut,Qt,gt;let se=(gt=(Qt=(ut=(Se=(le=_e==null?void 0:_e.split(/[\(\),]/))==null?void 0:le.find(Ue=>Ue.toLowerCase().includes("autoincrement")))==null?void 0:Se.trimStart())==null?void 0:ut.split(/\s+/))==null?void 0:Qt[0])==null?void 0:gt.replace(/["`]/g,"");const xe=m[L]??[];if(!se){const Ue=xe.filter(zt=>zt.pk>0);Ue.length===1&&Ue[0].type.toLowerCase()==="integer"&&(se=Ue[0].name)}return{name:L,isView:ke==="view",columns:xe.map(Ue=>({name:Ue.name,dataType:Ue.type,isNullable:!Ue.notnull,isAutoIncrementing:Ue.name===se,hasDefaultValue:Ue.dflt_value!=null,comment:void 0}))}})};class Vl extends Bl{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(e,t){}async releaseMigrationLock(e,t){}}const mf=/"/g;class Bu extends Rl{sanitizeIdentifier(e){return e.replace(mf,'""')}}var Zn,ca,Uu;class Mu{constructor(e){V(this,ca);V(this,Zn);G(this,Zn,e)}async getSchemas(){return(await s(this,Zn).selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map(t=>({name:t.nspname}))}async getTables(e={withInternalKyselyTables:!1}){let t=s(this,Zn).selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",cn`col_description(a.attrelid, a.attnum)`.as("column_description"),cn`pg_get_serial_sequence(quote_ident(ns.nspname) || '.' || quote_ident(c.relname), a.attname)`.as("auto_incrementing")]).where("c.relkind","in",["r","v","p"]).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();e.withInternalKyselyTables||(t=t.where("c.relname","!=",Ul).where("c.relname","!=",Ql));const o=await t.execute();return me(this,ca,Uu).call(this,o)}async getMetadata(e){return{tables:await this.getTables(e)}}}Zn=new WeakMap,ca=new WeakSet,Uu=function(e){return e.reduce((t,o)=>{let m=t.find(M=>M.name===o.table&&M.schema===o.schema);return m||(m=d({name:o.table,isView:o.table_type==="v",schema:o.schema,columns:[]}),t.push(m)),m.columns.push(d({name:o.column,dataType:o.type,dataTypeSchema:o.type_schema,isNullable:!o.not_null,isAutoIncrementing:o.auto_incrementing!==null,hasDefaultValue:o.has_default,comment:o.column_description??void 0})),t},[])};const yf=BigInt("3853314791062309107");class Qu extends Bl{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(e,t){await cn`select pg_advisory_xact_lock(${cn.lit(yf)})`.execute(e)}async releaseMigrationLock(e,t){}}const gf=Object.freeze(Object.defineProperty({__proto__:null,ARITHMETIC_OPERATORS:xc,AddColumnNode:Cl,AddConstraintNode:ms,AddIndexNode:Tr,AggregateFunctionBuilder:Cn,AggregateFunctionNode:rr,AliasNode:Ri,AliasedAggregateFunctionBuilder:lu,AliasedExpressionWrapper:pa,AliasedJSONPathBuilder:hu,AlterColumnBuilder:Pl,AlterColumnNode:bn,AlterTableBuilder:vu,AlterTableColumnAlteringBuilder:mr,AlterTableNode:He,AlteredColumnBuilder:Nn,AndNode:or,AndWrapper:So,BINARY_OPERATORS:Sc,BinaryOperationNode:nn,COMPARISON_OPERATORS:kc,CaseBuilder:Sl,CaseEndBuilder:du,CaseNode:Ei,CaseThenBuilder:Al,CaseWhenBuilder:uu,CastNode:_u,CheckConstraintNode:_a,CollateNode:Tc,ColumnDefinitionBuilder:xr,ColumnDefinitionNode:st,ColumnNode:pt,ColumnUpdateNode:ql,Command:qn,CommonTableExpressionNameNode:Qa,CommonTableExpressionNode:Ls,CompiledQuery:ho,ConnectionBuilder:Wu,ControlledTransaction:Go,ControlledTransactionBuilder:Jo,CreateIndexBuilder:Po,CreateIndexNode:xi,CreateSchemaBuilder:Lo,CreateSchemaNode:hl,CreateTableBuilder:Wo,CreateTableNode:jt,CreateTypeBuilder:Qo,CreateTypeNode:Ll,CreateViewBuilder:Mo,CreateViewNode:Gi,DEFAULT_MIGRATION_LOCK_TABLE:Ql,DEFAULT_MIGRATION_TABLE:Ul,DataTypeNode:fu,DefaultConnectionProvider:Su,DefaultInsertValueNode:Uc,DefaultQueryCompiler:Rl,DefaultQueryExecutor:$o,DefaultValueNode:Nu,DeleteQueryBuilder:vo,DeleteQueryNode:An,DeleteResult:Hc,DialectAdapterBase:Bl,DropColumnNode:Il,DropConstraintNode:ys,DropIndexBuilder:Do,DropIndexNode:xn,DropSchemaBuilder:Ro,DropSchemaNode:_o,DropTableBuilder:Bo,DropTableNode:mo,DropTypeBuilder:jo,DropTypeNode:Wl,DropViewBuilder:Uo,DropViewNode:gs,DummyDriver:al,DynamicModule:xu,ExplainNode:Rc,ExpressionWrapper:Xe,FetchNode:au,ForeignKeyConstraintBuilder:Bs,ForeignKeyConstraintNode:Ji,FromNode:Ts,FunctionNode:Ja,GeneratedNode:fs,GroupByItemNode:ou,GroupByNode:Wa,HavingNode:Da,IdentifierNode:Je,InsertQueryBuilder:Fs,InsertQueryNode:qt,InsertResult:Vc,JSONOperatorChainNode:_l,JSONPathBuilder:Oo,JSONPathLegNode:Ga,JSONPathNode:Sn,JSONReferenceNode:Cs,JSON_OPERATORS:pl,JoinBuilder:No,JoinNode:tn,Kysely:es,LimitNode:ha,ListNode:Nl,Log:Fu,MatchedNode:eu,MatchedThenableMergeQueryBuilder:$a,MergeQueryBuilder:ko,MergeQueryNode:Bt,MergeResult:ru,ModifyColumnNode:Fl,NOOP_QUERY_EXECUTOR:Zs,NoResultError:rs,NoopQueryExecutor:Mr,NotMatchedThenableMergeQueryBuilder:nu,ON_COMMIT_ACTIONS:Ec,ON_MODIFY_FOREIGN_ACTIONS:wu,OPERATORS:Cc,OffsetNode:su,OnConflictBuilder:qo,OnConflictDoNothingBuilder:zc,OnConflictNode:Vt,OnConflictUpdateBuilder:Eo,OnDuplicateKeyNode:jc,OnNode:ao,OperationNodeTransformer:vl,OperationNodeVisitor:Du,OperatorNode:ar,OrActionNode:Or,OrNode:dn,OrWrapper:xo,OrderByItemBuilder:yo,OrderByItemNode:Pi,OrderByNode:an,OutputNode:Ma,OverNode:bo,ParensNode:on,PartitionByItemNode:Bc,PartitionByNode:La,PostgresAdapter:Qu,PostgresIntrospector:Mu,PostgresQueryCompiler:Bu,PrimaryKeyConstraintNode:Ur,PrimitiveValueListNode:yl,QueryCreator:Ws,QueryNode:fe,RawNode:ht,ReferenceNode:Ys,ReferencesNode:_s,RefreshMaterializedViewBuilder:Vo,RefreshMaterializedViewNode:ws,RenameColumnNode:Tl,RenameConstraintNode:Eu,ReturningNode:Ba,SchemaModule:zo,SchemableIdentifierNode:Wi,SelectAllNode:da,SelectModifierNode:ki,SelectQueryNode:Ke,SelectionNode:On,SetOperationNode:kl,SingleConnectionProvider:ma,SqliteAdapter:Vl,SqliteIntrospector:jl,SqliteQueryCompiler:Ml,TRANSACTION_ACCESS_MODES:Iu,TRANSACTION_ISOLATION_LEVELS:Tu,TableNode:Li,TopNode:$c,Transaction:Ms,TransactionBuilder:Ho,TraversedJSONPathBuilder:Ds,TupleNode:Ya,UNARY_FILTER_OPERATORS:Ac,UNARY_OPERATORS:Oc,UnaryOperationNode:cu,UniqueConstraintNode:_r,UpdateQueryBuilder:Ps,UpdateQueryNode:rn,UpdateResult:Jc,UsingNode:Ra,ValueListNode:Xs,ValueNode:ri,ValuesNode:Mc,WhenNode:is,WheneableMergeQueryBuilder:nr,WhereNode:Rt,WithNode:hs,WithSchemaPlugin:hn,createFunctionModule:xl,createQueryId:Me,createRawBuilder:ji,createSelectQueryBuilder:Ao,expressionBuilder:fn,isAliasedExpression:vc,isColumnDataType:pu,isCompilable:Pu,isExpression:fl,isJSONOperator:Fa,isKyselyProps:Lu,isNoResultErrorConstructor:ns,isOperationNodeSource:Ft,logOnce:ts,sql:cn,validateTransactionSettings:Dl},Symbol.toStringTag,{value:"Module"}));var wf=class{constructor(i){et(this,"createDriver");this.createDriver=i}createQueryCompiler(){return new Ml}createAdapter(){return new Vl}createIntrospector(i){return new jl(i)}},bf=class{constructor(){et(this,"promise");et(this,"resolve")}async lock(){for(;this.promise;)await this.promise;this.promise=new Promise(i=>{this.resolve=i})}unlock(){const i=this.resolve;this.promise=void 0,this.resolve=void 0,i==null||i()}};async function Ca(i,e,t,o,m){await t.executeQuery(m(ht.createWithChildren([ht.createWithSql(`${i} `),Je.create(o)]),e()))}var Nf=class{constructor(i){et(this,"mutex",new bf);et(this,"conn");et(this,"savepoint");et(this,"releaseSavepoint");et(this,"rollbackToSavepoint");et(this,"init");this.init=()=>uh(async()=>{const{createQueryId:e}=await Promise.resolve().then(()=>gf);return{createQueryId:e}},void 0).then(({createQueryId:e})=>{e&&(this.savepoint=Ca.bind(null,"savepoint",e),this.releaseSavepoint=Ca.bind(null,"release",e),this.rollbackToSavepoint=Ca.bind(null,"rollback to",e))}).then(i)}async acquireConnection(){return await this.mutex.lock(),this.conn}async beginTransaction(i){await i.executeQuery(ho.raw("begin"))}async commitTransaction(i){await i.executeQuery(ho.raw("commit"))}async rollbackTransaction(i){await i.executeQuery(ho.raw("rollback"))}async releaseConnection(){this.mutex.unlock()}};function qf(i){return async(e,t,o)=>{const m=await i.all(t,o);return e||m.length?{rows:m}:{rows:[],...await i.run("select 1")}}}var Ef=class extends Nf{constructor(e,t){super(async()=>{this.db=await e(),this.conn=new vf(this.db),await(t==null?void 0:t(this.conn))});et(this,"db")}async destroy(){var e;await((e=this.db)==null?void 0:e.close())}},vf=class{constructor(i){this.db=i}async*streamQuery({parameters:i,query:e,sql:t}){if(!this.db.iterator)throw new Error("streamQuery() is not supported.");const o=this.db.iterator(Ke.is(e),t,i);for await(const m of o)yield{rows:[m]}}async executeQuery({parameters:i,query:e,sql:t}){return await this.db.query(Ke.is(e),t,i)}},kf=class extends wf{constructor(i,e){super(()=>new Ef(i,e))}};class xf extends Map{constructor(e){if(!e)super();else{const t=[];for(const o of e)t.push([o,0]);super(t)}}set(e){const t=super.get(e)??0;return super.set(e,t+1)}get(e){return super.get(e)??0}}class cl extends Error{constructor(t,...o){super(...o);et(this,"_tag","medfetch/sqlite-wasm.worker1");et(this,"thread");this.thread=t}}var ju=(()=>{var i=import.meta.url;return function(e={}){var t,o=e,m,M,L=new Promise((r,n)=>{m=r,M=n}),_e=typeof window=="object",ke=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";const se=globalThis.sqlite3InitModuleState||Object.assign(Object.create(null),{debugModule:()=>{}});delete globalThis.sqlite3InitModuleState,se.debugModule("globalThis.location =",globalThis.location);var xe=Object.assign({},o),le="./this.program",Se="";function ut(r){return o.locateFile?o.locateFile(r,Se):Se+r}var Qt,gt;(_e||ke)&&(ke?Se=self.location.href:typeof document<"u"&&document.currentScript&&(Se=document.currentScript.src),i&&(Se=i),Se.startsWith("blob:")?Se="":Se=Se.substr(0,Se.replace(/[?#].*/,"").lastIndexOf("/")+1),ke&&(gt=r=>{var n=new XMLHttpRequest;return n.open("GET",r,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),Qt=r=>fetch(r,{credentials:"same-origin"}).then(n=>n.ok?n.arrayBuffer():Promise.reject(new Error(n.status+" : "+n.url))));var Ue=o.print||console.log.bind(console),zt=o.printErr||console.error.bind(console);Object.assign(o,xe),xe=null,o.arguments&&o.arguments,o.thisProgram&&(le=o.thisProgram);var oi=o.wasmBinary,Bi,to=!1,Pe,Mi,di,We,j,x;function we(){var r=Bi.buffer;o.HEAP8=Pe=new Int8Array(r),o.HEAP16=di=new Int16Array(r),o.HEAPU8=Mi=new Uint8Array(r),o.HEAPU16=new Uint16Array(r),o.HEAP32=We=new Int32Array(r),o.HEAPU32=j=new Uint32Array(r),o.HEAPF32=new Float32Array(r),o.HEAPF64=new Float64Array(r),o.HEAP64=x=new BigInt64Array(r),o.HEAPU64=new BigUint64Array(r)}if(o.wasmMemory)Bi=o.wasmMemory;else{var re=o.INITIAL_MEMORY||16777216;Bi=new WebAssembly.Memory({initial:re/65536,maximum:32768})}we();var xt=[],ai=[],$t=[];function Ui(){var r=o.preRun;r&&(typeof r=="function"&&(r=[r]),r.forEach(Hu)),ba(xt)}function cr(){!o.noFSInit&&!f.initialized&&f.init(),f.ignorePermissions=!1,ba(ai)}function os(){var r=o.postRun;r&&(typeof r=="function"&&(r=[r]),r.forEach(Gu)),ba($t)}function Hu(r){xt.unshift(r)}function Ju(r){ai.unshift(r)}function Gu(r){$t.unshift(r)}var Sr=0,as=null;function Mf(r){return r}function ya(r){var n;Sr++,(n=o.monitorRunDependencies)==null||n.call(o,Sr)}function io(r){var a;if(Sr--,(a=o.monitorRunDependencies)==null||a.call(o,Sr),Sr==0&&as){var n=as;as=null,n()}}function ga(r){var a;(a=o.onAbort)==null||a.call(o,r),r="Aborted("+r+")",zt(r),to=!0,r+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(r);throw M(n),n}var Ku="data:application/octet-stream;base64,",Jl=r=>r.startsWith(Ku);function Yu(){if(o.locateFile){var r="sqlite3.wasm";return Jl(r)?r:ut(r)}return new URL("/docs/assets/sqlite3.WT1HU0S9.wasm",import.meta.url).href}var wa;function Gl(r){if(r==wa&&oi)return new Uint8Array(oi);if(gt)return gt(r);throw"both async and sync fetching of the wasm failed"}function Xu(r){return oi?Promise.resolve().then(()=>Gl(r)):Qt(r).then(n=>new Uint8Array(n),()=>Gl(r))}function Kl(r,n,a){return Xu(r).then(l=>WebAssembly.instantiate(l,n)).then(a,l=>{zt(`failed to asynchronously prepare wasm: ${l}`),ga(l)})}function Zu(r,n,a,l){return!r&&typeof WebAssembly.instantiateStreaming=="function"&&!Jl(n)&&typeof fetch=="function"?fetch(n,{credentials:"same-origin"}).then(c=>{var u=WebAssembly.instantiateStreaming(c,a);return u.then(l,function(w){return zt(`wasm streaming compile failed: ${w}`),zt("falling back to ArrayBuffer instantiation"),Kl(n,a,l)})}):Kl(n,a,l)}function ed(){return{env:rc,wasi_snapshot_preview1:rc}}function td(){var r=ed();function n(l,c){return N=l.exports,Ju(N.__wasm_call_ctors),io(),N}ya();function a(l){n(l.instance)}if(o.instantiateWasm)try{return o.instantiateWasm(r,n)}catch(l){zt(`Module.instantiateWasm callback failed with error: ${l}`),M(l)}return wa??(wa=Yu()),Zu(oi,wa,r,a).catch(M),{}}var ba=r=>{r.forEach(n=>n(o))};o.noExitRuntime;var Ye={isAbs:r=>r.charAt(0)==="/",splitPath:r=>{var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return n.exec(r).slice(1)},normalizeArray:(r,n)=>{for(var a=0,l=r.length-1;l>=0;l--){var c=r[l];c==="."?r.splice(l,1):c===".."?(r.splice(l,1),a++):a&&(r.splice(l,1),a--)}if(n)for(;a;a--)r.unshift("..");return r},normalize:r=>{var n=Ye.isAbs(r),a=r.substr(-1)==="/";return r=Ye.normalizeArray(r.split("/").filter(l=>!!l),!n).join("/"),!r&&!n&&(r="."),r&&a&&(r+="/"),(n?"/":"")+r},dirname:r=>{var n=Ye.splitPath(r),a=n[0],l=n[1];return!a&&!l?".":(l&&(l=l.substr(0,l.length-1)),a+l)},basename:r=>{if(r==="/")return"/";r=Ye.normalize(r),r=r.replace(/\/$/,"");var n=r.lastIndexOf("/");return n===-1?r:r.substr(n+1)},join:(...r)=>Ye.normalize(r.join("/")),join2:(r,n)=>Ye.normalize(r+"/"+n)},id=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return r=>crypto.getRandomValues(r);ga("initRandomDevice")},Yl=r=>(Yl=id())(r),Qi={resolve:(...r)=>{for(var n="",a=!1,l=r.length-1;l>=-1&&!a;l--){var c=l>=0?r[l]:f.cwd();if(typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";n=c+"/"+n,a=Ye.isAbs(c)}return n=Ye.normalizeArray(n.split("/").filter(u=>!!u),!a).join("/"),(a?"/":"")+n||"."},relative:(r,n)=>{r=Qi.resolve(r).substr(1),n=Qi.resolve(n).substr(1);function a(z){for(var ie=0;ie<z.length&&z[ie]==="";ie++);for(var oe=z.length-1;oe>=0&&z[oe]==="";oe--);return ie>oe?[]:z.slice(ie,oe-ie+1)}for(var l=a(r.split("/")),c=a(n.split("/")),u=Math.min(l.length,c.length),w=u,k=0;k<u;k++)if(l[k]!==c[k]){w=k;break}for(var Q=[],k=w;k<l.length;k++)Q.push("..");return Q=Q.concat(c.slice(w)),Q.join("/")}},Xl=typeof TextDecoder<"u"?new TextDecoder:void 0,_n=(r,n=0,a=NaN)=>{for(var l=n+a,c=n;r[c]&&!(c>=l);)++c;if(c-n>16&&r.buffer&&Xl)return Xl.decode(r.subarray(n,c));for(var u="";n<c;){var w=r[n++];if(!(w&128)){u+=String.fromCharCode(w);continue}var k=r[n++]&63;if((w&224)==192){u+=String.fromCharCode((w&31)<<6|k);continue}var Q=r[n++]&63;if((w&240)==224?w=(w&15)<<12|k<<6|Q:w=(w&7)<<18|k<<12|Q<<6|r[n++]&63,w<65536)u+=String.fromCharCode(w);else{var z=w-65536;u+=String.fromCharCode(55296|z>>10,56320|z&1023)}}return u},Na=[],ro=r=>{for(var n=0,a=0;a<r.length;++a){var l=r.charCodeAt(a);l<=127?n++:l<=2047?n+=2:l>=55296&&l<=57343?(n+=4,++a):n+=3}return n},qa=(r,n,a,l)=>{if(!(l>0))return 0;for(var c=a,u=a+l-1,w=0;w<r.length;++w){var k=r.charCodeAt(w);if(k>=55296&&k<=57343){var Q=r.charCodeAt(++w);k=65536+((k&1023)<<10)|Q&1023}if(k<=127){if(a>=u)break;n[a++]=k}else if(k<=2047){if(a+1>=u)break;n[a++]=192|k>>6,n[a++]=128|k&63}else if(k<=65535){if(a+2>=u)break;n[a++]=224|k>>12,n[a++]=128|k>>6&63,n[a++]=128|k&63}else{if(a+3>=u)break;n[a++]=240|k>>18,n[a++]=128|k>>12&63,n[a++]=128|k>>6&63,n[a++]=128|k&63}}return n[a]=0,a-c};function Zl(r,n,a){var l=ro(r)+1,c=new Array(l),u=qa(r,c,0,c.length);return c.length=u,c}var rd=()=>{if(!Na.length){var r=null;if(typeof window<"u"&&typeof window.prompt=="function"&&(r=window.prompt("Input: "),r!==null&&(r+=`
`)),!r)return null;Na=Zl(r)}return Na.shift()},Ar={ttys:[],init(){},shutdown(){},register(r,n){Ar.ttys[r]={input:[],output:[],ops:n},f.registerDevice(r,Ar.stream_ops)},stream_ops:{open(r){var n=Ar.ttys[r.node.rdev];if(!n)throw new f.ErrnoError(43);r.tty=n,r.seekable=!1},close(r){r.tty.ops.fsync(r.tty)},fsync(r){r.tty.ops.fsync(r.tty)},read(r,n,a,l,c){if(!r.tty||!r.tty.ops.get_char)throw new f.ErrnoError(60);for(var u=0,w=0;w<l;w++){var k;try{k=r.tty.ops.get_char(r.tty)}catch{throw new f.ErrnoError(29)}if(k===void 0&&u===0)throw new f.ErrnoError(6);if(k==null)break;u++,n[a+w]=k}return u&&(r.node.timestamp=Date.now()),u},write(r,n,a,l,c){if(!r.tty||!r.tty.ops.put_char)throw new f.ErrnoError(60);try{for(var u=0;u<l;u++)r.tty.ops.put_char(r.tty,n[a+u])}catch{throw new f.ErrnoError(29)}return l&&(r.node.timestamp=Date.now()),u}},default_tty_ops:{get_char(r){return rd()},put_char(r,n){n===null||n===10?(Ue(_n(r.output)),r.output=[]):n!=0&&r.output.push(n)},fsync(r){r.output&&r.output.length>0&&(Ue(_n(r.output)),r.output=[])},ioctl_tcgets(r){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(r,n,a){return 0},ioctl_tiocgwinsz(r){return[24,80]}},default_tty1_ops:{put_char(r,n){n===null||n===10?(zt(_n(r.output)),r.output=[]):n!=0&&r.output.push(n)},fsync(r){r.output&&r.output.length>0&&(zt(_n(r.output)),r.output=[])}}},nd=(r,n)=>{Mi.fill(0,r,r+n)},ec=(r,n)=>Math.ceil(r/n)*n,tc=r=>{r=ec(r,65536);var n=nc(65536,r);return n&&nd(n,r),n},Oe={ops_table:null,mount(r){return Oe.createNode(null,"/",16895,0)},createNode(r,n,a,l){if(f.isBlkdev(a)||f.isFIFO(a))throw new f.ErrnoError(63);Oe.ops_table||(Oe.ops_table={dir:{node:{getattr:Oe.node_ops.getattr,setattr:Oe.node_ops.setattr,lookup:Oe.node_ops.lookup,mknod:Oe.node_ops.mknod,rename:Oe.node_ops.rename,unlink:Oe.node_ops.unlink,rmdir:Oe.node_ops.rmdir,readdir:Oe.node_ops.readdir,symlink:Oe.node_ops.symlink},stream:{llseek:Oe.stream_ops.llseek}},file:{node:{getattr:Oe.node_ops.getattr,setattr:Oe.node_ops.setattr},stream:{llseek:Oe.stream_ops.llseek,read:Oe.stream_ops.read,write:Oe.stream_ops.write,allocate:Oe.stream_ops.allocate,mmap:Oe.stream_ops.mmap,msync:Oe.stream_ops.msync}},link:{node:{getattr:Oe.node_ops.getattr,setattr:Oe.node_ops.setattr,readlink:Oe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Oe.node_ops.getattr,setattr:Oe.node_ops.setattr},stream:f.chrdev_stream_ops}});var c=f.createNode(r,n,a,l);return f.isDir(c.mode)?(c.node_ops=Oe.ops_table.dir.node,c.stream_ops=Oe.ops_table.dir.stream,c.contents={}):f.isFile(c.mode)?(c.node_ops=Oe.ops_table.file.node,c.stream_ops=Oe.ops_table.file.stream,c.usedBytes=0,c.contents=null):f.isLink(c.mode)?(c.node_ops=Oe.ops_table.link.node,c.stream_ops=Oe.ops_table.link.stream):f.isChrdev(c.mode)&&(c.node_ops=Oe.ops_table.chrdev.node,c.stream_ops=Oe.ops_table.chrdev.stream),c.timestamp=Date.now(),r&&(r.contents[n]=c,r.timestamp=c.timestamp),c},getFileDataAsTypedArray(r){return r.contents?r.contents.subarray?r.contents.subarray(0,r.usedBytes):new Uint8Array(r.contents):new Uint8Array(0)},expandFileStorage(r,n){var a=r.contents?r.contents.length:0;if(!(a>=n)){var l=1024*1024;n=Math.max(n,a*(a<l?2:1.125)>>>0),a!=0&&(n=Math.max(n,256));var c=r.contents;r.contents=new Uint8Array(n),r.usedBytes>0&&r.contents.set(c.subarray(0,r.usedBytes),0)}},resizeFileStorage(r,n){if(r.usedBytes!=n)if(n==0)r.contents=null,r.usedBytes=0;else{var a=r.contents;r.contents=new Uint8Array(n),a&&r.contents.set(a.subarray(0,Math.min(n,r.usedBytes))),r.usedBytes=n}},node_ops:{getattr(r){var n={};return n.dev=f.isChrdev(r.mode)?r.id:1,n.ino=r.id,n.mode=r.mode,n.nlink=1,n.uid=0,n.gid=0,n.rdev=r.rdev,f.isDir(r.mode)?n.size=4096:f.isFile(r.mode)?n.size=r.usedBytes:f.isLink(r.mode)?n.size=r.link.length:n.size=0,n.atime=new Date(r.timestamp),n.mtime=new Date(r.timestamp),n.ctime=new Date(r.timestamp),n.blksize=4096,n.blocks=Math.ceil(n.size/n.blksize),n},setattr(r,n){n.mode!==void 0&&(r.mode=n.mode),n.timestamp!==void 0&&(r.timestamp=n.timestamp),n.size!==void 0&&Oe.resizeFileStorage(r,n.size)},lookup(r,n){throw f.genericErrors[44]},mknod(r,n,a,l){return Oe.createNode(r,n,a,l)},rename(r,n,a){if(f.isDir(r.mode)){var l;try{l=f.lookupNode(n,a)}catch{}if(l)for(var c in l.contents)throw new f.ErrnoError(55)}delete r.parent.contents[r.name],r.parent.timestamp=Date.now(),r.name=a,n.contents[a]=r,n.timestamp=r.parent.timestamp},unlink(r,n){delete r.contents[n],r.timestamp=Date.now()},rmdir(r,n){var a=f.lookupNode(r,n);for(var l in a.contents)throw new f.ErrnoError(55);delete r.contents[n],r.timestamp=Date.now()},readdir(r){var n=[".",".."];for(var a of Object.keys(r.contents))n.push(a);return n},symlink(r,n,a){var l=Oe.createNode(r,n,41471,0);return l.link=a,l},readlink(r){if(!f.isLink(r.mode))throw new f.ErrnoError(28);return r.link}},stream_ops:{read(r,n,a,l,c){var u=r.node.contents;if(c>=r.node.usedBytes)return 0;var w=Math.min(r.node.usedBytes-c,l);if(w>8&&u.subarray)n.set(u.subarray(c,c+w),a);else for(var k=0;k<w;k++)n[a+k]=u[c+k];return w},write(r,n,a,l,c,u){if(n.buffer===Pe.buffer&&(u=!1),!l)return 0;var w=r.node;if(w.timestamp=Date.now(),n.subarray&&(!w.contents||w.contents.subarray)){if(u)return w.contents=n.subarray(a,a+l),w.usedBytes=l,l;if(w.usedBytes===0&&c===0)return w.contents=n.slice(a,a+l),w.usedBytes=l,l;if(c+l<=w.usedBytes)return w.contents.set(n.subarray(a,a+l),c),l}if(Oe.expandFileStorage(w,c+l),w.contents.subarray&&n.subarray)w.contents.set(n.subarray(a,a+l),c);else for(var k=0;k<l;k++)w.contents[c+k]=n[a+k];return w.usedBytes=Math.max(w.usedBytes,c+l),l},llseek(r,n,a){var l=n;if(a===1?l+=r.position:a===2&&f.isFile(r.node.mode)&&(l+=r.node.usedBytes),l<0)throw new f.ErrnoError(28);return l},allocate(r,n,a){Oe.expandFileStorage(r.node,n+a),r.node.usedBytes=Math.max(r.node.usedBytes,n+a)},mmap(r,n,a,l,c){if(!f.isFile(r.node.mode))throw new f.ErrnoError(43);var u,w,k=r.node.contents;if(!(c&2)&&k&&k.buffer===Pe.buffer)w=!1,u=k.byteOffset;else{if(w=!0,u=tc(n),!u)throw new f.ErrnoError(48);k&&((a>0||a+n<k.length)&&(k.subarray?k=k.subarray(a,a+n):k=Array.prototype.slice.call(k,a,a+n)),Pe.set(k,u))}return{ptr:u,allocated:w}},msync(r,n,a,l,c){return Oe.stream_ops.write(r,n,0,l,a,!1),0}}},sd=(r,n,a,l)=>{var c=`al ${r}`;Qt(r).then(u=>{n(new Uint8Array(u)),c&&io()},u=>{if(a)a();else throw`Loading data file "${r}" failed.`}),c&&ya()},od=(r,n,a,l,c,u)=>{f.createDataFile(r,n,a,l,c,u)},ad=o.preloadPlugins||[],ld=(r,n,a,l)=>{typeof Browser<"u"&&Browser.init();var c=!1;return ad.forEach(u=>{c||u.canHandle(n)&&(u.handle(r,n,a,l),c=!0)}),c},cd=(r,n,a,l,c,u,w,k,Q,z)=>{var ie=n?Qi.resolve(Ye.join2(r,n)):r;function oe(U){function P(J){z==null||z(),k||od(r,n,J,l,c,Q),u==null||u(),io()}ld(U,ie,P,()=>{w==null||w(),io()})||P(U)}ya(),typeof a=="string"?sd(a,oe,w):oe(a)},ud=r=>{var n={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},a=n[r];if(typeof a>"u")throw new Error(`Unknown file open mode: ${r}`);return a},Ea=(r,n)=>{var a=0;return r&&(a|=365),n&&(a|=146),a},f={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class{constructor(r){this.name="ErrnoError",this.errno=r}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(r){this.node=r}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(r){this.shared.flags=r}get position(){return this.shared.position}set position(r){this.shared.position=r}},FSNode:class{constructor(r,n,a,l){r||(r=this),this.parent=r,this.mount=r.mount,this.mounted=null,this.id=f.nextInode++,this.name=n,this.mode=a,this.node_ops={},this.stream_ops={},this.rdev=l,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(r){r?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(r){r?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return f.isDir(this.mode)}get isDevice(){return f.isChrdev(this.mode)}},lookupPath(r,n={}){if(r=Qi.resolve(r),!r)return{path:"",node:null};var a={follow_mount:!0,recurse_count:0};if(n=Object.assign(a,n),n.recurse_count>8)throw new f.ErrnoError(32);for(var l=r.split("/").filter(oe=>!!oe),c=f.root,u="/",w=0;w<l.length;w++){var k=w===l.length-1;if(k&&n.parent)break;if(c=f.lookupNode(c,l[w]),u=Ye.join2(u,l[w]),f.isMountpoint(c)&&(!k||k&&n.follow_mount)&&(c=c.mounted.root),!k||n.follow)for(var Q=0;f.isLink(c.mode);){var z=f.readlink(u);u=Qi.resolve(Ye.dirname(u),z);var ie=f.lookupPath(u,{recurse_count:n.recurse_count+1});if(c=ie.node,Q++>40)throw new f.ErrnoError(32)}}return{path:u,node:c}},getPath(r){for(var n;;){if(f.isRoot(r)){var a=r.mount.mountpoint;return n?a[a.length-1]!=="/"?`${a}/${n}`:a+n:a}n=n?`${r.name}/${n}`:r.name,r=r.parent}},hashName(r,n){for(var a=0,l=0;l<n.length;l++)a=(a<<5)-a+n.charCodeAt(l)|0;return(r+a>>>0)%f.nameTable.length},hashAddNode(r){var n=f.hashName(r.parent.id,r.name);r.name_next=f.nameTable[n],f.nameTable[n]=r},hashRemoveNode(r){var n=f.hashName(r.parent.id,r.name);if(f.nameTable[n]===r)f.nameTable[n]=r.name_next;else for(var a=f.nameTable[n];a;){if(a.name_next===r){a.name_next=r.name_next;break}a=a.name_next}},lookupNode(r,n){var a=f.mayLookup(r);if(a)throw new f.ErrnoError(a);for(var l=f.hashName(r.id,n),c=f.nameTable[l];c;c=c.name_next){var u=c.name;if(c.parent.id===r.id&&u===n)return c}return f.lookup(r,n)},createNode(r,n,a,l){var c=new f.FSNode(r,n,a,l);return f.hashAddNode(c),c},destroyNode(r){f.hashRemoveNode(r)},isRoot(r){return r===r.parent},isMountpoint(r){return!!r.mounted},isFile(r){return(r&61440)===32768},isDir(r){return(r&61440)===16384},isLink(r){return(r&61440)===40960},isChrdev(r){return(r&61440)===8192},isBlkdev(r){return(r&61440)===24576},isFIFO(r){return(r&61440)===4096},isSocket(r){return(r&49152)===49152},flagsToPermissionString(r){var n=["r","w","rw"][r&3];return r&512&&(n+="w"),n},nodePermissions(r,n){return f.ignorePermissions?0:n.includes("r")&&!(r.mode&292)||n.includes("w")&&!(r.mode&146)||n.includes("x")&&!(r.mode&73)?2:0},mayLookup(r){if(!f.isDir(r.mode))return 54;var n=f.nodePermissions(r,"x");return n||(r.node_ops.lookup?0:2)},mayCreate(r,n){try{var a=f.lookupNode(r,n);return 20}catch{}return f.nodePermissions(r,"wx")},mayDelete(r,n,a){var l;try{l=f.lookupNode(r,n)}catch(u){return u.errno}var c=f.nodePermissions(r,"wx");if(c)return c;if(a){if(!f.isDir(l.mode))return 54;if(f.isRoot(l)||f.getPath(l)===f.cwd())return 10}else if(f.isDir(l.mode))return 31;return 0},mayOpen(r,n){return r?f.isLink(r.mode)?32:f.isDir(r.mode)&&(f.flagsToPermissionString(n)!=="r"||n&512)?31:f.nodePermissions(r,f.flagsToPermissionString(n)):44},MAX_OPEN_FDS:4096,nextfd(){for(var r=0;r<=f.MAX_OPEN_FDS;r++)if(!f.streams[r])return r;throw new f.ErrnoError(33)},getStreamChecked(r){var n=f.getStream(r);if(!n)throw new f.ErrnoError(8);return n},getStream:r=>f.streams[r],createStream(r,n=-1){return r=Object.assign(new f.FSStream,r),n==-1&&(n=f.nextfd()),r.fd=n,f.streams[n]=r,r},closeStream(r){f.streams[r]=null},dupStream(r,n=-1){var l,c;var a=f.createStream(r,n);return(c=(l=a.stream_ops)==null?void 0:l.dup)==null||c.call(l,a),a},chrdev_stream_ops:{open(r){var a,l;var n=f.getDevice(r.node.rdev);r.stream_ops=n.stream_ops,(l=(a=r.stream_ops).open)==null||l.call(a,r)},llseek(){throw new f.ErrnoError(70)}},major:r=>r>>8,minor:r=>r&255,makedev:(r,n)=>r<<8|n,registerDevice(r,n){f.devices[r]={stream_ops:n}},getDevice:r=>f.devices[r],getMounts(r){for(var n=[],a=[r];a.length;){var l=a.pop();n.push(l),a.push(...l.mounts)}return n},syncfs(r,n){typeof r=="function"&&(n=r,r=!1),f.syncFSRequests++,f.syncFSRequests>1&&zt(`warning: ${f.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var a=f.getMounts(f.root.mount),l=0;function c(w){return f.syncFSRequests--,n(w)}function u(w){if(w)return u.errored?void 0:(u.errored=!0,c(w));++l>=a.length&&c(null)}a.forEach(w=>{if(!w.type.syncfs)return u(null);w.type.syncfs(w,r,u)})},mount(r,n,a){var l=a==="/",c=!a,u;if(l&&f.root)throw new f.ErrnoError(10);if(!l&&!c){var w=f.lookupPath(a,{follow_mount:!1});if(a=w.path,u=w.node,f.isMountpoint(u))throw new f.ErrnoError(10);if(!f.isDir(u.mode))throw new f.ErrnoError(54)}var k={type:r,opts:n,mountpoint:a,mounts:[]},Q=r.mount(k);return Q.mount=k,k.root=Q,l?f.root=Q:u&&(u.mounted=k,u.mount&&u.mount.mounts.push(k)),Q},unmount(r){var n=f.lookupPath(r,{follow_mount:!1});if(!f.isMountpoint(n.node))throw new f.ErrnoError(28);var a=n.node,l=a.mounted,c=f.getMounts(l);Object.keys(f.nameTable).forEach(w=>{for(var k=f.nameTable[w];k;){var Q=k.name_next;c.includes(k.mount)&&f.destroyNode(k),k=Q}}),a.mounted=null;var u=a.mount.mounts.indexOf(l);a.mount.mounts.splice(u,1)},lookup(r,n){return r.node_ops.lookup(r,n)},mknod(r,n,a){var l=f.lookupPath(r,{parent:!0}),c=l.node,u=Ye.basename(r);if(!u||u==="."||u==="..")throw new f.ErrnoError(28);var w=f.mayCreate(c,u);if(w)throw new f.ErrnoError(w);if(!c.node_ops.mknod)throw new f.ErrnoError(63);return c.node_ops.mknod(c,u,n,a)},create(r,n){return n=n!==void 0?n:438,n&=4095,n|=32768,f.mknod(r,n,0)},mkdir(r,n){return n=n!==void 0?n:511,n&=1023,n|=16384,f.mknod(r,n,0)},mkdirTree(r,n){for(var a=r.split("/"),l="",c=0;c<a.length;++c)if(a[c]){l+="/"+a[c];try{f.mkdir(l,n)}catch(u){if(u.errno!=20)throw u}}},mkdev(r,n,a){return typeof a>"u"&&(a=n,n=438),n|=8192,f.mknod(r,n,a)},symlink(r,n){if(!Qi.resolve(r))throw new f.ErrnoError(44);var a=f.lookupPath(n,{parent:!0}),l=a.node;if(!l)throw new f.ErrnoError(44);var c=Ye.basename(n),u=f.mayCreate(l,c);if(u)throw new f.ErrnoError(u);if(!l.node_ops.symlink)throw new f.ErrnoError(63);return l.node_ops.symlink(l,c,r)},rename(r,n){var a=Ye.dirname(r),l=Ye.dirname(n),c=Ye.basename(r),u=Ye.basename(n),w,k,Q;if(w=f.lookupPath(r,{parent:!0}),k=w.node,w=f.lookupPath(n,{parent:!0}),Q=w.node,!k||!Q)throw new f.ErrnoError(44);if(k.mount!==Q.mount)throw new f.ErrnoError(75);var z=f.lookupNode(k,c),ie=Qi.relative(r,l);if(ie.charAt(0)!==".")throw new f.ErrnoError(28);if(ie=Qi.relative(n,a),ie.charAt(0)!==".")throw new f.ErrnoError(55);var oe;try{oe=f.lookupNode(Q,u)}catch{}if(z!==oe){var U=f.isDir(z.mode),P=f.mayDelete(k,c,U);if(P)throw new f.ErrnoError(P);if(P=oe?f.mayDelete(Q,u,U):f.mayCreate(Q,u),P)throw new f.ErrnoError(P);if(!k.node_ops.rename)throw new f.ErrnoError(63);if(f.isMountpoint(z)||oe&&f.isMountpoint(oe))throw new f.ErrnoError(10);if(Q!==k&&(P=f.nodePermissions(k,"w"),P))throw new f.ErrnoError(P);f.hashRemoveNode(z);try{k.node_ops.rename(z,Q,u),z.parent=Q}catch(J){throw J}finally{f.hashAddNode(z)}}},rmdir(r){var n=f.lookupPath(r,{parent:!0}),a=n.node,l=Ye.basename(r),c=f.lookupNode(a,l),u=f.mayDelete(a,l,!0);if(u)throw new f.ErrnoError(u);if(!a.node_ops.rmdir)throw new f.ErrnoError(63);if(f.isMountpoint(c))throw new f.ErrnoError(10);a.node_ops.rmdir(a,l),f.destroyNode(c)},readdir(r){var n=f.lookupPath(r,{follow:!0}),a=n.node;if(!a.node_ops.readdir)throw new f.ErrnoError(54);return a.node_ops.readdir(a)},unlink(r){var n=f.lookupPath(r,{parent:!0}),a=n.node;if(!a)throw new f.ErrnoError(44);var l=Ye.basename(r),c=f.lookupNode(a,l),u=f.mayDelete(a,l,!1);if(u)throw new f.ErrnoError(u);if(!a.node_ops.unlink)throw new f.ErrnoError(63);if(f.isMountpoint(c))throw new f.ErrnoError(10);a.node_ops.unlink(a,l),f.destroyNode(c)},readlink(r){var n=f.lookupPath(r),a=n.node;if(!a)throw new f.ErrnoError(44);if(!a.node_ops.readlink)throw new f.ErrnoError(28);return Qi.resolve(f.getPath(a.parent),a.node_ops.readlink(a))},stat(r,n){var a=f.lookupPath(r,{follow:!n}),l=a.node;if(!l)throw new f.ErrnoError(44);if(!l.node_ops.getattr)throw new f.ErrnoError(63);return l.node_ops.getattr(l)},lstat(r){return f.stat(r,!0)},chmod(r,n,a){var l;if(typeof r=="string"){var c=f.lookupPath(r,{follow:!a});l=c.node}else l=r;if(!l.node_ops.setattr)throw new f.ErrnoError(63);l.node_ops.setattr(l,{mode:n&4095|l.mode&-4096,timestamp:Date.now()})},lchmod(r,n){f.chmod(r,n,!0)},fchmod(r,n){var a=f.getStreamChecked(r);f.chmod(a.node,n)},chown(r,n,a,l){var c;if(typeof r=="string"){var u=f.lookupPath(r,{follow:!l});c=u.node}else c=r;if(!c.node_ops.setattr)throw new f.ErrnoError(63);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown(r,n,a){f.chown(r,n,a,!0)},fchown(r,n,a){var l=f.getStreamChecked(r);f.chown(l.node,n,a)},truncate(r,n){if(n<0)throw new f.ErrnoError(28);var a;if(typeof r=="string"){var l=f.lookupPath(r,{follow:!0});a=l.node}else a=r;if(!a.node_ops.setattr)throw new f.ErrnoError(63);if(f.isDir(a.mode))throw new f.ErrnoError(31);if(!f.isFile(a.mode))throw new f.ErrnoError(28);var c=f.nodePermissions(a,"w");if(c)throw new f.ErrnoError(c);a.node_ops.setattr(a,{size:n,timestamp:Date.now()})},ftruncate(r,n){var a=f.getStreamChecked(r);if(!(a.flags&2097155))throw new f.ErrnoError(28);f.truncate(a.node,n)},utime(r,n,a){var l=f.lookupPath(r,{follow:!0}),c=l.node;c.node_ops.setattr(c,{timestamp:Math.max(n,a)})},open(r,n,a){if(r==="")throw new f.ErrnoError(44);n=typeof n=="string"?ud(n):n,n&64?(a=typeof a>"u"?438:a,a=a&4095|32768):a=0;var l;if(typeof r=="object")l=r;else{r=Ye.normalize(r);try{var c=f.lookupPath(r,{follow:!(n&131072)});l=c.node}catch{}}var u=!1;if(n&64)if(l){if(n&128)throw new f.ErrnoError(20)}else l=f.mknod(r,a,0),u=!0;if(!l)throw new f.ErrnoError(44);if(f.isChrdev(l.mode)&&(n&=-513),n&65536&&!f.isDir(l.mode))throw new f.ErrnoError(54);if(!u){var w=f.mayOpen(l,n);if(w)throw new f.ErrnoError(w)}n&512&&!u&&f.truncate(l,0),n&=-131713;var k=f.createStream({node:l,path:f.getPath(l),flags:n,seekable:!0,position:0,stream_ops:l.stream_ops,ungotten:[],error:!1});return k.stream_ops.open&&k.stream_ops.open(k),o.logReadFiles&&!(n&1)&&(r in f.readFiles||(f.readFiles[r]=1)),k},close(r){if(f.isClosed(r))throw new f.ErrnoError(8);r.getdents&&(r.getdents=null);try{r.stream_ops.close&&r.stream_ops.close(r)}catch(n){throw n}finally{f.closeStream(r.fd)}r.fd=null},isClosed(r){return r.fd===null},llseek(r,n,a){if(f.isClosed(r))throw new f.ErrnoError(8);if(!r.seekable||!r.stream_ops.llseek)throw new f.ErrnoError(70);if(a!=0&&a!=1&&a!=2)throw new f.ErrnoError(28);return r.position=r.stream_ops.llseek(r,n,a),r.ungotten=[],r.position},read(r,n,a,l,c){if(l<0||c<0)throw new f.ErrnoError(28);if(f.isClosed(r))throw new f.ErrnoError(8);if((r.flags&2097155)===1)throw new f.ErrnoError(8);if(f.isDir(r.node.mode))throw new f.ErrnoError(31);if(!r.stream_ops.read)throw new f.ErrnoError(28);var u=typeof c<"u";if(!u)c=r.position;else if(!r.seekable)throw new f.ErrnoError(70);var w=r.stream_ops.read(r,n,a,l,c);return u||(r.position+=w),w},write(r,n,a,l,c,u){if(l<0||c<0)throw new f.ErrnoError(28);if(f.isClosed(r))throw new f.ErrnoError(8);if(!(r.flags&2097155))throw new f.ErrnoError(8);if(f.isDir(r.node.mode))throw new f.ErrnoError(31);if(!r.stream_ops.write)throw new f.ErrnoError(28);r.seekable&&r.flags&1024&&f.llseek(r,0,2);var w=typeof c<"u";if(!w)c=r.position;else if(!r.seekable)throw new f.ErrnoError(70);var k=r.stream_ops.write(r,n,a,l,c,u);return w||(r.position+=k),k},allocate(r,n,a){if(f.isClosed(r))throw new f.ErrnoError(8);if(n<0||a<=0)throw new f.ErrnoError(28);if(!(r.flags&2097155))throw new f.ErrnoError(8);if(!f.isFile(r.node.mode)&&!f.isDir(r.node.mode))throw new f.ErrnoError(43);if(!r.stream_ops.allocate)throw new f.ErrnoError(138);r.stream_ops.allocate(r,n,a)},mmap(r,n,a,l,c){if(l&2&&!(c&2)&&(r.flags&2097155)!==2)throw new f.ErrnoError(2);if((r.flags&2097155)===1)throw new f.ErrnoError(2);if(!r.stream_ops.mmap)throw new f.ErrnoError(43);if(!n)throw new f.ErrnoError(28);return r.stream_ops.mmap(r,n,a,l,c)},msync(r,n,a,l,c){return r.stream_ops.msync?r.stream_ops.msync(r,n,a,l,c):0},ioctl(r,n,a){if(!r.stream_ops.ioctl)throw new f.ErrnoError(59);return r.stream_ops.ioctl(r,n,a)},readFile(r,n={}){if(n.flags=n.flags||0,n.encoding=n.encoding||"binary",n.encoding!=="utf8"&&n.encoding!=="binary")throw new Error(`Invalid encoding type "${n.encoding}"`);var a,l=f.open(r,n.flags),c=f.stat(r),u=c.size,w=new Uint8Array(u);return f.read(l,w,0,u,0),n.encoding==="utf8"?a=_n(w):n.encoding==="binary"&&(a=w),f.close(l),a},writeFile(r,n,a={}){a.flags=a.flags||577;var l=f.open(r,a.flags,a.mode);if(typeof n=="string"){var c=new Uint8Array(ro(n)+1),u=qa(n,c,0,c.length);f.write(l,c,0,u,void 0,a.canOwn)}else if(ArrayBuffer.isView(n))f.write(l,n,0,n.byteLength,void 0,a.canOwn);else throw new Error("Unsupported data type");f.close(l)},cwd:()=>f.currentPath,chdir(r){var n=f.lookupPath(r,{follow:!0});if(n.node===null)throw new f.ErrnoError(44);if(!f.isDir(n.node.mode))throw new f.ErrnoError(54);var a=f.nodePermissions(n.node,"x");if(a)throw new f.ErrnoError(a);f.currentPath=n.path},createDefaultDirectories(){f.mkdir("/tmp"),f.mkdir("/home"),f.mkdir("/home/web_user")},createDefaultDevices(){f.mkdir("/dev"),f.registerDevice(f.makedev(1,3),{read:()=>0,write:(l,c,u,w,k)=>w}),f.mkdev("/dev/null",f.makedev(1,3)),Ar.register(f.makedev(5,0),Ar.default_tty_ops),Ar.register(f.makedev(6,0),Ar.default_tty1_ops),f.mkdev("/dev/tty",f.makedev(5,0)),f.mkdev("/dev/tty1",f.makedev(6,0));var r=new Uint8Array(1024),n=0,a=()=>(n===0&&(n=Yl(r).byteLength),r[--n]);f.createDevice("/dev","random",a),f.createDevice("/dev","urandom",a),f.mkdir("/dev/shm"),f.mkdir("/dev/shm/tmp")},createSpecialDirectories(){f.mkdir("/proc");var r=f.mkdir("/proc/self");f.mkdir("/proc/self/fd"),f.mount({mount(){var n=f.createNode(r,"fd",16895,73);return n.node_ops={lookup(a,l){var c=+l,u=f.getStreamChecked(c),w={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>u.path}};return w.parent=w,w}},n}},{},"/proc/self/fd")},createStandardStreams(r,n,a){r?f.createDevice("/dev","stdin",r):f.symlink("/dev/tty","/dev/stdin"),n?f.createDevice("/dev","stdout",null,n):f.symlink("/dev/tty","/dev/stdout"),a?f.createDevice("/dev","stderr",null,a):f.symlink("/dev/tty1","/dev/stderr"),f.open("/dev/stdin",0),f.open("/dev/stdout",1),f.open("/dev/stderr",1)},staticInit(){[44].forEach(r=>{f.genericErrors[r]=new f.ErrnoError(r),f.genericErrors[r].stack="<generic error, no stack>"}),f.nameTable=new Array(4096),f.mount(Oe,{},"/"),f.createDefaultDirectories(),f.createDefaultDevices(),f.createSpecialDirectories(),f.filesystems={MEMFS:Oe}},init(r,n,a){f.initialized=!0,r??(r=o.stdin),n??(n=o.stdout),a??(a=o.stderr),f.createStandardStreams(r,n,a)},quit(){f.initialized=!1;for(var r=0;r<f.streams.length;r++){var n=f.streams[r];n&&f.close(n)}},findObject(r,n){var a=f.analyzePath(r,n);return a.exists?a.object:null},analyzePath(r,n){try{var a=f.lookupPath(r,{follow:!n});r=a.path}catch{}var l={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var a=f.lookupPath(r,{parent:!0});l.parentExists=!0,l.parentPath=a.path,l.parentObject=a.node,l.name=Ye.basename(r),a=f.lookupPath(r,{follow:!n}),l.exists=!0,l.path=a.path,l.object=a.node,l.name=a.node.name,l.isRoot=a.path==="/"}catch(c){l.error=c.errno}return l},createPath(r,n,a,l){r=typeof r=="string"?r:f.getPath(r);for(var c=n.split("/").reverse();c.length;){var u=c.pop();if(u){var w=Ye.join2(r,u);try{f.mkdir(w)}catch{}r=w}}return w},createFile(r,n,a,l,c){var u=Ye.join2(typeof r=="string"?r:f.getPath(r),n),w=Ea(l,c);return f.create(u,w)},createDataFile(r,n,a,l,c,u){var w=n;r&&(r=typeof r=="string"?r:f.getPath(r),w=n?Ye.join2(r,n):r);var k=Ea(l,c),Q=f.create(w,k);if(a){if(typeof a=="string"){for(var z=new Array(a.length),ie=0,oe=a.length;ie<oe;++ie)z[ie]=a.charCodeAt(ie);a=z}f.chmod(Q,k|146);var U=f.open(Q,577);f.write(U,a,0,a.length,0,u),f.close(U),f.chmod(Q,k)}},createDevice(r,n,a,l){var k;var c=Ye.join2(typeof r=="string"?r:f.getPath(r),n),u=Ea(!!a,!!l);(k=f.createDevice).major??(k.major=64);var w=f.makedev(f.createDevice.major++,0);return f.registerDevice(w,{open(Q){Q.seekable=!1},close(Q){var z;(z=l==null?void 0:l.buffer)!=null&&z.length&&l(10)},read(Q,z,ie,oe,U){for(var P=0,J=0;J<oe;J++){var O;try{O=a()}catch{throw new f.ErrnoError(29)}if(O===void 0&&P===0)throw new f.ErrnoError(6);if(O==null)break;P++,z[ie+J]=O}return P&&(Q.node.timestamp=Date.now()),P},write(Q,z,ie,oe,U){for(var P=0;P<oe;P++)try{l(z[ie+P])}catch{throw new f.ErrnoError(29)}return oe&&(Q.node.timestamp=Date.now()),P}}),f.mkdev(c,u,w)},forceLoadFile(r){if(r.isDevice||r.isFolder||r.link||r.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{r.contents=gt(r.url),r.usedBytes=r.contents.length}catch{throw new f.ErrnoError(29)}},createLazyFile(r,n,a,l,c){class u{constructor(){this.lengthKnown=!1,this.chunks=[]}get(P){if(!(P>this.length-1||P<0)){var J=P%this.chunkSize,O=P/this.chunkSize|0;return this.getter(O)[J]}}setDataGetter(P){this.getter=P}cacheLength(){var P=new XMLHttpRequest;if(P.open("HEAD",a,!1),P.send(null),!(P.status>=200&&P.status<300||P.status===304))throw new Error("Couldn't load "+a+". Status: "+P.status);var J=Number(P.getResponseHeader("Content-length")),O,I=(O=P.getResponseHeader("Accept-Ranges"))&&O==="bytes",D=(O=P.getResponseHeader("Content-Encoding"))&&O==="gzip",R=1024*1024;I||(R=J);var $=(K,ne)=>{if(K>ne)throw new Error("invalid range ("+K+", "+ne+") or no bytes requested!");if(ne>J-1)throw new Error("only "+J+" bytes available! programmer error!");var p=new XMLHttpRequest;if(p.open("GET",a,!1),J!==R&&p.setRequestHeader("Range","bytes="+K+"-"+ne),p.responseType="arraybuffer",p.overrideMimeType&&p.overrideMimeType("text/plain; charset=x-user-defined"),p.send(null),!(p.status>=200&&p.status<300||p.status===304))throw new Error("Couldn't load "+a+". Status: "+p.status);return p.response!==void 0?new Uint8Array(p.response||[]):Zl(p.responseText||"")},F=this;F.setDataGetter(K=>{var ne=K*R,p=(K+1)*R-1;if(p=Math.min(p,J-1),typeof F.chunks[K]>"u"&&(F.chunks[K]=$(ne,p)),typeof F.chunks[K]>"u")throw new Error("doXHR failed!");return F.chunks[K]}),(D||!J)&&(R=J=1,J=this.getter(0).length,R=J,Ue("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=J,this._chunkSize=R,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!ke)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var w=new u,k={isDevice:!1,contents:w}}else var k={isDevice:!1,url:a};var Q=f.createFile(r,n,k,l,c);k.contents?Q.contents=k.contents:k.url&&(Q.contents=null,Q.url=k.url),Object.defineProperties(Q,{usedBytes:{get:function(){return this.contents.length}}});var z={},ie=Object.keys(Q.stream_ops);ie.forEach(U=>{var P=Q.stream_ops[U];z[U]=(...J)=>(f.forceLoadFile(Q),P(...J))});function oe(U,P,J,O,I){var D=U.node.contents;if(I>=D.length)return 0;var R=Math.min(D.length-I,O);if(D.slice)for(var $=0;$<R;$++)P[J+$]=D[I+$];else for(var $=0;$<R;$++)P[J+$]=D.get(I+$);return R}return z.read=(U,P,J,O,I)=>(f.forceLoadFile(Q),oe(U,P,J,O,I)),z.mmap=(U,P,J,O,I)=>{f.forceLoadFile(Q);var D=tc(P);if(!D)throw new f.ErrnoError(48);return oe(U,Pe,D,P,J),{ptr:D,allocated:!0}},Q.stream_ops=z,Q}},dd=(r,n)=>r?_n(Mi,r,n):"",Fe={DEFAULT_POLLMASK:5,calculateAt(r,n,a){if(Ye.isAbs(n))return n;var l;if(r===-100)l=f.cwd();else{var c=Fe.getStreamFromFD(r);l=c.path}if(n.length==0){if(!a)throw new f.ErrnoError(44);return l}return Ye.join2(l,n)},doStat(r,n,a){var l=r(n);We[a>>2]=l.dev,We[a+4>>2]=l.mode,j[a+8>>2]=l.nlink,We[a+12>>2]=l.uid,We[a+16>>2]=l.gid,We[a+20>>2]=l.rdev,x[a+24>>3]=BigInt(l.size),We[a+32>>2]=4096,We[a+36>>2]=l.blocks;var c=l.atime.getTime(),u=l.mtime.getTime(),w=l.ctime.getTime();return x[a+40>>3]=BigInt(Math.floor(c/1e3)),j[a+48>>2]=c%1e3*1e3*1e3,x[a+56>>3]=BigInt(Math.floor(u/1e3)),j[a+64>>2]=u%1e3*1e3*1e3,x[a+72>>3]=BigInt(Math.floor(w/1e3)),j[a+80>>2]=w%1e3*1e3*1e3,x[a+88>>3]=BigInt(l.ino),0},doMsync(r,n,a,l,c){if(!f.isFile(n.node.mode))throw new f.ErrnoError(43);if(l&2)return 0;var u=Mi.slice(r,r+a);f.msync(n,u,c,a,l)},getStreamFromFD(r){var n=f.getStreamChecked(r);return n},varargs:void 0,getStr(r){var n=dd(r);return n}};function hd(r,n){try{return r=Fe.getStr(r),f.chmod(r,n),0}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function fd(r,n,a,l){try{if(n=Fe.getStr(n),n=Fe.calculateAt(r,n),a&-8)return-28;var c=f.lookupPath(n,{follow:!0}),u=c.node;if(!u)return-44;var w="";return a&4&&(w+="r"),a&2&&(w+="w"),a&1&&(w+="x"),w&&f.nodePermissions(u,w)?-2:0}catch(k){if(typeof f>"u"||k.name!=="ErrnoError")throw k;return-k.errno}}function pd(r,n){try{return f.fchmod(r,n),0}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function _d(r,n,a){try{return f.fchown(r,n,a),0}catch(l){if(typeof f>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}function no(){var r=We[+Fe.varargs>>2];return Fe.varargs+=4,r}var mn=no;function md(r,n,a){Fe.varargs=a;try{var l=Fe.getStreamFromFD(r);switch(n){case 0:{var c=no();if(c<0)return-28;for(;f.streams[c];)c++;var u;return u=f.dupStream(l,c),u.fd}case 1:case 2:return 0;case 3:return l.flags;case 4:{var c=no();return l.flags|=c,0}case 12:{var c=mn(),w=0;return di[c+w>>1]=2,0}case 13:case 14:return 0}return-28}catch(k){if(typeof f>"u"||k.name!=="ErrnoError")throw k;return-k.errno}}function yd(r,n){try{var a=Fe.getStreamFromFD(r);return Fe.doStat(f.stat,a.path,n)}catch(l){if(typeof f>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}var gd=9007199254740992,wd=-9007199254740992,ls=r=>r<wd||r>gd?NaN:Number(r);function bd(r,n){n=ls(n);try{return isNaN(n)?61:(f.ftruncate(r,n),0)}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}var yn=(r,n,a)=>qa(r,Mi,n,a);function Nd(r,n){try{if(n===0)return-28;var a=f.cwd(),l=ro(a)+1;return n<l?-68:(yn(a,r,n),l)}catch(c){if(typeof f>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}function qd(r,n,a){Fe.varargs=a;try{var l=Fe.getStreamFromFD(r);switch(n){case 21509:return l.tty?0:-59;case 21505:{if(!l.tty)return-59;if(l.tty.ops.ioctl_tcgets){var c=l.tty.ops.ioctl_tcgets(l),u=mn();We[u>>2]=c.c_iflag||0,We[u+4>>2]=c.c_oflag||0,We[u+8>>2]=c.c_cflag||0,We[u+12>>2]=c.c_lflag||0;for(var w=0;w<32;w++)Pe[u+w+17]=c.c_cc[w]||0;return 0}return 0}case 21510:case 21511:case 21512:return l.tty?0:-59;case 21506:case 21507:case 21508:{if(!l.tty)return-59;if(l.tty.ops.ioctl_tcsets){for(var u=mn(),k=We[u>>2],Q=We[u+4>>2],z=We[u+8>>2],ie=We[u+12>>2],oe=[],w=0;w<32;w++)oe.push(Pe[u+w+17]);return l.tty.ops.ioctl_tcsets(l.tty,n,{c_iflag:k,c_oflag:Q,c_cflag:z,c_lflag:ie,c_cc:oe})}return 0}case 21519:{if(!l.tty)return-59;var u=mn();return We[u>>2]=0,0}case 21520:return l.tty?-28:-59;case 21531:{var u=mn();return f.ioctl(l,n,u)}case 21523:{if(!l.tty)return-59;if(l.tty.ops.ioctl_tiocgwinsz){var U=l.tty.ops.ioctl_tiocgwinsz(l.tty),u=mn();di[u>>1]=U[0],di[u+2>>1]=U[1]}return 0}case 21524:return l.tty?0:-59;case 21515:return l.tty?0:-59;default:return-28}}catch(P){if(typeof f>"u"||P.name!=="ErrnoError")throw P;return-P.errno}}function Ed(r,n){try{return r=Fe.getStr(r),Fe.doStat(f.lstat,r,n)}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function vd(r,n,a){try{return n=Fe.getStr(n),n=Fe.calculateAt(r,n),n=Ye.normalize(n),n[n.length-1]==="/"&&(n=n.substr(0,n.length-1)),f.mkdir(n,a,0),0}catch(l){if(typeof f>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}function kd(r,n,a,l){try{n=Fe.getStr(n);var c=l&256,u=l&4096;return l=l&-6401,n=Fe.calculateAt(r,n,u),Fe.doStat(c?f.lstat:f.stat,n,a)}catch(w){if(typeof f>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function xd(r,n,a,l){Fe.varargs=l;try{n=Fe.getStr(n),n=Fe.calculateAt(r,n);var c=l?no():0;return f.open(n,a,c).fd}catch(u){if(typeof f>"u"||u.name!=="ErrnoError")throw u;return-u.errno}}function Sd(r,n,a,l){try{if(n=Fe.getStr(n),n=Fe.calculateAt(r,n),l<=0)return-28;var c=f.readlink(n),u=Math.min(l,ro(c)),w=Pe[a+u];return yn(c,a,l+1),Pe[a+u]=w,u}catch(k){if(typeof f>"u"||k.name!=="ErrnoError")throw k;return-k.errno}}function Ad(r){try{return r=Fe.getStr(r),f.rmdir(r),0}catch(n){if(typeof f>"u"||n.name!=="ErrnoError")throw n;return-n.errno}}function Od(r,n){try{return r=Fe.getStr(r),Fe.doStat(f.stat,r,n)}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return-a.errno}}function Cd(r,n,a){try{return n=Fe.getStr(n),n=Fe.calculateAt(r,n),a===0?f.unlink(n):a===512?f.rmdir(n):ga("Invalid flags passed to unlinkat"),0}catch(l){if(typeof f>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}var ic=r=>j[r>>2]+We[r+4>>2]*4294967296;function Id(r,n,a,l){try{n=Fe.getStr(n),n=Fe.calculateAt(r,n,!0);var c=Date.now(),u,w;if(!a)u=c,w=c;else{var k=ic(a),Q=We[a+8>>2];Q==1073741823?u=c:Q==1073741822?u=-1:u=k*1e3+Q/(1e3*1e3),a+=16,k=ic(a),Q=We[a+8>>2],Q==1073741823?w=c:Q==1073741822?w=-1:w=k*1e3+Q/(1e3*1e3)}return(w!=-1||u!=-1)&&f.utime(n,u,w),0}catch(z){if(typeof f>"u"||z.name!=="ErrnoError")throw z;return-z.errno}}var Td=1,Fd=()=>Td,Pd=r=>r%4===0&&(r%100!==0||r%400===0),Ld=[0,31,60,91,121,152,182,213,244,274,305,335],Wd=[0,31,59,90,120,151,181,212,243,273,304,334],Dd=r=>{var n=Pd(r.getFullYear()),a=n?Ld:Wd,l=a[r.getMonth()]+r.getDate()-1;return l};function Rd(r,n){r=ls(r);var a=new Date(r*1e3);We[n>>2]=a.getSeconds(),We[n+4>>2]=a.getMinutes(),We[n+8>>2]=a.getHours(),We[n+12>>2]=a.getDate(),We[n+16>>2]=a.getMonth(),We[n+20>>2]=a.getFullYear()-1900,We[n+24>>2]=a.getDay();var l=Dd(a)|0;We[n+28>>2]=l,We[n+36>>2]=-(a.getTimezoneOffset()*60);var c=new Date(a.getFullYear(),0,1),u=new Date(a.getFullYear(),6,1).getTimezoneOffset(),w=c.getTimezoneOffset(),k=(u!=w&&a.getTimezoneOffset()==Math.min(w,u))|0;We[n+32>>2]=k}function Bd(r,n,a,l,c,u,w){c=ls(c);try{if(isNaN(c))return 61;var k=Fe.getStreamFromFD(l),Q=f.mmap(k,r,c,n,a),z=Q.ptr;return We[u>>2]=Q.allocated,j[w>>2]=z,0}catch(ie){if(typeof f>"u"||ie.name!=="ErrnoError")throw ie;return-ie.errno}}function Md(r,n,a,l,c,u){u=ls(u);try{var w=Fe.getStreamFromFD(c);a&2&&Fe.doMsync(r,w,n,l,u)}catch(k){if(typeof f>"u"||k.name!=="ErrnoError")throw k;return-k.errno}}var Ud=(r,n,a,l)=>{var c=new Date().getFullYear(),u=new Date(c,0,1),w=new Date(c,6,1),k=u.getTimezoneOffset(),Q=w.getTimezoneOffset(),z=Math.max(k,Q);j[r>>2]=z*60,We[n>>2]=+(k!=Q);var ie=P=>{var J=P>=0?"-":"+",O=Math.abs(P),I=String(Math.floor(O/60)).padStart(2,"0"),D=String(O%60).padStart(2,"0");return`UTC${J}${I}${D}`},oe=ie(k),U=ie(Q);Q<k?(yn(oe,a,17),yn(U,l,17)):(yn(oe,l,17),yn(U,a,17))},Qd=()=>Date.now(),jd=()=>performance.now(),Vd=()=>2147483648,zd=r=>{var n=Bi.buffer,a=(r-n.byteLength+65535)/65536|0;try{return Bi.grow(a),we(),1}catch{}},$d=r=>{var n=Mi.length;r>>>=0;var a=Vd();if(r>a)return!1;for(var l=1;l<=4;l*=2){var c=n*(1+.2/l);c=Math.min(c,r+100663296);var u=Math.min(a,ec(Math.max(r,c),65536)),w=zd(u);if(w)return!0}return!1},va={},Hd=()=>le||"./this.program",cs=()=>{if(!cs.strings){var r=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:r,_:Hd()};for(var a in va)va[a]===void 0?delete n[a]:n[a]=va[a];var l=[];for(var a in n)l.push(`${a}=${n[a]}`);cs.strings=l}return cs.strings},Jd=(r,n)=>{for(var a=0;a<r.length;++a)Pe[n++]=r.charCodeAt(a);Pe[n]=0},Gd=(r,n)=>{var a=0;return cs().forEach((l,c)=>{var u=n+a;j[r+c*4>>2]=u,Jd(l,u),a+=l.length+1}),0},Kd=(r,n)=>{var a=cs();j[r>>2]=a.length;var l=0;return a.forEach(c=>l+=c.length+1),j[n>>2]=l,0};function Yd(r){try{var n=Fe.getStreamFromFD(r);return f.close(n),0}catch(a){if(typeof f>"u"||a.name!=="ErrnoError")throw a;return a.errno}}function Xd(r,n){try{var a=0,l=0,c=0,u=Fe.getStreamFromFD(r),w=u.tty?2:f.isDir(u.mode)?3:f.isLink(u.mode)?7:4;return Pe[n]=w,di[n+2>>1]=c,x[n+8>>3]=BigInt(a),x[n+16>>3]=BigInt(l),0}catch(k){if(typeof f>"u"||k.name!=="ErrnoError")throw k;return k.errno}}var Zd=(r,n,a,l)=>{for(var c=0,u=0;u<a;u++){var w=j[n>>2],k=j[n+4>>2];n+=8;var Q=f.read(r,Pe,w,k,l);if(Q<0)return-1;if(c+=Q,Q<k)break}return c};function eh(r,n,a,l){try{var c=Fe.getStreamFromFD(r),u=Zd(c,n,a);return j[l>>2]=u,0}catch(w){if(typeof f>"u"||w.name!=="ErrnoError")throw w;return w.errno}}function th(r,n,a,l){n=ls(n);try{if(isNaN(n))return 61;var c=Fe.getStreamFromFD(r);return f.llseek(c,n,a),x[l>>3]=BigInt(c.position),c.getdents&&n===0&&a===0&&(c.getdents=null),0}catch(u){if(typeof f>"u"||u.name!=="ErrnoError")throw u;return u.errno}}function ih(r){var a;try{var n=Fe.getStreamFromFD(r);return(a=n.stream_ops)!=null&&a.fsync?n.stream_ops.fsync(n):0}catch(l){if(typeof f>"u"||l.name!=="ErrnoError")throw l;return l.errno}}var rh=(r,n,a,l)=>{for(var c=0,u=0;u<a;u++){var w=j[n>>2],k=j[n+4>>2];n+=8;var Q=f.write(r,Pe,w,k,l);if(Q<0)return-1;if(c+=Q,Q<k)break}return c};function nh(r,n,a,l){try{var c=Fe.getStreamFromFD(r),u=rh(c,n,a);return j[l>>2]=u,0}catch(w){if(typeof f>"u"||w.name!=="ErrnoError")throw w;return w.errno}}f.createPreloadedFile=cd,f.staticInit();var rc={__syscall_chmod:hd,__syscall_faccessat:fd,__syscall_fchmod:pd,__syscall_fchown32:_d,__syscall_fcntl64:md,__syscall_fstat64:yd,__syscall_ftruncate64:bd,__syscall_getcwd:Nd,__syscall_ioctl:qd,__syscall_lstat64:Ed,__syscall_mkdirat:vd,__syscall_newfstatat:kd,__syscall_openat:xd,__syscall_readlinkat:Sd,__syscall_rmdir:Ad,__syscall_stat64:Od,__syscall_unlinkat:Cd,__syscall_utimensat:Id,_emscripten_get_now_is_monotonic:Fd,_localtime_js:Rd,_mmap_js:Bd,_munmap_js:Md,_tzset_js:Ud,emscripten_date_now:Qd,emscripten_get_now:jd,emscripten_resize_heap:$d,environ_get:Gd,environ_sizes_get:Kd,fd_close:Yd,fd_fdstat_get:Xd,fd_read:eh,fd_seek:th,fd_sync:ih,fd_write:nh,memory:Bi},N=td();o._sqlite3_status64=(r,n,a,l)=>(o._sqlite3_status64=N.sqlite3_status64)(r,n,a,l),o._sqlite3_status=(r,n,a,l)=>(o._sqlite3_status=N.sqlite3_status)(r,n,a,l),o._sqlite3_db_status=(r,n,a,l,c)=>(o._sqlite3_db_status=N.sqlite3_db_status)(r,n,a,l,c),o._sqlite3_msize=r=>(o._sqlite3_msize=N.sqlite3_msize)(r),o._sqlite3_vfs_find=r=>(o._sqlite3_vfs_find=N.sqlite3_vfs_find)(r),o._sqlite3_initialize=()=>(o._sqlite3_initialize=N.sqlite3_initialize)(),o._sqlite3_malloc=r=>(o._sqlite3_malloc=N.sqlite3_malloc)(r),o._sqlite3_free=r=>(o._sqlite3_free=N.sqlite3_free)(r),o._sqlite3_vfs_register=(r,n)=>(o._sqlite3_vfs_register=N.sqlite3_vfs_register)(r,n),o._sqlite3_vfs_unregister=r=>(o._sqlite3_vfs_unregister=N.sqlite3_vfs_unregister)(r),o._sqlite3_malloc64=r=>(o._sqlite3_malloc64=N.sqlite3_malloc64)(r),o._sqlite3_realloc=(r,n)=>(o._sqlite3_realloc=N.sqlite3_realloc)(r,n),o._sqlite3_realloc64=(r,n)=>(o._sqlite3_realloc64=N.sqlite3_realloc64)(r,n),o._sqlite3_value_text=r=>(o._sqlite3_value_text=N.sqlite3_value_text)(r),o._sqlite3_randomness=(r,n)=>(o._sqlite3_randomness=N.sqlite3_randomness)(r,n),o._sqlite3_stricmp=(r,n)=>(o._sqlite3_stricmp=N.sqlite3_stricmp)(r,n),o._sqlite3_strnicmp=(r,n,a)=>(o._sqlite3_strnicmp=N.sqlite3_strnicmp)(r,n,a),o._sqlite3_uri_parameter=(r,n)=>(o._sqlite3_uri_parameter=N.sqlite3_uri_parameter)(r,n),o._sqlite3_uri_boolean=(r,n,a)=>(o._sqlite3_uri_boolean=N.sqlite3_uri_boolean)(r,n,a),o._sqlite3_serialize=(r,n,a,l)=>(o._sqlite3_serialize=N.sqlite3_serialize)(r,n,a,l),o._sqlite3_prepare_v2=(r,n,a,l,c)=>(o._sqlite3_prepare_v2=N.sqlite3_prepare_v2)(r,n,a,l,c),o._sqlite3_step=r=>(o._sqlite3_step=N.sqlite3_step)(r),o._sqlite3_column_int64=(r,n)=>(o._sqlite3_column_int64=N.sqlite3_column_int64)(r,n),o._sqlite3_reset=r=>(o._sqlite3_reset=N.sqlite3_reset)(r),o._sqlite3_exec=(r,n,a,l,c)=>(o._sqlite3_exec=N.sqlite3_exec)(r,n,a,l,c),o._sqlite3_column_int=(r,n)=>(o._sqlite3_column_int=N.sqlite3_column_int)(r,n),o._sqlite3_finalize=r=>(o._sqlite3_finalize=N.sqlite3_finalize)(r),o._sqlite3_file_control=(r,n,a,l)=>(o._sqlite3_file_control=N.sqlite3_file_control)(r,n,a,l),o._sqlite3_column_name=(r,n)=>(o._sqlite3_column_name=N.sqlite3_column_name)(r,n),o._sqlite3_column_text=(r,n)=>(o._sqlite3_column_text=N.sqlite3_column_text)(r,n),o._sqlite3_column_type=(r,n)=>(o._sqlite3_column_type=N.sqlite3_column_type)(r,n),o._sqlite3_errmsg=r=>(o._sqlite3_errmsg=N.sqlite3_errmsg)(r),o._sqlite3_deserialize=(r,n,a,l,c,u)=>(o._sqlite3_deserialize=N.sqlite3_deserialize)(r,n,a,l,c,u),o._sqlite3_clear_bindings=r=>(o._sqlite3_clear_bindings=N.sqlite3_clear_bindings)(r),o._sqlite3_value_blob=r=>(o._sqlite3_value_blob=N.sqlite3_value_blob)(r),o._sqlite3_value_bytes=r=>(o._sqlite3_value_bytes=N.sqlite3_value_bytes)(r),o._sqlite3_value_double=r=>(o._sqlite3_value_double=N.sqlite3_value_double)(r),o._sqlite3_value_int=r=>(o._sqlite3_value_int=N.sqlite3_value_int)(r),o._sqlite3_value_int64=r=>(o._sqlite3_value_int64=N.sqlite3_value_int64)(r),o._sqlite3_value_subtype=r=>(o._sqlite3_value_subtype=N.sqlite3_value_subtype)(r),o._sqlite3_value_pointer=(r,n)=>(o._sqlite3_value_pointer=N.sqlite3_value_pointer)(r,n),o._sqlite3_value_type=r=>(o._sqlite3_value_type=N.sqlite3_value_type)(r),o._sqlite3_value_nochange=r=>(o._sqlite3_value_nochange=N.sqlite3_value_nochange)(r),o._sqlite3_value_frombind=r=>(o._sqlite3_value_frombind=N.sqlite3_value_frombind)(r),o._sqlite3_value_dup=r=>(o._sqlite3_value_dup=N.sqlite3_value_dup)(r),o._sqlite3_value_free=r=>(o._sqlite3_value_free=N.sqlite3_value_free)(r),o._sqlite3_result_blob=(r,n,a,l)=>(o._sqlite3_result_blob=N.sqlite3_result_blob)(r,n,a,l),o._sqlite3_result_error_toobig=r=>(o._sqlite3_result_error_toobig=N.sqlite3_result_error_toobig)(r),o._sqlite3_result_error_nomem=r=>(o._sqlite3_result_error_nomem=N.sqlite3_result_error_nomem)(r),o._sqlite3_result_double=(r,n)=>(o._sqlite3_result_double=N.sqlite3_result_double)(r,n),o._sqlite3_result_error=(r,n,a)=>(o._sqlite3_result_error=N.sqlite3_result_error)(r,n,a),o._sqlite3_result_int=(r,n)=>(o._sqlite3_result_int=N.sqlite3_result_int)(r,n),o._sqlite3_result_int64=(r,n)=>(o._sqlite3_result_int64=N.sqlite3_result_int64)(r,n),o._sqlite3_result_null=r=>(o._sqlite3_result_null=N.sqlite3_result_null)(r),o._sqlite3_result_pointer=(r,n,a,l)=>(o._sqlite3_result_pointer=N.sqlite3_result_pointer)(r,n,a,l),o._sqlite3_result_subtype=(r,n)=>(o._sqlite3_result_subtype=N.sqlite3_result_subtype)(r,n),o._sqlite3_result_text=(r,n,a,l)=>(o._sqlite3_result_text=N.sqlite3_result_text)(r,n,a,l),o._sqlite3_result_zeroblob=(r,n)=>(o._sqlite3_result_zeroblob=N.sqlite3_result_zeroblob)(r,n),o._sqlite3_result_zeroblob64=(r,n)=>(o._sqlite3_result_zeroblob64=N.sqlite3_result_zeroblob64)(r,n),o._sqlite3_result_error_code=(r,n)=>(o._sqlite3_result_error_code=N.sqlite3_result_error_code)(r,n),o._sqlite3_user_data=r=>(o._sqlite3_user_data=N.sqlite3_user_data)(r),o._sqlite3_context_db_handle=r=>(o._sqlite3_context_db_handle=N.sqlite3_context_db_handle)(r),o._sqlite3_vtab_nochange=r=>(o._sqlite3_vtab_nochange=N.sqlite3_vtab_nochange)(r),o._sqlite3_vtab_in_first=(r,n)=>(o._sqlite3_vtab_in_first=N.sqlite3_vtab_in_first)(r,n),o._sqlite3_vtab_in_next=(r,n)=>(o._sqlite3_vtab_in_next=N.sqlite3_vtab_in_next)(r,n),o._sqlite3_aggregate_context=(r,n)=>(o._sqlite3_aggregate_context=N.sqlite3_aggregate_context)(r,n),o._sqlite3_get_auxdata=(r,n)=>(o._sqlite3_get_auxdata=N.sqlite3_get_auxdata)(r,n),o._sqlite3_set_auxdata=(r,n,a,l)=>(o._sqlite3_set_auxdata=N.sqlite3_set_auxdata)(r,n,a,l),o._sqlite3_column_count=r=>(o._sqlite3_column_count=N.sqlite3_column_count)(r),o._sqlite3_data_count=r=>(o._sqlite3_data_count=N.sqlite3_data_count)(r),o._sqlite3_column_blob=(r,n)=>(o._sqlite3_column_blob=N.sqlite3_column_blob)(r,n),o._sqlite3_column_bytes=(r,n)=>(o._sqlite3_column_bytes=N.sqlite3_column_bytes)(r,n),o._sqlite3_column_double=(r,n)=>(o._sqlite3_column_double=N.sqlite3_column_double)(r,n),o._sqlite3_column_value=(r,n)=>(o._sqlite3_column_value=N.sqlite3_column_value)(r,n),o._sqlite3_column_decltype=(r,n)=>(o._sqlite3_column_decltype=N.sqlite3_column_decltype)(r,n),o._sqlite3_bind_blob=(r,n,a,l,c)=>(o._sqlite3_bind_blob=N.sqlite3_bind_blob)(r,n,a,l,c),o._sqlite3_bind_double=(r,n,a)=>(o._sqlite3_bind_double=N.sqlite3_bind_double)(r,n,a),o._sqlite3_bind_int=(r,n,a)=>(o._sqlite3_bind_int=N.sqlite3_bind_int)(r,n,a),o._sqlite3_bind_int64=(r,n,a)=>(o._sqlite3_bind_int64=N.sqlite3_bind_int64)(r,n,a),o._sqlite3_bind_null=(r,n)=>(o._sqlite3_bind_null=N.sqlite3_bind_null)(r,n),o._sqlite3_bind_pointer=(r,n,a,l,c)=>(o._sqlite3_bind_pointer=N.sqlite3_bind_pointer)(r,n,a,l,c),o._sqlite3_bind_text=(r,n,a,l,c)=>(o._sqlite3_bind_text=N.sqlite3_bind_text)(r,n,a,l,c),o._sqlite3_bind_parameter_count=r=>(o._sqlite3_bind_parameter_count=N.sqlite3_bind_parameter_count)(r),o._sqlite3_bind_parameter_name=(r,n)=>(o._sqlite3_bind_parameter_name=N.sqlite3_bind_parameter_name)(r,n),o._sqlite3_bind_parameter_index=(r,n)=>(o._sqlite3_bind_parameter_index=N.sqlite3_bind_parameter_index)(r,n),o._sqlite3_db_handle=r=>(o._sqlite3_db_handle=N.sqlite3_db_handle)(r),o._sqlite3_stmt_readonly=r=>(o._sqlite3_stmt_readonly=N.sqlite3_stmt_readonly)(r),o._sqlite3_stmt_isexplain=r=>(o._sqlite3_stmt_isexplain=N.sqlite3_stmt_isexplain)(r),o._sqlite3_stmt_explain=(r,n)=>(o._sqlite3_stmt_explain=N.sqlite3_stmt_explain)(r,n),o._sqlite3_stmt_busy=r=>(o._sqlite3_stmt_busy=N.sqlite3_stmt_busy)(r),o._sqlite3_stmt_status=(r,n,a)=>(o._sqlite3_stmt_status=N.sqlite3_stmt_status)(r,n,a),o._sqlite3_sql=r=>(o._sqlite3_sql=N.sqlite3_sql)(r),o._sqlite3_expanded_sql=r=>(o._sqlite3_expanded_sql=N.sqlite3_expanded_sql)(r),o._sqlite3_preupdate_old=(r,n,a)=>(o._sqlite3_preupdate_old=N.sqlite3_preupdate_old)(r,n,a),o._sqlite3_preupdate_count=r=>(o._sqlite3_preupdate_count=N.sqlite3_preupdate_count)(r),o._sqlite3_preupdate_depth=r=>(o._sqlite3_preupdate_depth=N.sqlite3_preupdate_depth)(r),o._sqlite3_preupdate_blobwrite=r=>(o._sqlite3_preupdate_blobwrite=N.sqlite3_preupdate_blobwrite)(r),o._sqlite3_preupdate_new=(r,n,a)=>(o._sqlite3_preupdate_new=N.sqlite3_preupdate_new)(r,n,a),o._sqlite3_value_numeric_type=r=>(o._sqlite3_value_numeric_type=N.sqlite3_value_numeric_type)(r),o._sqlite3_set_authorizer=(r,n,a)=>(o._sqlite3_set_authorizer=N.sqlite3_set_authorizer)(r,n,a),o._sqlite3_strglob=(r,n)=>(o._sqlite3_strglob=N.sqlite3_strglob)(r,n),o._sqlite3_strlike=(r,n,a)=>(o._sqlite3_strlike=N.sqlite3_strlike)(r,n,a),o._sqlite3_auto_extension=r=>(o._sqlite3_auto_extension=N.sqlite3_auto_extension)(r),o._sqlite3_cancel_auto_extension=r=>(o._sqlite3_cancel_auto_extension=N.sqlite3_cancel_auto_extension)(r),o._sqlite3_reset_auto_extension=()=>(o._sqlite3_reset_auto_extension=N.sqlite3_reset_auto_extension)(),o._sqlite3_prepare_v3=(r,n,a,l,c,u)=>(o._sqlite3_prepare_v3=N.sqlite3_prepare_v3)(r,n,a,l,c,u),o._sqlite3_create_module=(r,n,a,l)=>(o._sqlite3_create_module=N.sqlite3_create_module)(r,n,a,l),o._sqlite3_create_module_v2=(r,n,a,l,c)=>(o._sqlite3_create_module_v2=N.sqlite3_create_module_v2)(r,n,a,l,c),o._sqlite3_drop_modules=(r,n)=>(o._sqlite3_drop_modules=N.sqlite3_drop_modules)(r,n),o._sqlite3_declare_vtab=(r,n)=>(o._sqlite3_declare_vtab=N.sqlite3_declare_vtab)(r,n),o._sqlite3_vtab_on_conflict=r=>(o._sqlite3_vtab_on_conflict=N.sqlite3_vtab_on_conflict)(r),o._sqlite3_vtab_collation=(r,n)=>(o._sqlite3_vtab_collation=N.sqlite3_vtab_collation)(r,n),o._sqlite3_vtab_in=(r,n,a)=>(o._sqlite3_vtab_in=N.sqlite3_vtab_in)(r,n,a),o._sqlite3_vtab_rhs_value=(r,n,a)=>(o._sqlite3_vtab_rhs_value=N.sqlite3_vtab_rhs_value)(r,n,a),o._sqlite3_vtab_distinct=r=>(o._sqlite3_vtab_distinct=N.sqlite3_vtab_distinct)(r),o._sqlite3_keyword_name=(r,n,a)=>(o._sqlite3_keyword_name=N.sqlite3_keyword_name)(r,n,a),o._sqlite3_keyword_count=()=>(o._sqlite3_keyword_count=N.sqlite3_keyword_count)(),o._sqlite3_keyword_check=(r,n)=>(o._sqlite3_keyword_check=N.sqlite3_keyword_check)(r,n),o._sqlite3_complete=r=>(o._sqlite3_complete=N.sqlite3_complete)(r),o._sqlite3_libversion=()=>(o._sqlite3_libversion=N.sqlite3_libversion)(),o._sqlite3_libversion_number=()=>(o._sqlite3_libversion_number=N.sqlite3_libversion_number)(),o._sqlite3_shutdown=()=>(o._sqlite3_shutdown=N.sqlite3_shutdown)(),o._sqlite3_last_insert_rowid=r=>(o._sqlite3_last_insert_rowid=N.sqlite3_last_insert_rowid)(r),o._sqlite3_set_last_insert_rowid=(r,n)=>(o._sqlite3_set_last_insert_rowid=N.sqlite3_set_last_insert_rowid)(r,n),o._sqlite3_changes64=r=>(o._sqlite3_changes64=N.sqlite3_changes64)(r),o._sqlite3_changes=r=>(o._sqlite3_changes=N.sqlite3_changes)(r),o._sqlite3_total_changes64=r=>(o._sqlite3_total_changes64=N.sqlite3_total_changes64)(r),o._sqlite3_total_changes=r=>(o._sqlite3_total_changes=N.sqlite3_total_changes)(r),o._sqlite3_txn_state=(r,n)=>(o._sqlite3_txn_state=N.sqlite3_txn_state)(r,n),o._sqlite3_close_v2=r=>(o._sqlite3_close_v2=N.sqlite3_close_v2)(r),o._sqlite3_busy_handler=(r,n,a)=>(o._sqlite3_busy_handler=N.sqlite3_busy_handler)(r,n,a),o._sqlite3_progress_handler=(r,n,a,l)=>(o._sqlite3_progress_handler=N.sqlite3_progress_handler)(r,n,a,l),o._sqlite3_busy_timeout=(r,n)=>(o._sqlite3_busy_timeout=N.sqlite3_busy_timeout)(r,n),o._sqlite3_interrupt=r=>(o._sqlite3_interrupt=N.sqlite3_interrupt)(r),o._sqlite3_is_interrupted=r=>(o._sqlite3_is_interrupted=N.sqlite3_is_interrupted)(r),o._sqlite3_create_function=(r,n,a,l,c,u,w,k)=>(o._sqlite3_create_function=N.sqlite3_create_function)(r,n,a,l,c,u,w,k),o._sqlite3_create_function_v2=(r,n,a,l,c,u,w,k,Q)=>(o._sqlite3_create_function_v2=N.sqlite3_create_function_v2)(r,n,a,l,c,u,w,k,Q),o._sqlite3_create_window_function=(r,n,a,l,c,u,w,k,Q,z)=>(o._sqlite3_create_window_function=N.sqlite3_create_window_function)(r,n,a,l,c,u,w,k,Q,z),o._sqlite3_overload_function=(r,n,a)=>(o._sqlite3_overload_function=N.sqlite3_overload_function)(r,n,a),o._sqlite3_trace_v2=(r,n,a,l)=>(o._sqlite3_trace_v2=N.sqlite3_trace_v2)(r,n,a,l),o._sqlite3_commit_hook=(r,n,a)=>(o._sqlite3_commit_hook=N.sqlite3_commit_hook)(r,n,a),o._sqlite3_update_hook=(r,n,a)=>(o._sqlite3_update_hook=N.sqlite3_update_hook)(r,n,a),o._sqlite3_rollback_hook=(r,n,a)=>(o._sqlite3_rollback_hook=N.sqlite3_rollback_hook)(r,n,a),o._sqlite3_preupdate_hook=(r,n,a)=>(o._sqlite3_preupdate_hook=N.sqlite3_preupdate_hook)(r,n,a),o._sqlite3_error_offset=r=>(o._sqlite3_error_offset=N.sqlite3_error_offset)(r),o._sqlite3_errcode=r=>(o._sqlite3_errcode=N.sqlite3_errcode)(r),o._sqlite3_extended_errcode=r=>(o._sqlite3_extended_errcode=N.sqlite3_extended_errcode)(r),o._sqlite3_errstr=r=>(o._sqlite3_errstr=N.sqlite3_errstr)(r),o._sqlite3_limit=(r,n,a)=>(o._sqlite3_limit=N.sqlite3_limit)(r,n,a),o._sqlite3_open=(r,n)=>(o._sqlite3_open=N.sqlite3_open)(r,n),o._sqlite3_open_v2=(r,n,a,l)=>(o._sqlite3_open_v2=N.sqlite3_open_v2)(r,n,a,l),o._sqlite3_create_collation=(r,n,a,l,c)=>(o._sqlite3_create_collation=N.sqlite3_create_collation)(r,n,a,l,c),o._sqlite3_create_collation_v2=(r,n,a,l,c,u)=>(o._sqlite3_create_collation_v2=N.sqlite3_create_collation_v2)(r,n,a,l,c,u),o._sqlite3_collation_needed=(r,n,a)=>(o._sqlite3_collation_needed=N.sqlite3_collation_needed)(r,n,a),o._sqlite3_get_autocommit=r=>(o._sqlite3_get_autocommit=N.sqlite3_get_autocommit)(r),o._sqlite3_table_column_metadata=(r,n,a,l,c,u,w,k,Q)=>(o._sqlite3_table_column_metadata=N.sqlite3_table_column_metadata)(r,n,a,l,c,u,w,k,Q),o._sqlite3_extended_result_codes=(r,n)=>(o._sqlite3_extended_result_codes=N.sqlite3_extended_result_codes)(r,n),o._sqlite3_uri_key=(r,n)=>(o._sqlite3_uri_key=N.sqlite3_uri_key)(r,n),o._sqlite3_uri_int64=(r,n,a)=>(o._sqlite3_uri_int64=N.sqlite3_uri_int64)(r,n,a),o._sqlite3_db_name=(r,n)=>(o._sqlite3_db_name=N.sqlite3_db_name)(r,n),o._sqlite3_db_filename=(r,n)=>(o._sqlite3_db_filename=N.sqlite3_db_filename)(r,n),o._sqlite3_db_readonly=(r,n)=>(o._sqlite3_db_readonly=N.sqlite3_db_readonly)(r,n),o._sqlite3_compileoption_used=r=>(o._sqlite3_compileoption_used=N.sqlite3_compileoption_used)(r),o._sqlite3_compileoption_get=r=>(o._sqlite3_compileoption_get=N.sqlite3_compileoption_get)(r),o._sqlite3session_diff=(r,n,a,l)=>(o._sqlite3session_diff=N.sqlite3session_diff)(r,n,a,l),o._sqlite3session_attach=(r,n)=>(o._sqlite3session_attach=N.sqlite3session_attach)(r,n),o._sqlite3session_create=(r,n,a)=>(o._sqlite3session_create=N.sqlite3session_create)(r,n,a),o._sqlite3session_delete=r=>(o._sqlite3session_delete=N.sqlite3session_delete)(r),o._sqlite3session_table_filter=(r,n,a)=>(o._sqlite3session_table_filter=N.sqlite3session_table_filter)(r,n,a),o._sqlite3session_changeset=(r,n,a)=>(o._sqlite3session_changeset=N.sqlite3session_changeset)(r,n,a),o._sqlite3session_changeset_strm=(r,n,a)=>(o._sqlite3session_changeset_strm=N.sqlite3session_changeset_strm)(r,n,a),o._sqlite3session_patchset_strm=(r,n,a)=>(o._sqlite3session_patchset_strm=N.sqlite3session_patchset_strm)(r,n,a),o._sqlite3session_patchset=(r,n,a)=>(o._sqlite3session_patchset=N.sqlite3session_patchset)(r,n,a),o._sqlite3session_enable=(r,n)=>(o._sqlite3session_enable=N.sqlite3session_enable)(r,n),o._sqlite3session_indirect=(r,n)=>(o._sqlite3session_indirect=N.sqlite3session_indirect)(r,n),o._sqlite3session_isempty=r=>(o._sqlite3session_isempty=N.sqlite3session_isempty)(r),o._sqlite3session_memory_used=r=>(o._sqlite3session_memory_used=N.sqlite3session_memory_used)(r),o._sqlite3session_object_config=(r,n,a)=>(o._sqlite3session_object_config=N.sqlite3session_object_config)(r,n,a),o._sqlite3session_changeset_size=r=>(o._sqlite3session_changeset_size=N.sqlite3session_changeset_size)(r),o._sqlite3changeset_start=(r,n,a)=>(o._sqlite3changeset_start=N.sqlite3changeset_start)(r,n,a),o._sqlite3changeset_start_v2=(r,n,a,l)=>(o._sqlite3changeset_start_v2=N.sqlite3changeset_start_v2)(r,n,a,l),o._sqlite3changeset_start_strm=(r,n,a)=>(o._sqlite3changeset_start_strm=N.sqlite3changeset_start_strm)(r,n,a),o._sqlite3changeset_start_v2_strm=(r,n,a,l)=>(o._sqlite3changeset_start_v2_strm=N.sqlite3changeset_start_v2_strm)(r,n,a,l),o._sqlite3changeset_next=r=>(o._sqlite3changeset_next=N.sqlite3changeset_next)(r),o._sqlite3changeset_op=(r,n,a,l,c)=>(o._sqlite3changeset_op=N.sqlite3changeset_op)(r,n,a,l,c),o._sqlite3changeset_pk=(r,n,a)=>(o._sqlite3changeset_pk=N.sqlite3changeset_pk)(r,n,a),o._sqlite3changeset_old=(r,n,a)=>(o._sqlite3changeset_old=N.sqlite3changeset_old)(r,n,a),o._sqlite3changeset_new=(r,n,a)=>(o._sqlite3changeset_new=N.sqlite3changeset_new)(r,n,a),o._sqlite3changeset_conflict=(r,n,a)=>(o._sqlite3changeset_conflict=N.sqlite3changeset_conflict)(r,n,a),o._sqlite3changeset_fk_conflicts=(r,n)=>(o._sqlite3changeset_fk_conflicts=N.sqlite3changeset_fk_conflicts)(r,n),o._sqlite3changeset_finalize=r=>(o._sqlite3changeset_finalize=N.sqlite3changeset_finalize)(r),o._sqlite3changeset_invert=(r,n,a,l)=>(o._sqlite3changeset_invert=N.sqlite3changeset_invert)(r,n,a,l),o._sqlite3changeset_invert_strm=(r,n,a,l)=>(o._sqlite3changeset_invert_strm=N.sqlite3changeset_invert_strm)(r,n,a,l),o._sqlite3changeset_apply_v2=(r,n,a,l,c,u,w,k,Q)=>(o._sqlite3changeset_apply_v2=N.sqlite3changeset_apply_v2)(r,n,a,l,c,u,w,k,Q),o._sqlite3changeset_apply=(r,n,a,l,c,u)=>(o._sqlite3changeset_apply=N.sqlite3changeset_apply)(r,n,a,l,c,u),o._sqlite3changeset_apply_v2_strm=(r,n,a,l,c,u,w,k,Q)=>(o._sqlite3changeset_apply_v2_strm=N.sqlite3changeset_apply_v2_strm)(r,n,a,l,c,u,w,k,Q),o._sqlite3changeset_apply_strm=(r,n,a,l,c,u)=>(o._sqlite3changeset_apply_strm=N.sqlite3changeset_apply_strm)(r,n,a,l,c,u),o._sqlite3changegroup_new=r=>(o._sqlite3changegroup_new=N.sqlite3changegroup_new)(r),o._sqlite3changegroup_add=(r,n,a)=>(o._sqlite3changegroup_add=N.sqlite3changegroup_add)(r,n,a),o._sqlite3changegroup_output=(r,n,a)=>(o._sqlite3changegroup_output=N.sqlite3changegroup_output)(r,n,a),o._sqlite3changegroup_add_strm=(r,n,a)=>(o._sqlite3changegroup_add_strm=N.sqlite3changegroup_add_strm)(r,n,a),o._sqlite3changegroup_output_strm=(r,n,a)=>(o._sqlite3changegroup_output_strm=N.sqlite3changegroup_output_strm)(r,n,a),o._sqlite3changegroup_delete=r=>(o._sqlite3changegroup_delete=N.sqlite3changegroup_delete)(r),o._sqlite3changeset_concat=(r,n,a,l,c,u)=>(o._sqlite3changeset_concat=N.sqlite3changeset_concat)(r,n,a,l,c,u),o._sqlite3changeset_concat_strm=(r,n,a,l,c,u)=>(o._sqlite3changeset_concat_strm=N.sqlite3changeset_concat_strm)(r,n,a,l,c,u),o._sqlite3session_config=(r,n)=>(o._sqlite3session_config=N.sqlite3session_config)(r,n),o._sqlite3_sourceid=()=>(o._sqlite3_sourceid=N.sqlite3_sourceid)(),o._sqlite3__wasm_pstack_ptr=()=>(o._sqlite3__wasm_pstack_ptr=N.sqlite3__wasm_pstack_ptr)(),o._sqlite3__wasm_pstack_restore=r=>(o._sqlite3__wasm_pstack_restore=N.sqlite3__wasm_pstack_restore)(r),o._sqlite3__wasm_pstack_alloc=r=>(o._sqlite3__wasm_pstack_alloc=N.sqlite3__wasm_pstack_alloc)(r),o._sqlite3__wasm_pstack_remaining=()=>(o._sqlite3__wasm_pstack_remaining=N.sqlite3__wasm_pstack_remaining)(),o._sqlite3__wasm_pstack_quota=()=>(o._sqlite3__wasm_pstack_quota=N.sqlite3__wasm_pstack_quota)(),o._sqlite3__wasm_db_error=(r,n,a)=>(o._sqlite3__wasm_db_error=N.sqlite3__wasm_db_error)(r,n,a),o._sqlite3__wasm_test_struct=r=>(o._sqlite3__wasm_test_struct=N.sqlite3__wasm_test_struct)(r),o._sqlite3__wasm_enum_json=()=>(o._sqlite3__wasm_enum_json=N.sqlite3__wasm_enum_json)(),o._sqlite3__wasm_vfs_unlink=(r,n)=>(o._sqlite3__wasm_vfs_unlink=N.sqlite3__wasm_vfs_unlink)(r,n),o._sqlite3__wasm_db_vfs=(r,n)=>(o._sqlite3__wasm_db_vfs=N.sqlite3__wasm_db_vfs)(r,n),o._sqlite3__wasm_db_reset=r=>(o._sqlite3__wasm_db_reset=N.sqlite3__wasm_db_reset)(r),o._sqlite3__wasm_db_export_chunked=(r,n)=>(o._sqlite3__wasm_db_export_chunked=N.sqlite3__wasm_db_export_chunked)(r,n),o._sqlite3__wasm_db_serialize=(r,n,a,l,c)=>(o._sqlite3__wasm_db_serialize=N.sqlite3__wasm_db_serialize)(r,n,a,l,c),o._sqlite3__wasm_vfs_create_file=(r,n,a,l)=>(o._sqlite3__wasm_vfs_create_file=N.sqlite3__wasm_vfs_create_file)(r,n,a,l),o._sqlite3__wasm_posix_create_file=(r,n,a)=>(o._sqlite3__wasm_posix_create_file=N.sqlite3__wasm_posix_create_file)(r,n,a),o._sqlite3__wasm_kvvfsMakeKeyOnPstack=(r,n)=>(o._sqlite3__wasm_kvvfsMakeKeyOnPstack=N.sqlite3__wasm_kvvfsMakeKeyOnPstack)(r,n),o._sqlite3__wasm_kvvfs_methods=()=>(o._sqlite3__wasm_kvvfs_methods=N.sqlite3__wasm_kvvfs_methods)(),o._sqlite3__wasm_vtab_config=(r,n,a)=>(o._sqlite3__wasm_vtab_config=N.sqlite3__wasm_vtab_config)(r,n,a),o._sqlite3__wasm_db_config_ip=(r,n,a,l)=>(o._sqlite3__wasm_db_config_ip=N.sqlite3__wasm_db_config_ip)(r,n,a,l),o._sqlite3__wasm_db_config_pii=(r,n,a,l,c)=>(o._sqlite3__wasm_db_config_pii=N.sqlite3__wasm_db_config_pii)(r,n,a,l,c),o._sqlite3__wasm_db_config_s=(r,n,a)=>(o._sqlite3__wasm_db_config_s=N.sqlite3__wasm_db_config_s)(r,n,a),o._sqlite3__wasm_config_i=(r,n)=>(o._sqlite3__wasm_config_i=N.sqlite3__wasm_config_i)(r,n),o._sqlite3__wasm_config_ii=(r,n,a)=>(o._sqlite3__wasm_config_ii=N.sqlite3__wasm_config_ii)(r,n,a),o._sqlite3__wasm_config_j=(r,n)=>(o._sqlite3__wasm_config_j=N.sqlite3__wasm_config_j)(r,n),o._sqlite3__wasm_qfmt_token=(r,n)=>(o._sqlite3__wasm_qfmt_token=N.sqlite3__wasm_qfmt_token)(r,n),o._sqlite3__wasm_init_wasmfs=r=>(o._sqlite3__wasm_init_wasmfs=N.sqlite3__wasm_init_wasmfs)(r),o._sqlite3__wasm_test_intptr=r=>(o._sqlite3__wasm_test_intptr=N.sqlite3__wasm_test_intptr)(r),o._sqlite3__wasm_test_voidptr=r=>(o._sqlite3__wasm_test_voidptr=N.sqlite3__wasm_test_voidptr)(r),o._sqlite3__wasm_test_int64_max=()=>(o._sqlite3__wasm_test_int64_max=N.sqlite3__wasm_test_int64_max)(),o._sqlite3__wasm_test_int64_min=()=>(o._sqlite3__wasm_test_int64_min=N.sqlite3__wasm_test_int64_min)(),o._sqlite3__wasm_test_int64_times2=r=>(o._sqlite3__wasm_test_int64_times2=N.sqlite3__wasm_test_int64_times2)(r),o._sqlite3__wasm_test_int64_minmax=(r,n)=>(o._sqlite3__wasm_test_int64_minmax=N.sqlite3__wasm_test_int64_minmax)(r,n),o._sqlite3__wasm_test_int64ptr=r=>(o._sqlite3__wasm_test_int64ptr=N.sqlite3__wasm_test_int64ptr)(r),o._sqlite3__wasm_test_stack_overflow=r=>(o._sqlite3__wasm_test_stack_overflow=N.sqlite3__wasm_test_stack_overflow)(r),o._sqlite3__wasm_test_str_hello=r=>(o._sqlite3__wasm_test_str_hello=N.sqlite3__wasm_test_str_hello)(r),o._sqlite3__wasm_SQLTester_strglob=(r,n)=>(o._sqlite3__wasm_SQLTester_strglob=N.sqlite3__wasm_SQLTester_strglob)(r,n),o._malloc=r=>(o._malloc=N.malloc)(r),o._free=r=>(o._free=N.free)(r),o._realloc=(r,n)=>(o._realloc=N.realloc)(r,n);var nc=(r,n)=>(nc=N.emscripten_builtin_memalign)(r,n);o.wasmMemory=Bi;var so,sc;as=function r(){so||oc(),so||(as=r)};function oc(){if(Sr>0||!sc&&(sc=1,Ui(),Sr>0))return;function r(){var n;so||(so=1,o.calledRun=1,!to&&(cr(),m(o),(n=o.onRuntimeInitialized)==null||n.call(o),os()))}o.setStatus?(o.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>o.setStatus(""),1),r()},1)):r()}if(o.preInit)for(typeof o.preInit=="function"&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return oc(),o.runSQLite3PostLoadInit=function(r){if(globalThis.sqlite3ApiBootstrap=function n(a=globalThis.sqlite3ApiConfig||n.defaultConfig){if(n.sqlite3)return(n.sqlite3.config||console).warn("sqlite3ApiBootstrap() called multiple times.","Config and external initializers are ignored on calls after the first."),n.sqlite3;const l=Object.assign(Object.create(null),{exports:void 0,memory:void 0,bigIntEnabled:typeof o<"u"&&o.HEAPU64?!0:!!globalThis.BigInt64Array,debug:console.debug.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),log:console.log.bind(console),wasmfsOpfsDir:"/opfs",useStdAlloc:!1},a||{});Object.assign(l,{allocExportName:l.useStdAlloc?"malloc":"sqlite3_malloc",deallocExportName:l.useStdAlloc?"free":"sqlite3_free",reallocExportName:l.useStdAlloc?"realloc":"sqlite3_realloc"},l),["exports","memory","wasmfsOpfsDir"].forEach(h=>{typeof l[h]=="function"&&(l[h]=l[h]())}),delete globalThis.sqlite3ApiConfig,delete n.defaultConfig;const c=Object.create(null),u=Object.create(null),w=h=>c.sqlite3_js_rc_str&&c.sqlite3_js_rc_str(h)||"Unknown result code #"+h,k=h=>typeof h=="number"&&h===(h|0);class Q extends Error{constructor(..._){let S;if(_.length)if(k(_[0]))if(S=_[0],_.length===1)super(w(_[0]));else{const A=w(S);typeof _[1]=="object"?super(A,_[1]):(_[0]=A+":",super(_.join(" ")))}else _.length===2&&typeof _[1]=="object"?super(..._):super(_.join(" "));this.resultCode=S||c.SQLITE_ERROR,this.name="SQLite3Error"}}Q.toss=(...h)=>{throw new Q(...h)};const z=Q.toss;l.wasmfsOpfsDir&&!/^\/[^/]+$/.test(l.wasmfsOpfsDir)&&z("config.wasmfsOpfsDir must be falsy or in the form '/dir-name'.");const ie=h=>typeof h!="bigint"&&h===(h|0)&&h<=2147483647&&h>=-2147483648,oe=function h(_){return h._max||(h._max=BigInt("0x7fffffffffffffff"),h._min=~h._max),_>=h._min&&_<=h._max},U=h=>h>=-0x7fffffffn-1n&&h<=0x7fffffffn,P=function h(_){return h._min||(h._min=Number.MIN_SAFE_INTEGER,h._max=Number.MAX_SAFE_INTEGER),_>=h._min&&_<=h._max},J=h=>h&&h.constructor&&ie(h.constructor.BYTES_PER_ELEMENT)?h:!1,O=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,I=h=>h.buffer instanceof O,D=(h,_,S)=>I(h)?h.slice(_,S):h.subarray(_,S),R=h=>h&&(h instanceof Uint8Array||h instanceof Int8Array||h instanceof ArrayBuffer),$=h=>h&&(h instanceof Uint8Array||h instanceof Int8Array||h instanceof ArrayBuffer),F=h=>R(h)||z("Value is not of a supported TypedArray type."),K=new TextDecoder("utf-8"),ne=function(h,_,S){return K.decode(D(h,_,S))},p=function(h){return $(h)?ne(h instanceof ArrayBuffer?new Uint8Array(h):h):Array.isArray(h)?h.join(""):(u.isPtr(h)&&(h=u.cstrToJs(h)),h)};class E extends Error{constructor(..._){_.length===2&&typeof _[1]=="object"?super(..._):_.length?super(_.join(" ")):super("Allocation failed."),this.resultCode=c.SQLITE_NOMEM,this.name="WasmAllocError"}}E.toss=(...h)=>{throw new E(...h)},Object.assign(c,{sqlite3_bind_blob:void 0,sqlite3_bind_text:void 0,sqlite3_create_function_v2:(h,_,S,A,Z,he,be,Ae,Ee)=>{},sqlite3_create_function:(h,_,S,A,Z,he,be,Ae)=>{},sqlite3_create_window_function:(h,_,S,A,Z,he,be,Ae,Ee,ve)=>{},sqlite3_prepare_v3:(h,_,S,A,Z,he)=>{},sqlite3_prepare_v2:(h,_,S,A,Z)=>{},sqlite3_exec:(h,_,S,A,Z)=>{},sqlite3_randomness:(h,_)=>{}});const C={affirmBindableTypedArray:F,flexibleString:p,bigIntFits32:U,bigIntFits64:oe,bigIntFitsDouble:P,isBindableTypedArray:R,isInt32:ie,isSQLableTypedArray:$,isTypedArray:J,typedArrayToString:ne,isUIThread:()=>globalThis.window===globalThis&&!!globalThis.document,isSharedTypedArray:I,toss:function(...h){throw new Error(h.join(" "))},toss3:z,typedArrayPart:D,affirmDbHeader:function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));const _="SQLite format 3";_.length>h.byteLength&&z("Input does not contain an SQLite3 database header.");for(let S=0;S<_.length;++S)_.charCodeAt(S)!==h[S]&&z("Input does not contain an SQLite3 database header.")},affirmIsDb:function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h));const _=h.byteLength;(_<512||_%512!==0)&&z("Byte array size",_,"is invalid for an SQLite3 db."),C.affirmDbHeader(h)}};Object.assign(u,{ptrSizeof:l.wasmPtrSizeof||4,ptrIR:l.wasmPtrIR||"i32",bigIntEnabled:!!l.bigIntEnabled,exports:l.exports||z("Missing API config.exports (WASM module exports)."),memory:l.memory||l.exports.memory||z("API config object requires a WebAssembly.Memory object","in either config.exports.memory (exported)","or config.memory (imported)."),alloc:void 0,realloc:void 0,dealloc:void 0}),u.allocFromTypedArray=function(h){h instanceof ArrayBuffer&&(h=new Uint8Array(h)),F(h);const _=u.alloc(h.byteLength||1);return u.heapForSize(h.constructor).set(h.byteLength?h:[0],_),_};{const h=l.allocExportName,_=l.deallocExportName,S=l.reallocExportName;for(const A of[h,_,S])u.exports[A]instanceof Function||z("Missing required exports[",A,"] function.");u.alloc=function A(Z){return A.impl(Z)||E.toss("Failed to allocate",Z," bytes.")},u.alloc.impl=u.exports[h],u.realloc=function A(Z,he){const be=A.impl(Z,he);return he?be||E.toss("Failed to reallocate",he," bytes."):0},u.realloc.impl=u.exports[S],u.dealloc=u.exports[_]}u.compileOptionUsed=function h(_){if(arguments.length){if(Array.isArray(_)){const S={};return _.forEach(A=>{S[A]=c.sqlite3_compileoption_used(A)}),S}else if(typeof _=="object")return Object.keys(_).forEach(S=>{_[S]=c.sqlite3_compileoption_used(S)}),_}else{if(h._result)return h._result;h._opt||(h._rx=/^([^=]+)=(.+)/,h._rxInt=/^-?\d+$/,h._opt=function(be,Ae){const Ee=h._rx.exec(be);Ae[0]=Ee?Ee[1]:be,Ae[1]=Ee?h._rxInt.test(Ee[2])?+Ee[2]:Ee[2]:!0});const S={},A=[0,0];let Z=0,he;for(;he=c.sqlite3_compileoption_get(Z++);)h._opt(he,A),S[A[0]]=A[1];return h._result=S}return typeof _=="string"?!!c.sqlite3_compileoption_used(_):!1},u.pstack=Object.assign(Object.create(null),{restore:u.exports.sqlite3__wasm_pstack_restore,alloc:function(h){return typeof h=="string"&&!(h=u.sizeofIR(h))&&E.toss("Invalid value for pstack.alloc(",arguments[0],")"),u.exports.sqlite3__wasm_pstack_alloc(h)||E.toss("Could not allocate",h,"bytes from the pstack.")},allocChunks:function(h,_){typeof _=="string"&&!(_=u.sizeofIR(_))&&E.toss("Invalid size value for allocChunks(",arguments[1],")");const S=u.pstack.alloc(h*_),A=[];let Z=0,he=0;for(;Z<h;++Z,he+=_)A.push(S+he);return A},allocPtr:(h=1,_=!0)=>h===1?u.pstack.alloc(_?8:u.ptrSizeof):u.pstack.allocChunks(h,_?8:u.ptrSizeof),call:function(h){const _=u.pstack.pointer;try{return h(q)}finally{u.pstack.restore(_)}}}),Object.defineProperties(u.pstack,{pointer:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_ptr},quota:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_quota},remaining:{configurable:!1,iterable:!0,writeable:!1,get:u.exports.sqlite3__wasm_pstack_remaining}}),c.sqlite3_randomness=(...h)=>{if(h.length===1&&C.isTypedArray(h[0])&&h[0].BYTES_PER_ELEMENT===1){const _=h[0];if(_.byteLength===0)return u.exports.sqlite3_randomness(0,0),_;const S=u.pstack.pointer;try{let A=_.byteLength,Z=0;const he=u.exports.sqlite3_randomness,be=u.heap8u(),Ae=A<512?A:512,Ee=u.pstack.alloc(Ae);do{const ve=A>Ae?Ae:A;he(ve,Ee),_.set(D(be,Ee,Ee+ve),Z),A-=ve,Z+=ve}while(A>0)}catch(A){console.error("Highly unexpected (and ignored!) exception in sqlite3_randomness():",A)}finally{u.pstack.restore(S)}return _}u.exports.sqlite3_randomness(...h)};let ee;if(c.sqlite3_wasmfs_opfs_dir=function(){if(ee!==void 0)return ee;const h=l.wasmfsOpfsDir;if(!h||!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle)return ee="";try{return h&&u.xCallWrapped("sqlite3__wasm_init_wasmfs","i32",["string"],h)===0?ee=h:ee=""}catch{return ee=""}},c.sqlite3_wasmfs_filename_is_persistent=function(h){const _=c.sqlite3_wasmfs_opfs_dir();return _&&h?h.startsWith(_+"/"):!1},c.sqlite3_js_db_uses_vfs=function(h,_,S=0){try{const A=c.sqlite3_vfs_find(_);return A?h?A===c.sqlite3_js_db_vfs(h,S)?A:!1:A===c.sqlite3_vfs_find(0)?A:!1:!1}catch{return!1}},c.sqlite3_js_vfs_list=function(){const h=[];let _=c.sqlite3_vfs_find(0);for(;_;){const S=new c.sqlite3_vfs(_);h.push(u.cstrToJs(S.$zName)),_=S.$pNext,S.dispose()}return h},c.sqlite3_js_db_export=function(h,_=0){h=u.xWrap.testConvertArg("sqlite3*",h),h||z("Invalid sqlite3* argument."),u.bigIntEnabled||z("BigInt64 support is not enabled.");const S=u.scopedAllocPush();let A;try{const Z=u.scopedAlloc(8+u.ptrSizeof),he=Z+8,be=_?u.isPtr(_)?_:u.scopedAllocCString(""+_):0;let Ae=u.exports.sqlite3__wasm_db_serialize(h,be,he,Z,0);Ae&&z("Database serialization failed with code",q.capi.sqlite3_js_rc_str(Ae)),A=u.peekPtr(he);const Ee=u.peek(Z,"i64");return Ae=Ee?u.heap8u().slice(A,A+Number(Ee)):new Uint8Array,Ae}finally{A&&u.exports.sqlite3_free(A),u.scopedAllocPop(S)}},c.sqlite3_js_db_vfs=(h,_=0)=>C.sqlite3__wasm_db_vfs(h,_),c.sqlite3_js_aggregate_context=(h,_)=>c.sqlite3_aggregate_context(h,_)||(_?E.toss("Cannot allocate",_,"bytes for sqlite3_aggregate_context()"):0),c.sqlite3_js_posix_create_file=function(h,_,S){let A;_&&u.isPtr(_)?A=_:_ instanceof ArrayBuffer||_ instanceof Uint8Array?(A=u.allocFromTypedArray(_),(arguments.length<3||!C.isInt32(S)||S<0)&&(S=_.byteLength)):Q.toss("Invalid 2nd argument for sqlite3_js_posix_create_file().");try{(!C.isInt32(S)||S<0)&&Q.toss("Invalid 3rd argument for sqlite3_js_posix_create_file().");const Z=C.sqlite3__wasm_posix_create_file(h,A,S);Z&&Q.toss("Creation of file failed with sqlite3 result code",c.sqlite3_js_rc_str(Z))}finally{u.dealloc(A)}},c.sqlite3_js_vfs_create_file=function(h,_,S,A){l.warn("sqlite3_js_vfs_create_file() is deprecated and","should be avoided because it can lead to C-level crashes.","See its documentation for alternative options.");let Z;S?(u.isPtr(S)?Z=S:S instanceof ArrayBuffer&&(S=new Uint8Array(S)),S instanceof Uint8Array?(Z=u.allocFromTypedArray(S),(arguments.length<4||!C.isInt32(A)||A<0)&&(A=S.byteLength)):Q.toss("Invalid 3rd argument type for sqlite3_js_vfs_create_file().")):Z=0,(!C.isInt32(A)||A<0)&&(u.dealloc(Z),Q.toss("Invalid 4th argument for sqlite3_js_vfs_create_file()."));try{const he=C.sqlite3__wasm_vfs_create_file(h,_,Z,A);he&&Q.toss("Creation of file failed with sqlite3 result code",c.sqlite3_js_rc_str(he))}finally{u.dealloc(Z)}},c.sqlite3_js_sql_to_string=h=>{if(typeof h=="string")return h;const _=p(v);return _===v?void 0:_},C.isUIThread()){const h=function(_){const S=Object.create(null);return S.prefix="kvvfs-"+_,S.stores=[],(_==="session"||_==="")&&S.stores.push(globalThis.sessionStorage),(_==="local"||_==="")&&S.stores.push(globalThis.localStorage),S};c.sqlite3_js_kvvfs_clear=function(_=""){let S=0;const A=h(_);return A.stores.forEach(Z=>{const he=[];let be;for(be=0;be<Z.length;++be){const Ae=Z.key(be);Ae.startsWith(A.prefix)&&he.push(Ae)}he.forEach(Ae=>Z.removeItem(Ae)),S+=he.length}),S},c.sqlite3_js_kvvfs_size=function(_=""){let S=0;const A=h(_);return A.stores.forEach(Z=>{let he;for(he=0;he<Z.length;++he){const be=Z.key(he);be.startsWith(A.prefix)&&(S+=be.length,S+=Z.getItem(be).length)}}),S*2}}c.sqlite3_db_config=(function(h,_,...S){switch(_){case c.SQLITE_DBCONFIG_ENABLE_FKEY:case c.SQLITE_DBCONFIG_ENABLE_TRIGGER:case c.SQLITE_DBCONFIG_ENABLE_FTS3_TOKENIZER:case c.SQLITE_DBCONFIG_ENABLE_LOAD_EXTENSION:case c.SQLITE_DBCONFIG_NO_CKPT_ON_CLOSE:case c.SQLITE_DBCONFIG_ENABLE_QPSG:case c.SQLITE_DBCONFIG_TRIGGER_EQP:case c.SQLITE_DBCONFIG_RESET_DATABASE:case c.SQLITE_DBCONFIG_DEFENSIVE:case c.SQLITE_DBCONFIG_WRITABLE_SCHEMA:case c.SQLITE_DBCONFIG_LEGACY_ALTER_TABLE:case c.SQLITE_DBCONFIG_DQS_DML:case c.SQLITE_DBCONFIG_DQS_DDL:case c.SQLITE_DBCONFIG_ENABLE_VIEW:case c.SQLITE_DBCONFIG_LEGACY_FILE_FORMAT:case c.SQLITE_DBCONFIG_TRUSTED_SCHEMA:case c.SQLITE_DBCONFIG_STMT_SCANSTATUS:case c.SQLITE_DBCONFIG_REVERSE_SCANORDER:case c.SQLITE_DBCONFIG_ENABLE_ATTACH_CREATE:case c.SQLITE_DBCONFIG_ENABLE_ATTACH_WRITE:case c.SQLITE_DBCONFIG_ENABLE_COMMENTS:return this.ip||(this.ip=u.xWrap("sqlite3__wasm_db_config_ip","int",["sqlite3*","int","int","*"])),this.ip(h,_,S[0],S[1]||0);case c.SQLITE_DBCONFIG_LOOKASIDE:return this.pii||(this.pii=u.xWrap("sqlite3__wasm_db_config_pii","int",["sqlite3*","int","*","int","int"])),this.pii(h,_,S[0],S[1],S[2]);case c.SQLITE_DBCONFIG_MAINDBNAME:return this.s||(this.s=u.xWrap("sqlite3__wasm_db_config_s","int",["sqlite3*","int","string:static"])),this.s(h,_,S[0]);default:return c.SQLITE_MISUSE}}).bind(Object.create(null)),c.sqlite3_value_to_js=function(h,_=!0){let S;const A=c.sqlite3_value_type(h);switch(A){case c.SQLITE_INTEGER:u.bigIntEnabled?(S=c.sqlite3_value_int64(h),C.bigIntFitsDouble(S)&&(S=Number(S))):S=c.sqlite3_value_double(h);break;case c.SQLITE_FLOAT:S=c.sqlite3_value_double(h);break;case c.SQLITE_TEXT:S=c.sqlite3_value_text(h);break;case c.SQLITE_BLOB:{const Z=c.sqlite3_value_bytes(h),he=c.sqlite3_value_blob(h);Z&&!he&&q.WasmAllocError.toss("Cannot allocate memory for blob argument of",Z,"byte(s)"),S=Z?u.heap8u().slice(he,he+Number(Z)):null;break}case c.SQLITE_NULL:S=null;break;default:_&&z(c.SQLITE_MISMATCH,"Unhandled sqlite3_value_type():",A),S=void 0}return S},c.sqlite3_values_to_js=function(h,_,S=!0){let A;const Z=[];for(A=0;A<h;++A)Z.push(c.sqlite3_value_to_js(u.peekPtr(_+u.ptrSizeof*A),S));return Z},c.sqlite3_result_error_js=function(h,_){_ instanceof E?c.sqlite3_result_error_nomem(h):c.sqlite3_result_error(h,""+_,-1)},c.sqlite3_result_js=function(h,_){if(_ instanceof Error){c.sqlite3_result_error_js(h,_);return}try{switch(typeof _){case"undefined":break;case"boolean":c.sqlite3_result_int(h,_?1:0);break;case"bigint":C.bigIntFits32(_)?c.sqlite3_result_int(h,Number(_)):C.bigIntFitsDouble(_)?c.sqlite3_result_double(h,Number(_)):u.bigIntEnabled?C.bigIntFits64(_)?c.sqlite3_result_int64(h,_):z("BigInt value",_.toString(),"is too BigInt for int64."):z("BigInt value",_.toString(),"is too BigInt.");break;case"number":{let S;C.isInt32(_)?S=c.sqlite3_result_int:u.bigIntEnabled&&Number.isInteger(_)&&C.bigIntFits64(BigInt(_))?S=c.sqlite3_result_int64:S=c.sqlite3_result_double,S(h,_);break}case"string":{const[S,A]=u.allocCString(_,!0);c.sqlite3_result_text(h,S,A,c.SQLITE_WASM_DEALLOC);break}case"object":if(_===null){c.sqlite3_result_null(h);break}else if(C.isBindableTypedArray(_)){const S=u.allocFromTypedArray(_);c.sqlite3_result_blob(h,S,_.byteLength,c.SQLITE_WASM_DEALLOC);break}default:z("Don't not how to handle this UDF result value:",typeof _,_)}}catch(S){c.sqlite3_result_error_js(h,S)}},c.sqlite3_column_js=function(h,_,S=!0){const A=c.sqlite3_column_value(h,_);return A===0?void 0:c.sqlite3_value_to_js(A,S)};const y=(function(h,_,S){S=c[S],this.ptr?u.pokePtr(this.ptr,0):this.ptr=u.allocPtr();const A=S(h,_,this.ptr);if(A)return Q.toss(A,arguments[2]+"() failed with code "+A);const Z=u.peekPtr(this.ptr);return Z?c.sqlite3_value_to_js(Z,!0):void 0}).bind(Object.create(null));c.sqlite3_preupdate_new_js=(h,_)=>y(h,_,"sqlite3_preupdate_new"),c.sqlite3_preupdate_old_js=(h,_)=>y(h,_,"sqlite3_preupdate_old"),c.sqlite3changeset_new_js=(h,_)=>y(h,_,"sqlite3changeset_new"),c.sqlite3changeset_old_js=(h,_)=>y(h,_,"sqlite3changeset_old");const q={WasmAllocError:E,SQLite3Error:Q,capi:c,util:C,wasm:u,config:l,version:Object.create(null),client:void 0,asyncPostInit:async function h(){if(h.isReady instanceof Promise)return h.isReady;let _=n.initializersAsync;delete n.initializersAsync;const S=async()=>(q.__isUnderTest||(delete q.util,delete q.StructBinder),q),A=he=>{throw l.error("an async sqlite3 initializer failed:",he),he};if(!_||!_.length)return h.isReady=S().catch(A);_=_.map(he=>he instanceof Function?async be=>he(q):he),_.push(S);let Z=Promise.resolve(q);for(;_.length;)Z=Z.then(_.shift());return h.isReady=Z.catch(A)},scriptInfo:void 0};try{n.initializers.forEach(h=>{h(q)})}catch(h){throw console.error("sqlite3 bootstrap initializer threw:",h),h}return delete n.initializers,n.sqlite3=q,q},globalThis.sqlite3ApiBootstrap.initializers=[],globalThis.sqlite3ApiBootstrap.initializersAsync=[],globalThis.sqlite3ApiBootstrap.defaultConfig=Object.create(null),globalThis.sqlite3ApiBootstrap.sqlite3=void 0,globalThis.WhWasmUtilInstaller=function(n){n.bigIntEnabled===void 0&&(n.bigIntEnabled=!!globalThis.BigInt64Array);const a=(...p)=>{throw new Error(p.join(" "))};n.exports||Object.defineProperty(n,"exports",{enumerable:!0,configurable:!0,get:()=>n.instance&&n.instance.exports});const l=n.pointerIR||"i32",c=n.ptrSizeof=l==="i32"?4:l==="i64"?8:a("Unhandled ptrSizeof:",l),u=Object.create(null);u.heapSize=0,u.memory=null,u.freeFuncIndexes=[],u.scopedAlloc=[],u.utf8Decoder=new TextDecoder,u.utf8Encoder=new TextEncoder("utf-8"),n.sizeofIR=p=>{switch(p){case"i8":return 1;case"i16":return 2;case"i32":case"f32":case"float":return 4;case"i64":case"f64":case"double":return 8;case"*":return c;default:return(""+p).endsWith("*")?c:void 0}};const w=function(){if(!u.memory)u.memory=n.memory instanceof WebAssembly.Memory?n.memory:n.exports.memory;else if(u.heapSize===u.memory.buffer.byteLength)return u;const p=u.memory.buffer;return u.HEAP8=new Int8Array(p),u.HEAP8U=new Uint8Array(p),u.HEAP16=new Int16Array(p),u.HEAP16U=new Uint16Array(p),u.HEAP32=new Int32Array(p),u.HEAP32U=new Uint32Array(p),n.bigIntEnabled&&(u.HEAP64=new BigInt64Array(p),u.HEAP64U=new BigUint64Array(p)),u.HEAP32F=new Float32Array(p),u.HEAP64F=new Float64Array(p),u.heapSize=p.byteLength,u};n.heap8=()=>w().HEAP8,n.heap8u=()=>w().HEAP8U,n.heap16=()=>w().HEAP16,n.heap16u=()=>w().HEAP16U,n.heap32=()=>w().HEAP32,n.heap32u=()=>w().HEAP32U,n.heapForSize=function(p,E=!0){const C=u.memory&&u.heapSize===u.memory.buffer.byteLength?u:w();switch(p){case Int8Array:return C.HEAP8;case Uint8Array:return C.HEAP8U;case Int16Array:return C.HEAP16;case Uint16Array:return C.HEAP16U;case Int32Array:return C.HEAP32;case Uint32Array:return C.HEAP32U;case 8:return E?C.HEAP8U:C.HEAP8;case 16:return E?C.HEAP16U:C.HEAP16;case 32:return E?C.HEAP32U:C.HEAP32;case 64:if(C.HEAP64)return E?C.HEAP64U:C.HEAP64;break;default:if(n.bigIntEnabled){if(p===globalThis.BigUint64Array)return C.HEAP64U;if(p===globalThis.BigInt64Array)return C.HEAP64;break}}a("Invalid heapForSize() size: expecting 8, 16, 32,","or (if BigInt is enabled) 64.")},n.functionTable=function(){return n.exports.__indirect_function_table},n.functionEntry=function(p){const E=n.functionTable();return p<E.length?E.get(p):void 0},n.jsFuncToWasm=function p(E,C){if(p._||(p._={sigTypes:Object.assign(Object.create(null),{i:"i32",p:"i32",P:"i32",s:"i32",j:"i64",f:"f32",d:"f64"}),typeCodes:Object.assign(Object.create(null),{f64:124,f32:125,i64:126,i32:127}),uleb128Encode:function(q,h,_){_<128?q[h](_):q[h](_%128|128,_>>7)},rxJSig:/^(\w)\((\w*)\)$/,sigParams:function(q){const h=p._.rxJSig.exec(q);return h?h[2]:q.substr(1)},letterType:q=>p._.sigTypes[q]||a("Invalid signature letter:",q),pushSigType:(q,h)=>q.push(p._.typeCodes[p._.letterType(h)])}),typeof E=="string"){const q=C;C=E,E=q}const ee=p._.sigParams(C),y=[1,96];p._.uleb128Encode(y,"push",ee.length);for(const q of ee)p._.pushSigType(y,q);return C[0]==="v"?y.push(0):(y.push(1),p._.pushSigType(y,C[0])),p._.uleb128Encode(y,"unshift",y.length),y.unshift(0,97,115,109,1,0,0,0,1),y.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(y)),{e:{f:E}}).exports.f};const k=function(E,C,ee){if(ee&&!u.scopedAlloc.length&&a("No scopedAllocPush() scope is active."),typeof E=="string"){const _=C;C=E,E=_}(typeof C!="string"||!(E instanceof Function))&&a("Invalid arguments: expecting (function,signature) or (signature,function).");const y=n.functionTable(),q=y.length;let h;for(;u.freeFuncIndexes.length&&(h=u.freeFuncIndexes.pop(),y.get(h));){h=null;continue}h||(h=q,y.grow(1));try{return y.set(h,E),ee&&u.scopedAlloc[u.scopedAlloc.length-1].push(h),h}catch(_){if(!(_ instanceof TypeError))throw h===q&&u.freeFuncIndexes.push(q),_}try{const _=n.jsFuncToWasm(E,C);y.set(h,_),ee&&u.scopedAlloc[u.scopedAlloc.length-1].push(h)}catch(_){throw h===q&&u.freeFuncIndexes.push(q),_}return h};n.installFunction=(p,E)=>k(p,E,!1),n.scopedInstallFunction=(p,E)=>k(p,E,!0),n.uninstallFunction=function(p){if(!p&&p!==0)return;const E=u.freeFuncIndexes,C=n.functionTable();E.push(p);const ee=C.get(p);return C.set(p,null),ee},n.peek=function(E,C="i8"){C.endsWith("*")&&(C=l);const ee=u.memory&&u.heapSize===u.memory.buffer.byteLength?u:w(),y=Array.isArray(E)?[]:void 0;let q;do{switch(y&&(E=arguments[0].shift()),C){case"i1":case"i8":q=ee.HEAP8[E>>0];break;case"i16":q=ee.HEAP16[E>>1];break;case"i32":q=ee.HEAP32[E>>2];break;case"float":case"f32":q=ee.HEAP32F[E>>2];break;case"double":case"f64":q=Number(ee.HEAP64F[E>>3]);break;case"i64":if(n.bigIntEnabled){q=BigInt(ee.HEAP64[E>>3]);break}default:a("Invalid type for peek():",C)}y&&y.push(q)}while(y&&arguments[0].length);return y||q},n.poke=function(p,E,C="i8"){C.endsWith("*")&&(C=l);const ee=u.memory&&u.heapSize===u.memory.buffer.byteLength?u:w();for(const y of Array.isArray(p)?p:[p])switch(C){case"i1":case"i8":ee.HEAP8[y>>0]=E;continue;case"i16":ee.HEAP16[y>>1]=E;continue;case"i32":ee.HEAP32[y>>2]=E;continue;case"float":case"f32":ee.HEAP32F[y>>2]=E;continue;case"double":case"f64":ee.HEAP64F[y>>3]=E;continue;case"i64":if(ee.HEAP64){ee.HEAP64[y>>3]=BigInt(E);continue}default:a("Invalid type for poke(): "+C)}return this},n.peekPtr=(...p)=>n.peek(p.length===1?p[0]:p,l),n.pokePtr=(p,E=0)=>n.poke(p,E,l),n.peek8=(...p)=>n.peek(p.length===1?p[0]:p,"i8"),n.poke8=(p,E)=>n.poke(p,E,"i8"),n.peek16=(...p)=>n.peek(p.length===1?p[0]:p,"i16"),n.poke16=(p,E)=>n.poke(p,E,"i16"),n.peek32=(...p)=>n.peek(p.length===1?p[0]:p,"i32"),n.poke32=(p,E)=>n.poke(p,E,"i32"),n.peek64=(...p)=>n.peek(p.length===1?p[0]:p,"i64"),n.poke64=(p,E)=>n.poke(p,E,"i64"),n.peek32f=(...p)=>n.peek(p.length===1?p[0]:p,"f32"),n.poke32f=(p,E)=>n.poke(p,E,"f32"),n.peek64f=(...p)=>n.peek(p.length===1?p[0]:p,"f64"),n.poke64f=(p,E)=>n.poke(p,E,"f64"),n.getMemValue=n.peek,n.getPtrValue=n.peekPtr,n.setMemValue=n.poke,n.setPtrValue=n.pokePtr,n.isPtr32=p=>typeof p=="number"&&p===(p|0)&&p>=0,n.isPtr=n.isPtr32,n.cstrlen=function(p){if(!p||!n.isPtr(p))return null;const E=w().HEAP8U;let C=p;for(;E[C]!==0;++C);return C-p};const Q=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,z=function(p,E,C){return u.utf8Decoder.decode(p.buffer instanceof Q?p.slice(E,C):p.subarray(E,C))};n.cstrToJs=function(p){const E=n.cstrlen(p);return E?z(w().HEAP8U,p,p+E):E===null?E:""},n.jstrlen=function(p){if(typeof p!="string")return null;const E=p.length;let C=0;for(let ee=0;ee<E;++ee){let y=p.charCodeAt(ee);y>=55296&&y<=57343&&(y=65536+((y&1023)<<10)|p.charCodeAt(++ee)&1023),y<=127?++C:y<=2047?C+=2:y<=65535?C+=3:C+=4}return C},n.jstrcpy=function(p,E,C=0,ee=-1,y=!0){if((!E||!(E instanceof Int8Array)&&!(E instanceof Uint8Array))&&a("jstrcpy() target must be an Int8Array or Uint8Array."),ee<0&&(ee=E.length-C),!(ee>0)||!(C>=0))return 0;let q=0,h=p.length;const _=C,S=C+ee-(y?1:0);for(;q<h&&C<S;++q){let A=p.charCodeAt(q);if(A>=55296&&A<=57343&&(A=65536+((A&1023)<<10)|p.charCodeAt(++q)&1023),A<=127){if(C>=S)break;E[C++]=A}else if(A<=2047){if(C+1>=S)break;E[C++]=192|A>>6,E[C++]=128|A&63}else if(A<=65535){if(C+2>=S)break;E[C++]=224|A>>12,E[C++]=128|A>>6&63,E[C++]=128|A&63}else{if(C+3>=S)break;E[C++]=240|A>>18,E[C++]=128|A>>12&63,E[C++]=128|A>>6&63,E[C++]=128|A&63}}return y&&(E[C++]=0),C-_},n.cstrncpy=function(p,E,C){if((!p||!E)&&a("cstrncpy() does not accept NULL strings."),C<0)C=n.cstrlen(strPtr)+1;else if(!(C>0))return 0;const ee=n.heap8u();let y=0,q;for(;y<C&&(q=ee[E+y]);++y)ee[p+y]=q;return y<C&&(ee[p+y++]=0),y},n.jstrToUintArray=(p,E=!1)=>u.utf8Encoder.encode(E?p+"\0":p);const ie=(p,E)=>{(!(p.alloc instanceof Function)||!(p.dealloc instanceof Function))&&a("Object is missing alloc() and/or dealloc() function(s)","required by",E+"().")},oe=function(p,E,C,ee){if(ie(n,ee),typeof p!="string")return null;{const y=u.utf8Encoder.encode(p),q=C(y.length+1),h=w().HEAP8U;return h.set(y,q),h[q+y.length]=0,E?[q,y.length]:q}};n.allocCString=(p,E=!1)=>oe(p,E,n.alloc,"allocCString()"),n.scopedAllocPush=function(){ie(n,"scopedAllocPush");const p=[];return u.scopedAlloc.push(p),p},n.scopedAllocPop=function(p){ie(n,"scopedAllocPop");const E=arguments.length?u.scopedAlloc.indexOf(p):u.scopedAlloc.length-1;E<0&&a("Invalid state object for scopedAllocPop()."),arguments.length===0&&(p=u.scopedAlloc[E]),u.scopedAlloc.splice(E,1);for(let C;C=p.pop();)n.functionEntry(C)?n.uninstallFunction(C):n.dealloc(C)},n.scopedAlloc=function(p){u.scopedAlloc.length||a("No scopedAllocPush() scope is active.");const E=n.alloc(p);return u.scopedAlloc[u.scopedAlloc.length-1].push(E),E},Object.defineProperty(n.scopedAlloc,"level",{configurable:!1,enumerable:!1,get:()=>u.scopedAlloc.length,set:()=>a("The 'active' property is read-only.")}),n.scopedAllocCString=(p,E=!1)=>oe(p,E,n.scopedAlloc,"scopedAllocCString()");const U=function(p,E){const C=n[p?"scopedAlloc":"alloc"]((E.length+1)*n.ptrSizeof);let ee=0;return E.forEach(y=>{n.pokePtr(C+n.ptrSizeof*ee++,n[p?"scopedAllocCString":"allocCString"](""+y))}),n.pokePtr(C+n.ptrSizeof*ee,0),C};n.scopedAllocMainArgv=p=>U(!0,p),n.allocMainArgv=p=>U(!1,p),n.cArgvToJs=(p,E)=>{const C=[];for(let ee=0;ee<p;++ee){const y=n.peekPtr(E+n.ptrSizeof*ee);C.push(y?n.cstrToJs(y):null)}return C},n.scopedAllocCall=function(p){n.scopedAllocPush();try{return p()}finally{n.scopedAllocPop()}};const P=function(p,E,C){ie(n,C);const ee=E?"i64":l;let y=n[C](p*(E?8:c));if(n.poke(y,0,ee),p===1)return y;const q=[y];for(let h=1;h<p;++h)y+=E?8:c,q[h]=y,n.poke(y,0,ee);return q};n.allocPtr=(p=1,E=!0)=>P(p,E,"alloc"),n.scopedAllocPtr=(p=1,E=!0)=>P(p,E,"scopedAlloc"),n.xGet=function(p){return n.exports[p]||a("Cannot find exported symbol:",p)};const J=(p,E)=>a(p+"() requires",E,"argument(s).");n.xCall=function(p,...E){const C=p instanceof Function?p:n.xGet(p);return C instanceof Function||a("Exported symbol",p,"is not a function."),C.length!==E.length&&J(C===p?C.name:p,C.length),arguments.length===2&&Array.isArray(arguments[1])?C.apply(null,arguments[1]):C.apply(null,E)},u.xWrap=Object.create(null),u.xWrap.convert=Object.create(null),u.xWrap.convert.arg=new Map,u.xWrap.convert.result=new Map;const O=u.xWrap.convert.arg,I=u.xWrap.convert.result;n.bigIntEnabled&&O.set("i64",p=>BigInt(p));const D=l==="i32"?p=>p|0:p=>BigInt(p)|BigInt(0);O.set("i32",D).set("i16",p=>(p|0)&65535).set("i8",p=>(p|0)&255).set("f32",p=>Number(p).valueOf()).set("float",O.get("f32")).set("f64",O.get("f32")).set("double",O.get("f64")).set("int",O.get("i32")).set("null",p=>p).set(null,O.get("null")).set("**",D).set("*",D),I.set("*",D).set("pointer",D).set("number",p=>Number(p)).set("void",p=>{}).set("null",p=>p).set(null,I.get("null"));{const p=["i8","i16","i32","int","f32","float","f64","double"];n.bigIntEnabled&&p.push("i64");const E=O.get(l);for(const C of p)O.set(C+"*",E),I.set(C+"*",E),I.set(C,O.get(C)||a("Missing arg converter:",C))}const R=function(p){return typeof p=="string"?n.scopedAllocCString(p):p?D(p):null};O.set("string",R).set("utf8",R).set("pointer",R),I.set("string",p=>n.cstrToJs(p)).set("utf8",I.get("string")).set("string:dealloc",p=>{try{return p?n.cstrToJs(p):null}finally{n.dealloc(p)}}).set("utf8:dealloc",I.get("string:dealloc")).set("json",p=>JSON.parse(n.cstrToJs(p))).set("json:dealloc",p=>{try{return p?JSON.parse(n.cstrToJs(p)):null}finally{n.dealloc(p)}});const $=class{constructor(p){this.name=p.name||"unnamed adapter"}convertArg(p,E,C){a("AbstractArgAdapter must be subclassed.")}};O.FuncPtrAdapter=class Vi extends ${constructor(E){super(E),O.FuncPtrAdapter.warnOnUse&&console.warn("xArg.FuncPtrAdapter is an internal-only API","and is not intended to be invoked from","client-level code. Invoked with:",E),this.name=E.name||"unnamed",this.signature=E.signature,E.contextKey instanceof Function&&(this.contextKey=E.contextKey,E.bindScope||(E.bindScope="context")),this.bindScope=E.bindScope||a("FuncPtrAdapter options requires a bindScope (explicit or implied)."),Vi.bindScopes.indexOf(E.bindScope)<0&&a("Invalid options.bindScope ("+E.bindMod+") for FuncPtrAdapter. Expecting one of: ("+Vi.bindScopes.join(", ")+")"),this.isTransient=this.bindScope==="transient",this.isContext=this.bindScope==="context",this.isPermanent=this.bindScope==="permanent",this.singleton=this.bindScope==="singleton"?[]:void 0,this.callProxy=E.callProxy instanceof Function?E.callProxy:void 0}contextKey(E,C){return this}contextMap(E){const C=this.__cmap||(this.__cmap=new Map);let ee=C.get(E);return ee===void 0&&C.set(E,ee=[]),ee}convertArg(E,C,ee){let y=this.singleton;if(!y&&this.isContext&&(y=this.contextMap(this.contextKey(C,ee))),y&&y[0]===E)return y[1];if(E instanceof Function){this.callProxy&&(E=this.callProxy(E));const q=k(E,this.signature,this.isTransient);if(Vi.debugFuncInstall&&Vi.debugOut("FuncPtrAdapter installed",this,this.contextKey(C,ee),"@"+q,E),y){if(y[1]){Vi.debugFuncInstall&&Vi.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(C,ee),"@"+y[1],E);try{u.scopedAlloc[u.scopedAlloc.length-1].push(y[1])}catch{}}y[0]=E,y[1]=q}return q}else if(n.isPtr(E)||E===null||E===void 0){if(y&&y[1]&&y[1]!==E){Vi.debugFuncInstall&&Vi.debugOut("FuncPtrAdapter uninstalling",this,this.contextKey(C,ee),"@"+y[1],E);try{u.scopedAlloc[u.scopedAlloc.length-1].push(y[1])}catch{}y[0]=y[1]=E|0}return E||0}else throw new TypeError("Invalid FuncPtrAdapter argument type. Expecting a function pointer or a "+(this.name?this.name+" ":"")+"function matching signature "+this.signature+".")}},O.FuncPtrAdapter.warnOnUse=!1,O.FuncPtrAdapter.debugFuncInstall=!1,O.FuncPtrAdapter.debugOut=console.debug.bind(console),O.FuncPtrAdapter.bindScopes=["transient","context","singleton","permanent"];const F=p=>O.get(p)||a("Argument adapter not found:",p),K=p=>I.get(p)||a("Result adapter not found:",p);u.xWrap.convertArg=(p,...E)=>F(p)(...E),u.xWrap.convertArgNoCheck=(p,...E)=>O.get(p)(...E),u.xWrap.convertResult=(p,E)=>p===null?E:p?K(p)(E):void 0,u.xWrap.convertResultNoCheck=(p,E)=>p===null?E:p?I.get(p)(E):void 0,n.xWrap=function(p,E,...C){arguments.length===3&&Array.isArray(arguments[2])&&(C=arguments[2]),n.isPtr(p)&&(p=n.functionEntry(p)||a("Function pointer not found in WASM function table."));const ee=p instanceof Function,y=ee?p:n.xGet(p);if(ee&&(p=y.name||"unnamed function"),C.length!==y.length&&J(p,y.length),E===null&&y.length===0)return y;E!=null&&K(E);for(const h of C)h instanceof $?O.set(h,(..._)=>h.convertArg(..._)):F(h);const q=u.xWrap;return y.length===0?(...h)=>h.length?J(p,y.length):q.convertResult(E,y.call(null)):function(...h){h.length!==y.length&&J(p,y.length);const _=n.scopedAllocPush();try{let S=0;for(;S<h.length;++S)h[S]=q.convertArgNoCheck(C[S],h[S],h,S);return q.convertResultNoCheck(E,y.apply(null,h))}finally{n.scopedAllocPop(_)}}};const ne=function(p,E,C,ee,y,q){if(typeof C=="string"){if(E===1)return q.get(C);if(E===2){if(ee)ee instanceof Function||a(y,"requires a function argument.");else return q.delete(C),p;return q.set(C,ee),p}}a("Invalid arguments to",y)};return n.xWrap.resultAdapter=function p(E,C){return ne(p,arguments.length,E,C,"resultAdapter()",I)},n.xWrap.argAdapter=function p(E,C){return ne(p,arguments.length,E,C,"argAdapter()",O)},n.xWrap.FuncPtrAdapter=O.FuncPtrAdapter,n.xCallWrapped=function(p,E,C,...ee){return Array.isArray(arguments[3])&&(ee=arguments[3]),n.xWrap(p,E,C||[]).apply(null,ee||[])},n.xWrap.testConvertArg=u.xWrap.convertArg,n.xWrap.testConvertResult=u.xWrap.convertResult,n},globalThis.WhWasmUtilInstaller.yawl=(function(n){const a=()=>fetch(n.uri,{credentials:"same-origin"}),l=this,c=function(w){if(n.wasmUtilTarget){const k=(...z)=>{throw new Error(z.join(" "))},Q=n.wasmUtilTarget;if(Q.module=w.module,Q.instance=w.instance,Q.instance.exports.memory||(Q.memory=n.imports&&n.imports.env&&n.imports.env.memory||k("Missing 'memory' object!")),!Q.alloc&&w.instance.exports.malloc){const z=w.instance.exports;Q.alloc=function(ie){return z.malloc(ie)||k("Allocation of",ie,"bytes failed.")},Q.dealloc=function(ie){z.free(ie)}}l(Q)}return n.onload&&n.onload(w,n),w};return WebAssembly.instantiateStreaming?function(){return WebAssembly.instantiateStreaming(a(),n.imports||{}).then(c)}:function(){return a().then(k=>k.arrayBuffer()).then(k=>WebAssembly.instantiate(k,n.imports||{})).then(c)}}).bind(globalThis.WhWasmUtilInstaller),globalThis.Jaccwabyt=function n(a){const l=(...g)=>{throw new Error(g.join(" "))};!(a.heap instanceof WebAssembly.Memory)&&!(a.heap instanceof Function)&&l("config.heap must be WebAssembly.Memory instance or a function."),["alloc","dealloc"].forEach(function(g){a[g]instanceof Function||l("Config option '"+g+"' must be a function.")});const c=n,u=a.heap instanceof Function?a.heap:()=>new Uint8Array(a.heap.buffer),w=a.alloc,k=a.dealloc,Q=a.log||console.log.bind(console),z=a.memberPrefix||"",ie=a.memberSuffix||"",oe=a.bigIntEnabled===void 0?!!globalThis.BigInt64Array:!!a.bigIntEnabled,U=globalThis.BigInt,P=globalThis.BigInt64Array,J=a.ptrSizeof||4,O=a.ptrIR||"i32";c.debugFlags||(c.__makeDebugFlags=function(g=null){g&&g.__flags&&(g=g.__flags);const T=function W(H){return arguments.length===0?W.__flags:(H<0?(delete W.__flags.getter,delete W.__flags.setter,delete W.__flags.alloc,delete W.__flags.dealloc):(W.__flags.getter=(1&H)!==0,W.__flags.setter=(2&H)!==0,W.__flags.alloc=(4&H)!==0,W.__flags.dealloc=(8&H)!==0),W._flags)};return Object.defineProperty(T,"__flags",{iterable:!1,writable:!1,value:Object.create(g)}),g||T(0),T},c.debugFlags=c.__makeDebugFlags());const I=function(){const g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]===256}(),D=g=>g[1]==="(",R=g=>g==="P",$=g=>D(g)?"p":g[0],F=function(g){switch($(g)){case"c":case"C":return"i8";case"i":return"i32";case"p":case"P":case"s":return O;case"j":return"i64";case"f":return"float";case"d":return"double"}l("Unhandled signature IR:",g)},K=P?()=>!0:()=>l("BigInt64Array is not available."),ne=function(g){switch($(g)){case"p":case"P":case"s":{switch(J){case 4:return"getInt32";case 8:return K()&&"getBigInt64"}break}case"i":return"getInt32";case"c":return"getInt8";case"C":return"getUint8";case"j":return K()&&"getBigInt64";case"f":return"getFloat32";case"d":return"getFloat64"}l("Unhandled DataView getter for signature:",g)},p=function(g){switch($(g)){case"p":case"P":case"s":{switch(J){case 4:return"setInt32";case 8:return K()&&"setBigInt64"}break}case"i":return"setInt32";case"c":return"setInt8";case"C":return"setUint8";case"j":return K()&&"setBigInt64";case"f":return"setFloat32";case"d":return"setFloat64"}l("Unhandled DataView setter for signature:",g)},E=function(g){switch($(g)){case"i":case"f":case"c":case"C":case"d":return Number;case"j":return K()&&U;case"p":case"P":case"s":switch(J){case 4:return Number;case 8:return K()&&U}break}l("Unhandled DataView set wrapper for signature:",g)},C=(g,T)=>g+"::"+T,ee=function(g,T){return()=>l(C(g,T),"is read-only.")},y=new WeakMap,q="(pointer-is-external)",h=function(g,T,W){if(W||(W=y.get(T)),W){if(y.delete(T),Array.isArray(T.ondispose)){let H;for(;H=T.ondispose.shift();)try{H instanceof Function?H.call(T):H instanceof ce?H.dispose():typeof H=="number"&&k(H)}catch(ue){console.warn("ondispose() for",g.structName,"@",W,"threw. NOT propagating it.",ue)}}else if(T.ondispose instanceof Function)try{T.ondispose()}catch(H){console.warn("ondispose() for",g.structName,"@",W,"threw. NOT propagating it.",H)}delete T.ondispose,g.debugFlags.__flags.dealloc&&Q("debug.dealloc:",T[q]?"EXTERNAL":"",g.structName,"instance:",g.structInfo.sizeof,"bytes @"+W),T[q]||k(W)}},_=g=>({configurable:!1,writable:!1,iterable:!1,value:g}),S=function(g,T,W){let H=!W;W?Object.defineProperty(T,q,_(W)):(W=w(g.structInfo.sizeof),W||l("Allocation of",g.structName,"structure failed."));try{g.debugFlags.__flags.alloc&&Q("debug.alloc:",H?"":"EXTERNAL",g.structName,"instance:",g.structInfo.sizeof,"bytes @"+W),H&&u().fill(0,W,W+g.structInfo.sizeof),y.set(T,W)}catch(ue){throw h(g,T,W),ue}},A=function(){const g=this.pointer;return g?new Uint8Array(u().slice(g,g+this.structInfo.sizeof)):null},he=_(g=>z+g+ie),be=function(g,T,W=!0){let H=g.members[T];if(!H&&(z||ie)){for(const ue of Object.values(g.members))if(ue.key===T){H=ue;break}!H&&W&&l(C(g.name,T),"is not a mapped struct member.")}return H},Ae=function g(T,W,H=!1){g._||(g._=ge=>ge.replace(/[^vipPsjrdcC]/g,"").replace(/[pPscC]/g,"i"));const ue=be(T.structInfo,W,!0);return H?g._(ue.signature):ue.signature},Ee={configurable:!1,enumerable:!1,get:function(){return y.get(this)},set:()=>l("Cannot assign the 'pointer' property of a struct.")},ve=_(function(){const g=[];for(const T of Object.keys(this.structInfo.members))g.push(this.memberKey(T));return g}),Ie=new TextDecoder("utf-8"),Le=new TextEncoder,Qe=typeof SharedArrayBuffer>"u"?function(){}:SharedArrayBuffer,je=function(g,T,W){return Ie.decode(g.buffer instanceof Qe?g.slice(T,W):g.subarray(T,W))},St=function(g,T,W=!1){const H=be(g.structInfo,T,W);return H&&H.signature.length===1&&H.signature[0]==="s"?H:!1},nt=function(g){g.signature!=="s"&&l("Invalid member type signature for C-string value:",JSON.stringify(g))},B=function(T,W){const H=be(T.structInfo,W,!0);nt(H);const ue=T[H.key];if(!ue)return null;let ge=ue;const Te=u();for(;Te[ge]!==0;++ge);return ue===ge?"":je(Te,ue,ge)},Y=function(g,...T){g.ondispose?Array.isArray(g.ondispose)||(g.ondispose=[g.ondispose]):g.ondispose=[],g.ondispose.push(...T)},te=function(g){const T=Le.encode(g),W=w(T.length+1);W||l("Allocation error while duplicating string:",g);const H=u();return H.set(T,W),H[W+T.length]=0,W},de=function(g,T,W){const H=be(g.structInfo,T,!0);nt(H);const ue=te(W);return g[H.key]=ue,Y(g,ue),g},ce=function(T,W){arguments[2]!==_&&l("Do not call the StructType constructor","from client-level code."),Object.defineProperties(this,{structName:_(T),structInfo:_(W)})};ce.prototype=Object.create(null,{dispose:_(function(){h(this.constructor,this)}),lookupMember:_(function(g,T=!0){return be(this.structInfo,g,T)}),memberToJsString:_(function(g){return B(this,g)}),memberIsString:_(function(g,T=!0){return St(this,g,T)}),memberKey:he,memberKeys:ve,memberSignature:_(function(g,T=!1){return Ae(this,g,T)}),memoryDump:_(A),pointer:Ee,setMemberCString:_(function(g,T){return de(this,g,T)})}),Object.assign(ce.prototype,{addOnDispose:function(...g){return Y(this,...g),this}}),Object.defineProperties(ce,{allocCString:_(te),isA:_(g=>g instanceof ce),hasExternalPointer:_(g=>g instanceof ce&&!!g[q]),memberKey:he});const pe=g=>Number.isFinite(g)||g instanceof(U||Number),X=function g(T,W,H){if(!g._){g._={getters:{},setters:{},sw:{}};const Pt=["i","c","C","p","P","s","f","d","v()"];oe&&Pt.push("j"),Pt.forEach(function(vi){g._.getters[vi]=ne(vi),g._.setters[vi]=p(vi),g._.sw[vi]=E(vi)});const sh=/^[ipPsjfdcC]$/,oh=/^[vipPsjfdcC]\([ipPsjfdcC]*\)$/;g.sigCheck=function(vi,ah,ac,ka){Object.prototype.hasOwnProperty.call(vi,ac)&&l(vi.structName,"already has a property named",ac+"."),sh.test(ka)||oh.test(ka)||l("Malformed signature for",C(vi.structName,ah)+":",ka)}}const ue=T.memberKey(W);g.sigCheck(T.prototype,W,ue,H.signature),H.key=ue,H.name=W;const ge=$(H.signature),Te=C(T.prototype.structName,ue),De=T.prototype.debugFlags.__flags,Ht=Object.create(null);Ht.configurable=!1,Ht.enumerable=!1,Ht.get=function(){De.getter&&Q("debug.getter:",g._.getters[ge],"for",F(ge),Te,"@",this.pointer,"+",H.offset,"sz",H.sizeof);let Pt=new DataView(u().buffer,this.pointer+H.offset,H.sizeof)[g._.getters[ge]](0,I);return De.getter&&Q("debug.getter:",Te,"result =",Pt),Pt},H.readOnly?Ht.set=ee(T.prototype.structName,ue):Ht.set=function(Pt){if(De.setter&&Q("debug.setter:",g._.setters[ge],"for",F(ge),Te,"@",this.pointer,"+",H.offset,"sz",H.sizeof,Pt),this.pointer||l("Cannot set struct property on disposed instance."),Pt===null)Pt=0;else for(;!pe(Pt);){if(R(H.signature)&&Pt instanceof ce){Pt=Pt.pointer||0,De.setter&&Q("debug.setter:",Te,"resolved to",Pt);break}l("Invalid value for pointer-type",Te+".")}new DataView(u().buffer,this.pointer+H.offset,H.sizeof)[g._.setters[ge]](0,g._.sw[ge](Pt),I)},Object.defineProperty(T.prototype,ue,Ht)},b=function g(T,W){arguments.length===1?(W=T,T=W.name):W.name||(W.name=T),T||l("Struct name is required.");let H=!1;Object.keys(W.members).forEach(Te=>{const De=W.members[Te];De.sizeof?De.sizeof===1?De.signature==="c"||De.signature==="C"||l("Unexpected sizeof==1 member",C(W.name,Te),"with signature",De.signature):(De.sizeof%4!==0&&(console.warn("Invalid struct member description =",De,"from",W),l(T,"member",Te,"sizeof is not aligned. sizeof="+De.sizeof)),De.offset%4!==0&&(console.warn("Invalid struct member description =",De,"from",W),l(T,"member",Te,"offset is not aligned. offset="+De.offset))):l(T,"member",Te,"is missing sizeof."),(!H||H.offset<De.offset)&&(H=De)}),H?W.sizeof<H.offset+H.sizeof&&l("Invalid struct config:",T,"max member offset ("+H.offset+") ","extends past end of struct (sizeof="+W.sizeof+")."):l("No member property descriptions found.");const ue=_(c.__makeDebugFlags(g.debugFlags)),ge=function Te(De){this instanceof Te?arguments.length?((De!==(De|0)||De<=0)&&l("Invalid pointer value for",T,"constructor."),S(Te,this,De)):S(Te,this):l("The",T,"constructor may only be called via 'new'.")};return Object.defineProperties(ge,{debugFlags:ue,isA:_(Te=>Te instanceof ge),memberKey:he,memberKeys:ve,methodInfoForKey:_(function(Te){}),structInfo:_(W),structName:_(T)}),ge.prototype=new ce(T,W,_),Object.defineProperties(ge.prototype,{debugFlags:ue,constructor:_(ge)}),Object.keys(W.members).forEach(Te=>X(ge,Te,W.members[Te])),ge};return b.StructType=ce,b.config=a,b.allocCString=te,b.debugFlags||(b.debugFlags=c.__makeDebugFlags(c.debugFlags)),b},globalThis.sqlite3ApiBootstrap.initializers.push(function(n){const a=(...O)=>{throw new Error(O.join(" "))};n.SQLite3Error.toss;const l=n.capi,c=n.wasm,u=n.util;if(globalThis.WhWasmUtilInstaller(c),delete globalThis.WhWasmUtilInstaller,c.bindingSignatures=[["sqlite3_aggregate_context","void*","sqlite3_context*","int"],["sqlite3_bind_double","int","sqlite3_stmt*","int","f64"],["sqlite3_bind_int","int","sqlite3_stmt*","int","int"],["sqlite3_bind_null",void 0,"sqlite3_stmt*","int"],["sqlite3_bind_parameter_count","int","sqlite3_stmt*"],["sqlite3_bind_parameter_index","int","sqlite3_stmt*","string"],["sqlite3_bind_parameter_name","string","sqlite3_stmt*","int"],["sqlite3_bind_pointer","int","sqlite3_stmt*","int","*","string:static","*"],["sqlite3_busy_handler","int",["sqlite3*",new c.xWrap.FuncPtrAdapter({signature:"i(pi)",contextKey:(O,I)=>O[0]}),"*"]],["sqlite3_busy_timeout","int","sqlite3*","int"],["sqlite3_changes","int","sqlite3*"],["sqlite3_clear_bindings","int","sqlite3_stmt*"],["sqlite3_collation_needed","int","sqlite3*","*","*"],["sqlite3_column_blob","*","sqlite3_stmt*","int"],["sqlite3_column_bytes","int","sqlite3_stmt*","int"],["sqlite3_column_count","int","sqlite3_stmt*"],["sqlite3_column_decltype","string","sqlite3_stmt*","int"],["sqlite3_column_double","f64","sqlite3_stmt*","int"],["sqlite3_column_int","int","sqlite3_stmt*","int"],["sqlite3_column_name","string","sqlite3_stmt*","int"],["sqlite3_column_text","string","sqlite3_stmt*","int"],["sqlite3_column_type","int","sqlite3_stmt*","int"],["sqlite3_column_value","sqlite3_value*","sqlite3_stmt*","int"],["sqlite3_commit_hook","void*",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"sqlite3_commit_hook",signature:"i(p)",contextKey:O=>O[0]}),"*"]],["sqlite3_compileoption_get","string","int"],["sqlite3_compileoption_used","int","string"],["sqlite3_complete","int","string:flexible"],["sqlite3_context_db_handle","sqlite3*","sqlite3_context*"],["sqlite3_data_count","int","sqlite3_stmt*"],["sqlite3_db_filename","string","sqlite3*","string"],["sqlite3_db_handle","sqlite3*","sqlite3_stmt*"],["sqlite3_db_name","string","sqlite3*","int"],["sqlite3_db_readonly","int","sqlite3*","string"],["sqlite3_db_status","int","sqlite3*","int","*","*","int"],["sqlite3_errcode","int","sqlite3*"],["sqlite3_errmsg","string","sqlite3*"],["sqlite3_error_offset","int","sqlite3*"],["sqlite3_errstr","string","int"],["sqlite3_exec","int",["sqlite3*","string:flexible",new c.xWrap.FuncPtrAdapter({signature:"i(pipp)",bindScope:"transient",callProxy:O=>{let I;return(D,R,$,F)=>{try{const K=c.cArgvToJs(R,$);return I||(I=c.cArgvToJs(R,F)),O(K,I)|0}catch(K){return K.resultCode||l.SQLITE_ERROR}}}}),"*","**"]],["sqlite3_expanded_sql","string","sqlite3_stmt*"],["sqlite3_extended_errcode","int","sqlite3*"],["sqlite3_extended_result_codes","int","sqlite3*","int"],["sqlite3_file_control","int","sqlite3*","string","int","*"],["sqlite3_finalize","int","sqlite3_stmt*"],["sqlite3_free",void 0,"*"],["sqlite3_get_autocommit","int","sqlite3*"],["sqlite3_get_auxdata","*","sqlite3_context*","int"],["sqlite3_initialize",void 0],["sqlite3_interrupt",void 0,"sqlite3*"],["sqlite3_is_interrupted","int","sqlite3*"],["sqlite3_keyword_count","int"],["sqlite3_keyword_name","int",["int","**","*"]],["sqlite3_keyword_check","int",["string","int"]],["sqlite3_libversion","string"],["sqlite3_libversion_number","int"],["sqlite3_limit","int",["sqlite3*","int","int"]],["sqlite3_malloc","*","int"],["sqlite3_open","int","string","*"],["sqlite3_open_v2","int","string","*","int","string"],["sqlite3_realloc","*","*","int"],["sqlite3_reset","int","sqlite3_stmt*"],["sqlite3_result_blob",void 0,"sqlite3_context*","*","int","*"],["sqlite3_result_double",void 0,"sqlite3_context*","f64"],["sqlite3_result_error",void 0,"sqlite3_context*","string","int"],["sqlite3_result_error_code",void 0,"sqlite3_context*","int"],["sqlite3_result_error_nomem",void 0,"sqlite3_context*"],["sqlite3_result_error_toobig",void 0,"sqlite3_context*"],["sqlite3_result_int",void 0,"sqlite3_context*","int"],["sqlite3_result_null",void 0,"sqlite3_context*"],["sqlite3_result_pointer",void 0,"sqlite3_context*","*","string:static","*"],["sqlite3_result_subtype",void 0,"sqlite3_value*","int"],["sqlite3_result_text",void 0,"sqlite3_context*","string","int","*"],["sqlite3_result_zeroblob",void 0,"sqlite3_context*","int"],["sqlite3_rollback_hook","void*",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"sqlite3_rollback_hook",signature:"v(p)",contextKey:O=>O[0]}),"*"]],["sqlite3_set_auxdata",void 0,["sqlite3_context*","int","*","*"]],["sqlite3_shutdown",void 0],["sqlite3_sourceid","string"],["sqlite3_sql","string","sqlite3_stmt*"],["sqlite3_status","int","int","*","*","int"],["sqlite3_step","int","sqlite3_stmt*"],["sqlite3_stmt_busy","int","sqlite3_stmt*"],["sqlite3_stmt_readonly","int","sqlite3_stmt*"],["sqlite3_stmt_status","int","sqlite3_stmt*","int","int"],["sqlite3_strglob","int","string","string"],["sqlite3_stricmp","int","string","string"],["sqlite3_strlike","int","string","string","int"],["sqlite3_strnicmp","int","string","string","int"],["sqlite3_table_column_metadata","int","sqlite3*","string","string","string","**","**","*","*","*"],["sqlite3_total_changes","int","sqlite3*"],["sqlite3_trace_v2","int",["sqlite3*","int",new c.xWrap.FuncPtrAdapter({name:"sqlite3_trace_v2::callback",signature:"i(ippp)",contextKey:(O,I)=>O[0]}),"*"]],["sqlite3_txn_state","int",["sqlite3*","string"]],["sqlite3_uri_boolean","int","sqlite3_filename","string","int"],["sqlite3_uri_key","string","sqlite3_filename","int"],["sqlite3_uri_parameter","string","sqlite3_filename","string"],["sqlite3_user_data","void*","sqlite3_context*"],["sqlite3_value_blob","*","sqlite3_value*"],["sqlite3_value_bytes","int","sqlite3_value*"],["sqlite3_value_double","f64","sqlite3_value*"],["sqlite3_value_dup","sqlite3_value*","sqlite3_value*"],["sqlite3_value_free",void 0,"sqlite3_value*"],["sqlite3_value_frombind","int","sqlite3_value*"],["sqlite3_value_int","int","sqlite3_value*"],["sqlite3_value_nochange","int","sqlite3_value*"],["sqlite3_value_numeric_type","int","sqlite3_value*"],["sqlite3_value_pointer","*","sqlite3_value*","string:static"],["sqlite3_value_subtype","int","sqlite3_value*"],["sqlite3_value_text","string","sqlite3_value*"],["sqlite3_value_type","int","sqlite3_value*"],["sqlite3_vfs_find","*","string"],["sqlite3_vfs_register","int","sqlite3_vfs*","int"],["sqlite3_vfs_unregister","int","sqlite3_vfs*"]],c.exports.sqlite3_progress_handler&&c.bindingSignatures.push(["sqlite3_progress_handler",void 0,["sqlite3*","int",new c.xWrap.FuncPtrAdapter({name:"xProgressHandler",signature:"i(p)",bindScope:"context",contextKey:(O,I)=>O[0]}),"*"]]),c.exports.sqlite3_stmt_explain&&c.bindingSignatures.push(["sqlite3_stmt_explain","int","sqlite3_stmt*","int"],["sqlite3_stmt_isexplain","int","sqlite3_stmt*"]),c.exports.sqlite3_set_authorizer&&c.bindingSignatures.push(["sqlite3_set_authorizer","int",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"sqlite3_set_authorizer::xAuth",signature:"i(pissss)",contextKey:(O,I)=>O[0],callProxy:O=>(I,D,R,$,F,K)=>{try{return R=R&&c.cstrToJs(R),$=$&&c.cstrToJs($),F=F&&c.cstrToJs(F),K=K&&c.cstrToJs(K),O(I,D,R,$,F,K)||0}catch(ne){return ne.resultCode||l.SQLITE_ERROR}}}),"*"]]),c.bindingSignatures.int64=[["sqlite3_bind_int64","int",["sqlite3_stmt*","int","i64"]],["sqlite3_changes64","i64",["sqlite3*"]],["sqlite3_column_int64","i64",["sqlite3_stmt*","int"]],["sqlite3_deserialize","int","sqlite3*","string","*","i64","i64","int"],["sqlite3_last_insert_rowid","i64",["sqlite3*"]],["sqlite3_malloc64","*","i64"],["sqlite3_msize","i64","*"],["sqlite3_overload_function","int",["sqlite3*","string","int"]],["sqlite3_realloc64","*","*","i64"],["sqlite3_result_int64",void 0,"*","i64"],["sqlite3_result_zeroblob64","int","*","i64"],["sqlite3_serialize","*","sqlite3*","string","*","int"],["sqlite3_set_last_insert_rowid",void 0,["sqlite3*","i64"]],["sqlite3_status64","int","int","*","*","int"],["sqlite3_total_changes64","i64",["sqlite3*"]],["sqlite3_update_hook","*",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"sqlite3_update_hook",signature:"v(iippj)",contextKey:O=>O[0],callProxy:O=>(I,D,R,$,F)=>{O(I,D,c.cstrToJs(R),c.cstrToJs($),F)}}),"*"]],["sqlite3_uri_int64","i64",["sqlite3_filename","string","i64"]],["sqlite3_value_int64","i64","sqlite3_value*"]],c.bigIntEnabled&&c.exports.sqlite3_declare_vtab&&c.bindingSignatures.int64.push(["sqlite3_create_module","int",["sqlite3*","string","sqlite3_module*","*"]],["sqlite3_create_module_v2","int",["sqlite3*","string","sqlite3_module*","*","*"]],["sqlite3_declare_vtab","int",["sqlite3*","string:flexible"]],["sqlite3_drop_modules","int",["sqlite3*","**"]],["sqlite3_vtab_collation","string","sqlite3_index_info*","int"],["sqlite3_vtab_distinct","int","sqlite3_index_info*"],["sqlite3_vtab_in","int","sqlite3_index_info*","int","int"],["sqlite3_vtab_in_first","int","sqlite3_value*","**"],["sqlite3_vtab_in_next","int","sqlite3_value*","**"],["sqlite3_vtab_nochange","int","sqlite3_context*"],["sqlite3_vtab_on_conflict","int","sqlite3*"],["sqlite3_vtab_rhs_value","int","sqlite3_index_info*","int","**"]),c.bigIntEnabled&&c.exports.sqlite3_preupdate_hook&&c.bindingSignatures.int64.push(["sqlite3_preupdate_blobwrite","int","sqlite3*"],["sqlite3_preupdate_count","int","sqlite3*"],["sqlite3_preupdate_depth","int","sqlite3*"],["sqlite3_preupdate_hook","*",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"sqlite3_preupdate_hook",signature:"v(ppippjj)",contextKey:O=>O[0],callProxy:O=>(I,D,R,$,F,K,ne)=>{O(I,D,R,c.cstrToJs($),c.cstrToJs(F),K,ne)}}),"*"]],["sqlite3_preupdate_new","int",["sqlite3*","int","**"]],["sqlite3_preupdate_old","int",["sqlite3*","int","**"]]),c.bigIntEnabled&&c.exports.sqlite3changegroup_add&&c.exports.sqlite3session_create&&c.exports.sqlite3_preupdate_hook){const O={signature:"i(ps)",callProxy:I=>(D,R)=>{try{return I(D,c.cstrToJs(R))|0}catch($){return $.resultCode||l.SQLITE_ERROR}}};c.bindingSignatures.int64.push(["sqlite3changegroup_add","int",["sqlite3_changegroup*","int","void*"]],["sqlite3changegroup_add_strm","int",["sqlite3_changegroup*",new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changegroup_delete",void 0,["sqlite3_changegroup*"]],["sqlite3changegroup_new","int",["**"]],["sqlite3changegroup_output","int",["sqlite3_changegroup*","int*","**"]],["sqlite3changegroup_output_strm","int",["sqlite3_changegroup*",new c.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply","int",["sqlite3*","int","void*",new c.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...O}),new c.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_strm","int",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new c.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...O}),new c.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*"]],["sqlite3changeset_apply_v2","int",["sqlite3*","int","void*",new c.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...O}),new c.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_apply_v2_strm","int",["sqlite3*",new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new c.xWrap.FuncPtrAdapter({name:"xFilter",bindScope:"transient",...O}),new c.xWrap.FuncPtrAdapter({name:"xConflict",signature:"i(pip)",bindScope:"transient"}),"void*","**","int*","int"]],["sqlite3changeset_concat","int",["int","void*","int","void*","int*","**"]],["sqlite3changeset_concat_strm","int",[new c.xWrap.FuncPtrAdapter({name:"xInputA",signature:"i(ppp)",bindScope:"transient"}),"void*",new c.xWrap.FuncPtrAdapter({name:"xInputB",signature:"i(ppp)",bindScope:"transient"}),"void*",new c.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_conflict","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_finalize","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_fk_conflicts","int",["sqlite3_changeset_iter*","int*"]],["sqlite3changeset_invert","int",["int","void*","int*","**"]],["sqlite3changeset_invert_strm","int",[new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*",new c.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppi)",bindScope:"transient"}),"void*"]],["sqlite3changeset_new","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_next","int",["sqlite3_changeset_iter*"]],["sqlite3changeset_old","int",["sqlite3_changeset_iter*","int","**"]],["sqlite3changeset_op","int",["sqlite3_changeset_iter*","**","int*","int*","int*"]],["sqlite3changeset_pk","int",["sqlite3_changeset_iter*","**","int*"]],["sqlite3changeset_start","int",["**","int","*"]],["sqlite3changeset_start_strm","int",["**",new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3changeset_start_v2","int",["**","int","*","int"]],["sqlite3changeset_start_v2_strm","int",["**",new c.xWrap.FuncPtrAdapter({name:"xInput",signature:"i(ppp)",bindScope:"transient"}),"void*","int"]],["sqlite3session_attach","int",["sqlite3_session*","string"]],["sqlite3session_changeset","int",["sqlite3_session*","int*","**"]],["sqlite3session_changeset_size","i64",["sqlite3_session*"]],["sqlite3session_changeset_strm","int",["sqlite3_session*",new c.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_config","int",["int","void*"]],["sqlite3session_create","int",["sqlite3*","string","**"]],["sqlite3session_diff","int",["sqlite3_session*","string","string","**"]],["sqlite3session_enable","int",["sqlite3_session*","int"]],["sqlite3session_indirect","int",["sqlite3_session*","int"]],["sqlite3session_isempty","int",["sqlite3_session*"]],["sqlite3session_memory_used","i64",["sqlite3_session*"]],["sqlite3session_object_config","int",["sqlite3_session*","int","void*"]],["sqlite3session_patchset","int",["sqlite3_session*","*","**"]],["sqlite3session_patchset_strm","int",["sqlite3_session*",new c.xWrap.FuncPtrAdapter({name:"xOutput",signature:"i(ppp)",bindScope:"transient"}),"void*"]],["sqlite3session_table_filter",void 0,["sqlite3_session*",new c.xWrap.FuncPtrAdapter({name:"xFilter",...O,contextKey:(I,D)=>I[0]}),"*"]])}c.bindingSignatures.wasmInternal=[["sqlite3__wasm_db_reset","int","sqlite3*"],["sqlite3__wasm_db_vfs","sqlite3_vfs*","sqlite3*","string"],["sqlite3__wasm_vfs_create_file","int","sqlite3_vfs*","string","*","int"],["sqlite3__wasm_posix_create_file","int","string","*","int"],["sqlite3__wasm_vfs_unlink","int","sqlite3_vfs*","string"],["sqlite3__wasm_qfmt_token","string:dealloc","string","int"]],n.StructBinder=globalThis.Jaccwabyt({heap:c.heap8u,alloc:c.alloc,dealloc:c.dealloc,bigIntEnabled:c.bigIntEnabled,memberPrefix:"$"}),delete globalThis.Jaccwabyt;{const O=c.xWrap.argAdapter("string");c.xWrap.argAdapter("string:flexible",F=>O(u.flexibleString(F))),c.xWrap.argAdapter("string:static",(function(F){return c.isPtr(F)?F:(F=""+F,this[F]||(this[F]=c.allocCString(F)))}).bind(Object.create(null)));const I=c.xWrap.argAdapter("*"),D=function(){};c.xWrap.argAdapter("sqlite3_filename",I)("sqlite3_context*",I)("sqlite3_value*",I)("void*",I)("sqlite3_changegroup*",I)("sqlite3_changeset_iter*",I)("sqlite3_session*",I)("sqlite3_stmt*",F=>{var K;return I(F instanceof(((K=n==null?void 0:n.oo1)==null?void 0:K.Stmt)||D)?F.pointer:F)})("sqlite3*",F=>{var K;return I(F instanceof(((K=n==null?void 0:n.oo1)==null?void 0:K.DB)||D)?F.pointer:F)})("sqlite3_vfs*",F=>typeof F=="string"?l.sqlite3_vfs_find(F)||n.SQLite3Error.toss(l.SQLITE_NOTFOUND,"Unknown sqlite3_vfs name:",F):I(F instanceof(l.sqlite3_vfs||D)?F.pointer:F)),c.exports.sqlite3_declare_vtab&&c.xWrap.argAdapter("sqlite3_index_info*",F=>I(F instanceof(l.sqlite3_index_info||D)?F.pointer:F))("sqlite3_module*",F=>I(F instanceof(l.sqlite3_module||D)?F.pointer:F));const R=c.xWrap.resultAdapter("*");c.xWrap.resultAdapter("sqlite3*",R)("sqlite3_context*",R)("sqlite3_stmt*",R)("sqlite3_value*",R)("sqlite3_vfs*",R)("void*",R),c.exports.sqlite3_step.length===0&&(c.xWrap.doArgcCheck=!1,n.config.warn("Disabling sqlite3.wasm.xWrap.doArgcCheck due to environmental quirks."));for(const F of c.bindingSignatures)l[F[0]]=c.xWrap.apply(null,F);for(const F of c.bindingSignatures.wasmInternal)u[F[0]]=c.xWrap.apply(null,F);const $=function(F){return()=>a(F+"() is unavailable due to lack","of BigInt support in this build.")};for(const F of c.bindingSignatures.int64)l[F[0]]=c.bigIntEnabled?c.xWrap.apply(null,F):$(F[0]);if(delete c.bindingSignatures,c.exports.sqlite3__wasm_db_error){const F=c.xWrap("sqlite3__wasm_db_error","int","sqlite3*","int","string");u.sqlite3__wasm_db_error=function(K,ne,p){return ne instanceof n.WasmAllocError?(ne=l.SQLITE_NOMEM,p=0):ne instanceof Error&&(p=p||""+ne,ne=ne.resultCode||l.SQLITE_ERROR),K?F(K,ne,p):ne}}else u.sqlite3__wasm_db_error=function(F,K,ne){return console.warn("sqlite3__wasm_db_error() is not exported.",arguments),K}}{const O=c.xCall("sqlite3__wasm_enum_json");O||a("Maintenance required: increase sqlite3__wasm_enum_json()'s","static buffer size!"),c.ctype=JSON.parse(c.cstrToJs(O));const I=["access","authorizer","blobFinalizers","changeset","config","dataTypes","dbConfig","dbStatus","encodings","fcntl","flock","ioCap","limits","openFlags","prepareFlags","resultCodes","sqlite3Status","stmtStatus","syncFlags","trace","txnState","udfFlags","version"];c.bigIntEnabled&&I.push("serialize","session","vtab");for(const $ of I)for(const F of Object.entries(c.ctype[$]))l[F[0]]=F[1];c.functionEntry(l.SQLITE_WASM_DEALLOC)||a("Internal error: cannot resolve exported function","entry SQLITE_WASM_DEALLOC (=="+l.SQLITE_WASM_DEALLOC+").");const D=Object.create(null);for(const $ of["resultCodes"])for(const F of Object.entries(c.ctype[$]))D[F[1]]=F[0];l.sqlite3_js_rc_str=$=>D[$];const R=Object.assign(Object.create(null),{WasmTestStruct:!0,sqlite3_kvvfs_methods:!u.isUIThread(),sqlite3_index_info:!c.bigIntEnabled,sqlite3_index_constraint:!c.bigIntEnabled,sqlite3_index_orderby:!c.bigIntEnabled,sqlite3_index_constraint_usage:!c.bigIntEnabled});for(const $ of c.ctype.structs)R[$.name]||(l[$.name]=n.StructBinder($));if(l.sqlite3_index_info){for(const $ of["sqlite3_index_constraint","sqlite3_index_orderby","sqlite3_index_constraint_usage"])l.sqlite3_index_info[$]=l[$],delete l[$];l.sqlite3_vtab_config=c.xWrap("sqlite3__wasm_vtab_config","int",["sqlite3*","int","int"])}}const w=(O,I,D)=>u.sqlite3__wasm_db_error(O,l.SQLITE_MISUSE,I+"() requires "+D+" argument"+(D===1?"":"s")+"."),k=O=>u.sqlite3__wasm_db_error(O,l.SQLITE_FORMAT,"SQLITE_UTF8 is the only supported encoding."),Q=O=>c.xWrap.argAdapter("sqlite3*")(O),z=O=>c.isPtr(O)?c.cstrToJs(O):O,ie=(function(O,I){O=Q(O);let D=this.dbMap.get(O);if(I)!D&&I>0&&this.dbMap.set(O,D=Object.create(null));else return this.dbMap.delete(O),D;return D}).bind(Object.assign(Object.create(null),{dbMap:new Map}));ie.addCollation=function(O,I){const D=ie(O,1);D.collation||(D.collation=new Set),D.collation.add(z(I).toLowerCase())},ie._addUDF=function(O,I,D,R){I=z(I).toLowerCase();let $=R.get(I);$||R.set(I,$=new Set),$.add(D<0?-1:D)},ie.addFunction=function(O,I,D){const R=ie(O,1);R.udf||(R.udf=new Map),this._addUDF(O,I,D,R.udf)},c.exports.sqlite3_create_window_function&&(ie.addWindowFunc=function(O,I,D){const R=ie(O,1);R.wudf||(R.wudf=new Map),this._addUDF(O,I,D,R.wudf)}),ie.cleanup=function(O){O=Q(O);const I=[O];for(const $ of["sqlite3_busy_handler","sqlite3_commit_hook","sqlite3_preupdate_hook","sqlite3_progress_handler","sqlite3_rollback_hook","sqlite3_set_authorizer","sqlite3_trace_v2","sqlite3_update_hook"]){const F=c.exports[$];if(F){I.length=F.length;try{l[$](...I)}catch(K){n.config.warn("close-time call of",$+"(",I,") threw:",K)}}}const D=ie(O,0);if(!D)return;if(D.collation){for(const $ of D.collation)try{l.sqlite3_create_collation_v2(O,$,l.SQLITE_UTF8,0,0,0)}catch{}delete D.collation}let R;for(R=0;R<2;++R){const $=R?D.wudf:D.udf;if(!$)continue;const F=R?l.sqlite3_create_window_function:l.sqlite3_create_function_v2;for(const K of $){const ne=K[0],p=K[1],E=[O,ne,0,l.SQLITE_UTF8,0,0,0,0,0];R&&E.push(0);for(const C of p)try{E[2]=C,F.apply(null,E)}catch{}p.clear()}$.clear()}delete D.udf,delete D.wudf};{const O=c.xWrap("sqlite3_close_v2","int","sqlite3*");l.sqlite3_close_v2=function(I){if(arguments.length!==1)return w(I,"sqlite3_close_v2",1);if(I)try{ie.cleanup(I)}catch{}return O(I)}}if(l.sqlite3session_create){const O=c.xWrap("sqlite3session_delete",void 0,["sqlite3_session*"]);l.sqlite3session_delete=function(I){if(arguments.length!==1)return w(pDb,"sqlite3session_delete",1);I&&l.sqlite3session_table_filter(I,0,0),O(I)}}{const O=(D,R)=>"argv["+R+"]:"+D[0]+":"+c.cstrToJs(D[1]).toLowerCase(),I=c.xWrap("sqlite3_create_collation_v2","int",["sqlite3*","string","int","*",new c.xWrap.FuncPtrAdapter({name:"xCompare",signature:"i(pipip)",contextKey:O}),new c.xWrap.FuncPtrAdapter({name:"xDestroy",signature:"v(p)",contextKey:O})]);l.sqlite3_create_collation_v2=function(D,R,$,F,K,ne){if(arguments.length!==6)return w(D,"sqlite3_create_collation_v2",6);if(!($&15))$|=l.SQLITE_UTF8;else if(l.SQLITE_UTF8!==($&15))return k(D);try{const p=I(D,R,$,F,K,ne);return p===0&&K instanceof Function&&ie.addCollation(D,R),p}catch(p){return u.sqlite3__wasm_db_error(D,p)}},l.sqlite3_create_collation=(D,R,$,F,K)=>arguments.length===5?l.sqlite3_create_collation_v2(D,R,$,F,K,0):w(D,"sqlite3_create_collation",5)}{const O=function($,F){return $[0]+":"+($[2]<0?-1:$[2])+":"+F+":"+c.cstrToJs($[1]).toLowerCase()},I=Object.assign(Object.create(null),{xInverseAndStep:{signature:"v(pip)",contextKey:O,callProxy:$=>(F,K,ne)=>{try{$(F,...l.sqlite3_values_to_js(K,ne))}catch(p){l.sqlite3_result_error_js(F,p)}}},xFinalAndValue:{signature:"v(p)",contextKey:O,callProxy:$=>F=>{try{l.sqlite3_result_js(F,$(F))}catch(K){l.sqlite3_result_error_js(F,K)}}},xFunc:{signature:"v(pip)",contextKey:O,callProxy:$=>(F,K,ne)=>{try{l.sqlite3_result_js(F,$(F,...l.sqlite3_values_to_js(K,ne)))}catch(p){l.sqlite3_result_error_js(F,p)}}},xDestroy:{signature:"v(p)",contextKey:O,callProxy:$=>F=>{try{$(F)}catch(K){console.error("UDF xDestroy method threw:",K)}}}}),D=c.xWrap("sqlite3_create_function_v2","int",["sqlite3*","string","int","int","*",new c.xWrap.FuncPtrAdapter({name:"xFunc",...I.xFunc}),new c.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new c.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new c.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]),R=c.exports.sqlite3_create_window_function?c.xWrap("sqlite3_create_window_function","int",["sqlite3*","string","int","int","*",new c.xWrap.FuncPtrAdapter({name:"xStep",...I.xInverseAndStep}),new c.xWrap.FuncPtrAdapter({name:"xFinal",...I.xFinalAndValue}),new c.xWrap.FuncPtrAdapter({name:"xValue",...I.xFinalAndValue}),new c.xWrap.FuncPtrAdapter({name:"xInverse",...I.xInverseAndStep}),new c.xWrap.FuncPtrAdapter({name:"xDestroy",...I.xDestroy})]):void 0;l.sqlite3_create_function_v2=function $(F,K,ne,p,E,C,ee,y,q){if($.length!==arguments.length)return w(F,"sqlite3_create_function_v2",$.length);if(!(p&15))p|=l.SQLITE_UTF8;else if(l.SQLITE_UTF8!==(p&15))return k(F);try{const h=D(F,K,ne,p,E,C,ee,y,q);return h===0&&(C instanceof Function||ee instanceof Function||y instanceof Function||q instanceof Function)&&ie.addFunction(F,K,ne),h}catch(h){return console.error("sqlite3_create_function_v2() setup threw:",h),u.sqlite3__wasm_db_error(F,h,"Creation of UDF threw: "+h)}},l.sqlite3_create_function=function $(F,K,ne,p,E,C,ee,y){return $.length===arguments.length?l.sqlite3_create_function_v2(F,K,ne,p,E,C,ee,y,0):w(F,"sqlite3_create_function",$.length)},R?l.sqlite3_create_window_function=function $(F,K,ne,p,E,C,ee,y,q,h){if($.length!==arguments.length)return w(F,"sqlite3_create_window_function",$.length);if(!(p&15))p|=l.SQLITE_UTF8;else if(l.SQLITE_UTF8!==(p&15))return k(F);try{const _=R(F,K,ne,p,E,C,ee,y,q,h);return _===0&&(C instanceof Function||ee instanceof Function||y instanceof Function||q instanceof Function||h instanceof Function)&&ie.addWindowFunc(F,K,ne),_}catch(_){return console.error("sqlite3_create_window_function() setup threw:",_),u.sqlite3__wasm_db_error(F,_,"Creation of UDF threw: "+_)}}:delete l.sqlite3_create_window_function,l.sqlite3_create_function_v2.udfSetResult=l.sqlite3_create_function.udfSetResult=l.sqlite3_result_js,l.sqlite3_create_window_function&&(l.sqlite3_create_window_function.udfSetResult=l.sqlite3_result_js),l.sqlite3_create_function_v2.udfConvertArgs=l.sqlite3_create_function.udfConvertArgs=l.sqlite3_values_to_js,l.sqlite3_create_window_function&&(l.sqlite3_create_window_function.udfConvertArgs=l.sqlite3_values_to_js),l.sqlite3_create_function_v2.udfSetError=l.sqlite3_create_function.udfSetError=l.sqlite3_result_error_js,l.sqlite3_create_window_function&&(l.sqlite3_create_window_function.udfSetError=l.sqlite3_result_error_js)}{const O=(D,R)=>(typeof D=="string"?R=-1:u.isSQLableTypedArray(D)?(R=D.byteLength,D=u.typedArrayToString(D instanceof ArrayBuffer?new Uint8Array(D):D)):Array.isArray(D)&&(D=D.join(""),R=-1),[D,R]),I={basic:c.xWrap("sqlite3_prepare_v3","int",["sqlite3*","string","int","int","**","**"]),full:c.xWrap("sqlite3_prepare_v3","int",["sqlite3*","*","int","int","**","**"])};l.sqlite3_prepare_v3=function D(R,$,F,K,ne,p){if(D.length!==arguments.length)return w(R,"sqlite3_prepare_v3",D.length);const[E,C]=O($,F);switch(typeof E){case"string":return I.basic(R,E,C,K,ne,null);case"number":return I.full(R,E,C,K,ne,p);default:return u.sqlite3__wasm_db_error(R,l.SQLITE_MISUSE,"Invalid SQL argument type for sqlite3_prepare_v2/v3().")}},l.sqlite3_prepare_v2=function D(R,$,F,K,ne){return D.length===arguments.length?l.sqlite3_prepare_v3(R,$,F,0,K,ne):w(R,"sqlite3_prepare_v2",D.length)}}{const O=c.xWrap("sqlite3_bind_text","int",["sqlite3_stmt*","int","string","int","*"]),I=c.xWrap("sqlite3_bind_blob","int",["sqlite3_stmt*","int","*","int","*"]);l.sqlite3_bind_text=function D(R,$,F,K,ne){if(D.length!==arguments.length)return w(l.sqlite3_db_handle(R),"sqlite3_bind_text",D.length);if(c.isPtr(F)||F===null)return O(R,$,F,K,ne);F instanceof ArrayBuffer?F=new Uint8Array(F):Array.isArray(pMem)&&(F=pMem.join(""));let p,E;try{if(u.isSQLableTypedArray(F))p=c.allocFromTypedArray(F),E=F.byteLength;else if(typeof F=="string")[p,E]=c.allocCString(F);else return u.sqlite3__wasm_db_error(l.sqlite3_db_handle(R),l.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_text().");return O(R,$,p,E,l.SQLITE_WASM_DEALLOC)}catch(C){return c.dealloc(p),u.sqlite3__wasm_db_error(l.sqlite3_db_handle(R),C)}},l.sqlite3_bind_blob=function D(R,$,F,K,ne){if(D.length!==arguments.length)return w(l.sqlite3_db_handle(R),"sqlite3_bind_blob",D.length);if(c.isPtr(F)||F===null)return I(R,$,F,K,ne);F instanceof ArrayBuffer?F=new Uint8Array(F):Array.isArray(F)&&(F=F.join(""));let p,E;try{if(u.isBindableTypedArray(F))p=c.allocFromTypedArray(F),E=K>=0?K:F.byteLength;else if(typeof F=="string")[p,E]=c.allocCString(F);else return u.sqlite3__wasm_db_error(l.sqlite3_db_handle(R),l.SQLITE_MISUSE,"Invalid 3rd argument type for sqlite3_bind_blob().");return I(R,$,p,E,l.SQLITE_WASM_DEALLOC)}catch(C){return c.dealloc(p),u.sqlite3__wasm_db_error(l.sqlite3_db_handle(R),C)}}}l.sqlite3_config=function(O,...I){if(arguments.length<2)return l.SQLITE_MISUSE;switch(O){case l.SQLITE_CONFIG_COVERING_INDEX_SCAN:case l.SQLITE_CONFIG_MEMSTATUS:case l.SQLITE_CONFIG_SMALL_MALLOC:case l.SQLITE_CONFIG_SORTERREF_SIZE:case l.SQLITE_CONFIG_STMTJRNL_SPILL:case l.SQLITE_CONFIG_URI:return c.exports.sqlite3__wasm_config_i(O,I[0]);case l.SQLITE_CONFIG_LOOKASIDE:return c.exports.sqlite3__wasm_config_ii(O,I[0],I[1]);case l.SQLITE_CONFIG_MEMDB_MAXSIZE:return c.exports.sqlite3__wasm_config_j(O,I[0]);case l.SQLITE_CONFIG_GETMALLOC:case l.SQLITE_CONFIG_GETMUTEX:case l.SQLITE_CONFIG_GETPCACHE2:case l.SQLITE_CONFIG_GETPCACHE:case l.SQLITE_CONFIG_HEAP:case l.SQLITE_CONFIG_LOG:case l.SQLITE_CONFIG_MALLOC:case l.SQLITE_CONFIG_MMAP_SIZE:case l.SQLITE_CONFIG_MULTITHREAD:case l.SQLITE_CONFIG_MUTEX:case l.SQLITE_CONFIG_PAGECACHE:case l.SQLITE_CONFIG_PCACHE2:case l.SQLITE_CONFIG_PCACHE:case l.SQLITE_CONFIG_PCACHE_HDRSZ:case l.SQLITE_CONFIG_PMASZ:case l.SQLITE_CONFIG_SERIALIZED:case l.SQLITE_CONFIG_SINGLETHREAD:case l.SQLITE_CONFIG_SQLLOG:case l.SQLITE_CONFIG_WIN32_HEAPSIZE:default:return l.SQLITE_NOTFOUND}};{const O=new Set;l.sqlite3_auto_extension=function(I){if(I instanceof Function)I=c.installFunction("i(ppp)",I);else if(arguments.length!==1||!c.isPtr(I))return l.SQLITE_MISUSE;const D=c.exports.sqlite3_auto_extension(I);return I!==arguments[0]&&(D===0?O.add(I):c.uninstallFunction(I)),D},l.sqlite3_cancel_auto_extension=function(I){return!I||arguments.length!==1||!c.isPtr(I)?0:c.exports.sqlite3_cancel_auto_extension(I)},l.sqlite3_reset_auto_extension=function(){c.exports.sqlite3_reset_auto_extension();for(const I of O)c.uninstallFunction(I);O.clear()}}const oe=l.sqlite3_vfs_find("kvvfs");if(oe)if(u.isUIThread()){const O=new l.sqlite3_kvvfs_methods(c.exports.sqlite3__wasm_kvvfs_methods());delete l.sqlite3_kvvfs_methods;const I=c.exports.sqlite3__wasm_kvvfsMakeKeyOnPstack,D=c.pstack,R=F=>c.peek(F)===115?sessionStorage:localStorage,$={xRead:(F,K,ne,p)=>{const E=D.pointer,C=c.scopedAllocPush();try{const ee=I(F,K);if(!ee)return-3;const y=c.cstrToJs(ee),q=R(F).getItem(y);if(!q)return-1;const h=q.length;if(p<=0)return h;if(p===1)return c.poke(ne,0),h;const _=c.scopedAllocCString(q);return p>h+1&&(p=h+1),c.heap8u().copyWithin(ne,_,_+p-1),c.poke(ne+p-1,0),p-1}catch(ee){return console.error("kvstorageRead()",ee),-2}finally{D.restore(E),c.scopedAllocPop(C)}},xWrite:(F,K,ne)=>{const p=D.pointer;try{const E=I(F,K);if(!E)return 1;const C=c.cstrToJs(E);return R(F).setItem(C,c.cstrToJs(ne)),0}catch(E){return console.error("kvstorageWrite()",E),l.SQLITE_IOERR}finally{D.restore(p)}},xDelete:(F,K)=>{const ne=D.pointer;try{const p=I(F,K);return p?(R(F).removeItem(c.cstrToJs(p)),0):1}catch(p){return console.error("kvstorageDelete()",p),l.SQLITE_IOERR}finally{D.restore(ne)}}};for(const F of Object.keys($))O[O.memberKey(F)]=c.installFunction(O.memberSignature(F),$[F])}else l.sqlite3_vfs_unregister(oe);c.xWrap.FuncPtrAdapter.warnOnUse=!0;const U=n.StructBinder,P=function O(I,D,R,$=O.installMethodArgcCheck){if(I instanceof U.StructType?!(R instanceof Function)&&!c.isPtr(R)&&a("Usage errror: expecting a Function or WASM pointer to one."):a("Usage error: target object is-not-a StructType."),arguments.length===1)return(p,E)=>O(I,p,E,$);O.argcProxy||(O.argcProxy=function(p,E,C,ee){return function(...y){return C.length!==arguments.length&&a("Argument mismatch for",p.structInfo.name+"::"+E+": Native signature is:",ee),C.apply(this,y)}},O.removeFuncList=function(){this.ondispose.__removeFuncList&&(this.ondispose.__removeFuncList.forEach((p,E)=>{if(typeof p=="number")try{c.uninstallFunction(p)}catch{}}),delete this.ondispose.__removeFuncList)});const F=I.memberSignature(D);F.length<2&&a("Member",D,"does not have a function pointer signature:",F);const K=I.memberKey(D),ne=$&&!c.isPtr(R)?O.argcProxy(I,K,R,F):R;if(c.isPtr(ne))ne&&!c.functionEntry(ne)&&a("Pointer",ne,"is not a WASM function table entry."),I[K]=ne;else{const p=c.installFunction(ne,I.memberSignature(D,!0));I[K]=p,(!I.ondispose||!I.ondispose.__removeFuncList)&&(I.addOnDispose("ondispose.__removeFuncList handler",O.removeFuncList),I.ondispose.__removeFuncList=[]),I.ondispose.__removeFuncList.push(K,p)}return(p,E)=>O(I,p,E,$)};P.installMethodArgcCheck=!1;const J=function(O,I,D=P.installMethodArgcCheck){const R=new Map;for(const $ of Object.keys(I)){const F=I[$],K=R.get(F);if(K){const ne=O.memberKey($);O[ne]=O[O.memberKey(K)]}else P(O,$,F,D),R.set(F,$)}return O};U.StructType.prototype.installMethod=function(I,D,R=P.installMethodArgcCheck){return arguments.length<3&&I&&typeof I=="object"?J(this,...arguments):P(this,...arguments)},U.StructType.prototype.installMethods=function(O,I=P.installMethodArgcCheck){return J(this,O,I)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){n.version={libVersion:"3.49.1",libVersionNumber:3049001,sourceId:"2025-02-18 13:38:58 873d4e274b4988d260ba8354a9718324a1c26187a4ab4c1cc0227c03d0f10e70",downloadVersion:3490100}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){const a=(...y)=>{throw new n.SQLite3Error(...y)},l=n.capi,c=n.wasm,u=n.util,w=new WeakMap,k=new WeakMap,Q=(y,q,h)=>{const _=Object.getOwnPropertyDescriptor(y,q);return _?_.value:h},z=function(y,q){return q&&(y instanceof P&&(y=y.pointer),a(q,"sqlite3 result code",q+":",y?l.sqlite3_errmsg(y):l.sqlite3_errstr(q))),arguments[0]},ie=c.installFunction("i(ippp)",(function(y,q,h,_){l.SQLITE_TRACE_STMT===y&&console.log("SQL TRACE #"+ ++this.counter+" via sqlite3@"+q+":",c.cstrToJs(_))}).bind({counter:0})),oe=Object.create(null),U=function y(...q){if(!y._name2vfs){y._name2vfs=Object.create(null);const ve=typeof importScripts=="function"?Ie=>a("The VFS for",Ie,"is only available in the main window thread."):!1;y._name2vfs[":localStorage:"]={vfs:"kvvfs",filename:ve||(()=>"local")},y._name2vfs[":sessionStorage:"]={vfs:"kvvfs",filename:ve||(()=>"session")}}const h=y.normalizeArgs(...q);let _=h.filename,S=h.vfs,A=h.flags;(typeof _!="string"&&typeof _!="number"||typeof A!="string"||S&&typeof S!="string"&&typeof S!="number")&&(n.config.error("Invalid DB ctor args",h,arguments),a("Invalid arguments for DB constructor."));let Z=typeof _=="number"?c.cstrToJs(_):_;const he=y._name2vfs[Z];he&&(S=he.vfs,_=Z=he.filename(Z));let be,Ae=0;A.indexOf("c")>=0&&(Ae|=l.SQLITE_OPEN_CREATE|l.SQLITE_OPEN_READWRITE),A.indexOf("w")>=0&&(Ae|=l.SQLITE_OPEN_READWRITE),Ae===0&&(Ae|=l.SQLITE_OPEN_READONLY),Ae|=l.SQLITE_OPEN_EXRESCODE;const Ee=c.pstack.pointer;try{const ve=c.pstack.allocPtr();let Ie=l.sqlite3_open_v2(_,ve,Ae,S||0);be=c.peekPtr(ve),z(be,Ie),l.sqlite3_extended_result_codes(be,1),A.indexOf("t")>=0&&l.sqlite3_trace_v2(be,l.SQLITE_TRACE_STMT,ie,be)}catch(ve){throw be&&l.sqlite3_close_v2(be),ve}finally{c.pstack.restore(Ee)}this.filename=Z,w.set(this,be),k.set(this,Object.create(null));try{const ve=l.sqlite3_js_db_vfs(be)||a("Internal error: cannot get VFS for new db handle."),Ie=oe[ve];Ie&&(Ie instanceof Function?Ie(this,n):z(be,l.sqlite3_exec(be,Ie,0,0,0)))}catch(ve){throw this.close(),ve}};U.setVfsPostOpenCallback=function(y,q){q instanceof Function||a("dbCtorHelper.setVfsPostOpenCallback() should not be used with a non-function argument.",arguments),oe[y]=q},U.normalizeArgs=function(y=":memory:",q="c",h=null){const _={};return arguments.length===1&&arguments[0]&&typeof arguments[0]=="object"?(Object.assign(_,arguments[0]),_.flags===void 0&&(_.flags="c"),_.vfs===void 0&&(_.vfs=null),_.filename===void 0&&(_.filename=":memory:")):(_.filename=y,_.flags=q,_.vfs=h),_};const P=function(...y){U.apply(this,y)};P.dbCtorHelper=U;const J={null:1,number:2,string:3,boolean:4,blob:5};J.undefined==J.null,c.bigIntEnabled&&(J.bigint=J.number);const O=function(){J!==arguments[2]&&a(l.SQLITE_MISUSE,"Do not call the Stmt constructor directly. Use DB.prepare()."),this.db=arguments[0],w.set(this,arguments[1]),this.parameterCount=l.sqlite3_bind_parameter_count(this.pointer)},I=function(y){return y.pointer||a("DB has been closed."),y},D=function(y,q){return(q!==(q|0)||q<0||q>=y.columnCount)&&a("Column index",q,"is out of range."),y},R=function(y,q){const h=Object.create(null);switch(h.opt=Object.create(null),q.length){case 1:typeof q[0]=="string"||u.isSQLableTypedArray(q[0])||Array.isArray(q[0])?h.sql=q[0]:q[0]&&typeof q[0]=="object"&&(h.opt=q[0],h.sql=h.opt.sql);break;case 2:h.sql=q[0],h.opt=q[1];break;default:a("Invalid argument count for exec().")}h.sql=u.flexibleString(h.sql),typeof h.sql!="string"&&a("Missing SQL argument or unsupported SQL value type.");const _=h.opt;switch(_.returnValue){case"resultRows":_.resultRows||(_.resultRows=[]),h.returnVal=()=>_.resultRows;break;case"saveSql":_.saveSql||(_.saveSql=[]),h.returnVal=()=>_.saveSql;break;case void 0:case"this":h.returnVal=()=>y;break;default:a("Invalid returnValue value:",_.returnValue)}if(!_.callback&&!_.returnValue&&_.rowMode!==void 0&&(_.resultRows||(_.resultRows=[]),h.returnVal=()=>_.resultRows),_.callback||_.resultRows)switch(_.rowMode===void 0?"array":_.rowMode){case"object":h.cbArg=(S,A)=>{A.columnNames||(A.columnNames=S.getColumnNames([]));const Z=S.get([]),he=Object.create(null);for(const be in A.columnNames)he[A.columnNames[be]]=Z[be];return he};break;case"array":h.cbArg=S=>S.get([]);break;case"stmt":Array.isArray(_.resultRows)&&a("exec(): invalid rowMode for a resultRows array: must","be one of 'array', 'object',","a result column number, or column name reference."),h.cbArg=S=>S;break;default:if(u.isInt32(_.rowMode)){h.cbArg=S=>S.get(_.rowMode);break}else if(typeof _.rowMode=="string"&&_.rowMode.length>1&&_.rowMode[0]==="$"){const S=_.rowMode.substr(1);h.cbArg=A=>{const Z=A.get(Object.create(null))[S];return Z===void 0?a(l.SQLITE_NOTFOUND,"exec(): unknown result column:",S):Z};break}a("Invalid rowMode:",_.rowMode)}return h},$=(y,q,h,..._)=>{const S=y.prepare(q);try{const A=S.bind(h).step()?S.get(..._):void 0;return S.reset(),A}finally{S.finalize()}},F=(y,q,h,_)=>y.exec({sql:q,bind:h,rowMode:_,returnValue:"resultRows"});P.checkRc=(y,q)=>z(y,q),P.prototype={isOpen:function(){return!!this.pointer},affirmOpen:function(){return I(this)},close:function(){if(this.pointer){if(this.onclose&&this.onclose.before instanceof Function)try{this.onclose.before(this)}catch{}const y=this.pointer;if(Object.keys(k.get(this)).forEach((q,h)=>{if(h&&h.pointer)try{h.finalize()}catch{}}),w.delete(this),k.delete(this),l.sqlite3_close_v2(y),this.onclose&&this.onclose.after instanceof Function)try{this.onclose.after(this)}catch{}delete this.filename}},changes:function(y=!1,q=!1){const h=I(this).pointer;return y?q?l.sqlite3_total_changes64(h):l.sqlite3_total_changes(h):q?l.sqlite3_changes64(h):l.sqlite3_changes(h)},dbFilename:function(y="main"){return l.sqlite3_db_filename(I(this).pointer,y)},dbName:function(y=0){return l.sqlite3_db_name(I(this).pointer,y)},dbVfsName:function(y=0){let q;const h=l.sqlite3_js_db_vfs(I(this).pointer,y);if(h){const _=new l.sqlite3_vfs(h);try{q=c.cstrToJs(_.$zName)}finally{_.dispose()}}return q},prepare:function(y){I(this);const q=c.pstack.pointer;let h,_;try{h=c.pstack.alloc(8),P.checkRc(this,l.sqlite3_prepare_v2(this.pointer,y,-1,h,null)),_=c.peekPtr(h)}finally{c.pstack.restore(q)}_||a("Cannot prepare empty SQL.");const S=new O(this,_,J);return k.get(this)[_]=S,S},exec:function(){I(this);const y=R(this,arguments);if(!y.sql)return a("exec() requires an SQL string.");const q=y.opt,h=q.callback,_=Array.isArray(q.resultRows)?q.resultRows:void 0;let S,A=q.bind,Z=!!(y.cbArg||q.columnNames||_);const he=c.scopedAllocPush(),be=Array.isArray(q.saveSql)?q.saveSql:void 0;try{const Ae=u.isSQLableTypedArray(y.sql);let Ee=Ae?y.sql.byteLength:c.jstrlen(y.sql);const ve=c.scopedAlloc(2*c.ptrSizeof+(Ee+1)),Ie=ve+c.ptrSizeof;let Le=Ie+c.ptrSizeof;const Qe=Le+Ee;for(Ae?c.heap8().set(y.sql,Le):c.jstrcpy(y.sql,c.heap8(),Le,Ee,!1),c.poke(Le+Ee,0);Le&&c.peek(Le,"i8");){c.pokePtr([ve,Ie],0),P.checkRc(this,l.sqlite3_prepare_v3(this.pointer,Le,Ee,0,ve,Ie));const je=c.peekPtr(ve);if(Le=c.peekPtr(Ie),Ee=Qe-Le,!!je){if(be&&be.push(l.sqlite3_sql(je).trim()),S=new O(this,je,J),A&&S.parameterCount&&(S.bind(A),A=null),Z&&S.columnCount){let St=Array.isArray(q.columnNames)?0:1;if(Z=!1,y.cbArg||_){const nt=Object.create(null);for(;S.step();S._lockedByExec=!1){St++===0&&S.getColumnNames(nt.columnNames=q.columnNames||[]),S._lockedByExec=!0;const B=y.cbArg(S,nt);if(_&&_.push(B),h&&h.call(q,B,S)===!1)break}S._lockedByExec=!1}St===0&&S.getColumnNames(q.columnNames)}else S.step();S.reset().finalize(),S=null}}}finally{c.scopedAllocPop(he),S&&(delete S._lockedByExec,S.finalize())}return y.returnVal()},createFunction:function(q,h,_){const S=nt=>nt instanceof Function;switch(arguments.length){case 1:_=q,q=_.name,h=_.xFunc||0;break;case 2:S(h)||(_=h,h=_.xFunc||0);break}_||(_={}),typeof q!="string"&&a("Invalid arguments: missing function name.");let A=_.xStep||0,Z=_.xFinal||0;const he=_.xValue||0,be=_.xInverse||0;let Ae;S(h)?(Ae=!1,(S(A)||S(Z))&&a("Ambiguous arguments: scalar or aggregate?"),A=Z=null):S(A)?(S(Z)||a("Missing xFinal() callback for aggregate or window UDF."),h=null):S(Z)?a("Missing xStep() callback for aggregate or window UDF."):a("Missing function-type properties."),Ae===!1?(S(he)||S(be))&&a("xValue and xInverse are not permitted for non-window UDFs."):S(he)?(S(be)||a("xInverse must be provided if xValue is."),Ae=!0):S(be)&&a("xValue must be provided if xInverse is.");const Ee=_.pApp;Ee!=null&&(typeof Ee!="number"||!u.isInt32(Ee))&&a("Invalid value for pApp property. Must be a legal WASM pointer value.");const ve=_.xDestroy||0;ve&&!S(ve)&&a("xDestroy property must be a function.");let Ie=0;Q(_,"deterministic")&&(Ie|=l.SQLITE_DETERMINISTIC),Q(_,"directOnly")&&(Ie|=l.SQLITE_DIRECTONLY),Q(_,"innocuous")&&(Ie|=l.SQLITE_INNOCUOUS),q=q.toLowerCase();const Le=h||A,Qe=Q(_,"arity"),je=typeof Qe=="number"?Qe:Le.length?Le.length-1:0;let St;return Ae?St=l.sqlite3_create_window_function(this.pointer,q,je,l.SQLITE_UTF8|Ie,Ee||0,A,Z,he,be,ve):St=l.sqlite3_create_function_v2(this.pointer,q,je,l.SQLITE_UTF8|Ie,Ee||0,h,A,Z,ve),P.checkRc(this,St),this},selectValue:function(y,q,h){return $(this,y,q,0,h)},selectValues:function(y,q,h){const _=this.prepare(y),S=[];try{for(_.bind(q);_.step();)S.push(_.get(0,h));_.reset()}finally{_.finalize()}return S},selectArray:function(y,q){return $(this,y,q,[])},selectObject:function(y,q){return $(this,y,q,{})},selectArrays:function(y,q){return F(this,y,q,"array")},selectObjects:function(y,q){return F(this,y,q,"object")},openStatementCount:function(){return this.pointer?Object.keys(k.get(this)).length:0},transaction:function(y){let q="BEGIN";arguments.length>1&&(/[^a-zA-Z]/.test(arguments[0])&&a(l.SQLITE_MISUSE,"Invalid argument for BEGIN qualifier."),q+=" "+arguments[0],y=arguments[1]),I(this).exec(q);try{const h=y(this);return this.exec("COMMIT"),h}catch(h){throw this.exec("ROLLBACK"),h}},savepoint:function(y){I(this).exec("SAVEPOINT oo1");try{const q=y(this);return this.exec("RELEASE oo1"),q}catch(q){throw this.exec("ROLLBACK to SAVEPOINT oo1; RELEASE SAVEPOINT oo1"),q}},checkRc:function(y){return z(this,y)}};const K=function(y){return y.pointer||a("Stmt has been closed."),y},ne=function(y){let q=J[y==null?"null":typeof y];switch(q){case J.boolean:case J.null:case J.number:case J.string:return q;case J.bigint:if(c.bigIntEnabled)return q;default:return u.isBindableTypedArray(y)?J.blob:void 0}},p=function(y){return ne(y)||a("Unsupported bind() argument type:",typeof y)},E=function(y,q){const h=typeof q=="number"?q:l.sqlite3_bind_parameter_index(y.pointer,q);return h===0||!u.isInt32(h)?a("Invalid bind() parameter name: "+q):(h<1||h>y.parameterCount)&&a("Bind index",q,"is out of range."),h},C=function(y,q){return y._lockedByExec&&a("Operation is illegal when statement is locked:",q),y},ee=function y(q,h,_,S){C(K(q),"bind()"),y._||(y._tooBigInt=Z=>a("BigInt value is too big to store without precision loss:",Z),y._={string:function(Z,he,be,Ae){const[Ee,ve]=c.allocCString(be,!0);return(Ae?l.sqlite3_bind_blob:l.sqlite3_bind_text)(Z.pointer,he,Ee,ve,l.SQLITE_WASM_DEALLOC)}}),p(S),h=E(q,h);let A=0;switch(S==null?J.null:_){case J.null:A=l.sqlite3_bind_null(q.pointer,h);break;case J.string:A=y._.string(q,h,S,!1);break;case J.number:{let Z;u.isInt32(S)?Z=l.sqlite3_bind_int:typeof S=="bigint"?u.bigIntFits64(S)?c.bigIntEnabled?Z=l.sqlite3_bind_int64:u.bigIntFitsDouble(S)?(S=Number(S),Z=l.sqlite3_bind_double):y._tooBigInt(S):y._tooBigInt(S):(S=Number(S),c.bigIntEnabled&&Number.isInteger(S)?Z=l.sqlite3_bind_int64:Z=l.sqlite3_bind_double),A=Z(q.pointer,h,S);break}case J.boolean:A=l.sqlite3_bind_int(q.pointer,h,S?1:0);break;case J.blob:{if(typeof S=="string"){A=y._.string(q,h,S,!0);break}else S instanceof ArrayBuffer?S=new Uint8Array(S):u.isBindableTypedArray(S)||a("Binding a value as a blob requires","that it be a string, Uint8Array, Int8Array, or ArrayBuffer.");const Z=c.alloc(S.byteLength||1);c.heap8().set(S.byteLength?S:[0],Z),A=l.sqlite3_bind_blob(q.pointer,h,Z,S.byteLength,l.SQLITE_WASM_DEALLOC);break}default:n.config.warn("Unsupported bind() argument type:",S),a("Unsupported bind() argument type: "+typeof S)}return A&&P.checkRc(q.db.pointer,A),q._mayGet=!1,q};O.prototype={finalize:function(){if(this.pointer){C(this,"finalize()");const y=l.sqlite3_finalize(this.pointer);return delete k.get(this.db)[this.pointer],w.delete(this),delete this._mayGet,delete this.parameterCount,delete this._lockedByExec,delete this.db,y}},clearBindings:function(){return C(K(this),"clearBindings()"),l.sqlite3_clear_bindings(this.pointer),this._mayGet=!1,this},reset:function(y){C(this,"reset()"),y&&this.clearBindings();const q=l.sqlite3_reset(K(this).pointer);return this._mayGet=!1,z(this.db,q),this},bind:function(){K(this);let y,q;switch(arguments.length){case 1:y=1,q=arguments[0];break;case 2:y=arguments[0],q=arguments[1];break;default:a("Invalid bind() arguments.")}return q===void 0?this:(this.parameterCount||a("This statement has no bindable parameters."),this._mayGet=!1,q===null?ee(this,y,J.null,q):Array.isArray(q)?(arguments.length!==1&&a("When binding an array, an index argument is not permitted."),q.forEach((h,_)=>ee(this,_+1,p(h),h)),this):(q instanceof ArrayBuffer&&(q=new Uint8Array(q)),typeof q=="object"&&!u.isBindableTypedArray(q)?(arguments.length!==1&&a("When binding an object, an index argument is not permitted."),Object.keys(q).forEach(h=>ee(this,h,p(q[h]),q[h])),this):ee(this,y,p(q),q)))},bindAsBlob:function(y,q){K(this),arguments.length===1&&(q=y,y=1);const h=p(q);return J.string!==h&&J.blob!==h&&J.null!==h&&a("Invalid value type for bindAsBlob()"),ee(this,y,J.blob,q)},step:function(){C(this,"step()");const y=l.sqlite3_step(K(this).pointer);switch(y){case l.SQLITE_DONE:return this._mayGet=!1;case l.SQLITE_ROW:return this._mayGet=!0;default:this._mayGet=!1,n.config.warn("sqlite3_step() rc=",y,l.sqlite3_js_rc_str(y),"SQL =",l.sqlite3_sql(this.pointer)),P.checkRc(this.db.pointer,y)}},stepReset:function(){return this.step(),this.reset()},stepFinalize:function(){try{const y=this.step();return this.reset(),y}finally{try{this.finalize()}catch{}}},get:function(y,q){if(K(this)._mayGet||a("Stmt.step() has not (recently) returned true."),Array.isArray(y)){let h=0;const _=this.columnCount;for(;h<_;)y[h]=this.get(h++);return y}else if(y&&typeof y=="object"){let h=0;const _=this.columnCount;for(;h<_;)y[l.sqlite3_column_name(this.pointer,h)]=this.get(h++);return y}switch(D(this,y),q===void 0?l.sqlite3_column_type(this.pointer,y):q){case l.SQLITE_NULL:return null;case l.SQLITE_INTEGER:if(c.bigIntEnabled){const h=l.sqlite3_column_int64(this.pointer,y);return h>=Number.MIN_SAFE_INTEGER&&h<=Number.MAX_SAFE_INTEGER?Number(h).valueOf():h}else{const h=l.sqlite3_column_double(this.pointer,y);return(h>Number.MAX_SAFE_INTEGER||h<Number.MIN_SAFE_INTEGER)&&a("Integer is out of range for JS integer range: "+h),u.isInt32(h)?h|0:h}case l.SQLITE_FLOAT:return l.sqlite3_column_double(this.pointer,y);case l.SQLITE_TEXT:return l.sqlite3_column_text(this.pointer,y);case l.SQLITE_BLOB:{const h=l.sqlite3_column_bytes(this.pointer,y),_=l.sqlite3_column_blob(this.pointer,y),S=new Uint8Array(h);return h&&S.set(c.heap8u().slice(_,_+h),0),h&&this.db._blobXfer instanceof Array&&this.db._blobXfer.push(S.buffer),S}default:a("Don't know how to translate","type of result column #"+y+".")}a("Not reached.")},getInt:function(y){return this.get(y,l.SQLITE_INTEGER)},getFloat:function(y){return this.get(y,l.SQLITE_FLOAT)},getString:function(y){return this.get(y,l.SQLITE_TEXT)},getBlob:function(y){return this.get(y,l.SQLITE_BLOB)},getJSON:function(y){const q=this.get(y,l.SQLITE_STRING);return q===null?q:JSON.parse(q)},getColumnName:function(y){return l.sqlite3_column_name(D(K(this),y).pointer,y)},getColumnNames:function(y=[]){D(K(this),0);const q=this.columnCount;for(let h=0;h<q;++h)y.push(l.sqlite3_column_name(this.pointer,h));return y},getParamIndex:function(y){return K(this).parameterCount?l.sqlite3_bind_parameter_index(this.pointer,y):void 0},getParamName:function(y){return K(this).parameterCount?l.sqlite3_bind_parameter_name(this.pointer,y):void 0},isBusy:function(){return l.sqlite3_stmt_busy(K(this))!==0},isReadOnly:function(){return l.sqlite3_stmt_readonly(K(this))!==0}};{const y={enumerable:!0,get:function(){return w.get(this)},set:()=>a("The pointer property is read-only.")};Object.defineProperty(O.prototype,"pointer",y),Object.defineProperty(P.prototype,"pointer",y)}if(Object.defineProperty(O.prototype,"columnCount",{enumerable:!1,get:function(){return l.sqlite3_column_count(this.pointer)},set:()=>a("The columnCount property is read-only.")}),n.oo1={DB:P,Stmt:O},u.isUIThread()){n.oo1.JsStorageDb=function(q="session"){const h=U.normalizeArgs(...arguments);q=h.filename,q!=="session"&&q!=="local"&&a("JsStorageDb db name must be one of 'session' or 'local'."),h.vfs="kvvfs",U.call(this,h)};const y=n.oo1.JsStorageDb;y.prototype=Object.create(P.prototype),y.clearStorage=l.sqlite3_js_kvvfs_clear,y.prototype.clearStorage=function(){return y.clearStorage(I(this).filename)},y.storageSize=l.sqlite3_js_kvvfs_size,y.prototype.storageSize=function(){return y.storageSize(I(this).filename)}}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){const a=n.util;n.initWorker1API=(function(){const l=(...U)=>{throw new Error(U.join(" "))};globalThis.WorkerGlobalScope instanceof Function||l("initWorker1API() must be run from a Worker thread.");const c=this.sqlite3||l("Missing this.sqlite3 object."),u=c.oo1.DB,w=function(U){let P=k.idMap.get(U);return P||(P="db#"+ ++k.idSeq+"@"+U.pointer,k.idMap.set(U,P),P)},k={dbList:[],idSeq:0,idMap:new WeakMap,xfer:[],open:function(U){const P=new u(U);return this.dbs[w(P)]=P,this.dbList.indexOf(P)<0&&this.dbList.push(P),P},close:function(U,P){if(U){delete this.dbs[w(U)];const J=U.filename,O=a.sqlite3__wasm_db_vfs(U.pointer,0);U.close();const I=this.dbList.indexOf(U);I>=0&&this.dbList.splice(I,1),P&&J&&O&&a.sqlite3__wasm_vfs_unlink(O,J)}},post:function(U,P){P&&P.length?(globalThis.postMessage(U,Array.from(P)),P.length=0):globalThis.postMessage(U)},dbs:Object.create(null),getDb:function(U,P=!0){return this.dbs[U]||(P?l("Unknown (or closed) DB ID:",U):void 0)}},Q=function(U=k.dbList[0]){return U&&U.pointer?U:l("DB is not opened.")},z=function(U,P=!0){const J=k.getDb(U.dbId,!1)||k.dbList[0];return P?Q(J):J},ie=function(){return k.dbList[0]&&w(k.dbList[0])},oe={open:function(U){const P=Object.create(null),J=U.args||Object.create(null);J.simulateError&&l("Throwing because of simulateError flag.");const O=Object.create(null);P.vfs=J.vfs,P.filename=J.filename||"";const I=k.open(P);return O.filename=I.filename,O.persistent=!!c.capi.sqlite3_js_db_uses_vfs(I.pointer,"opfs"),O.dbId=w(I),O.vfs=I.dbVfsName(),O},close:function(U){const P=z(U,!1),J={filename:P&&P.filename};if(P){const O=U.args&&typeof U.args=="object"?!!U.args.unlink:!1;k.close(P,O)}return J},exec:function(U){const P=typeof U.args=="string"?{sql:U.args}:U.args||Object.create(null);P.rowMode==="stmt"?l("Invalid rowMode for 'exec': stmt mode","does not work in the Worker API."):P.sql||l("'exec' requires input SQL.");const J=z(U);(P.callback||Array.isArray(P.resultRows))&&(J._blobXfer=k.xfer);const O=P.callback;let I=0;const D=!!P.columnNames;typeof O=="string"&&(D||(P.columnNames=[]),P.callback=function(R,$){k.post({type:O,columnNames:P.columnNames,rowNumber:++I,row:R},k.xfer)});try{const R=P.countChanges?J.changes(!0,P.countChanges===64):void 0;J.exec(P),R!==void 0&&(P.changeCount=J.changes(!0,P.countChanges===64)-R),P.callback instanceof Function&&(P.callback=O,k.post({type:O,columnNames:P.columnNames,rowNumber:null,row:void 0}))}finally{delete J._blobXfer,P.callback&&(P.callback=O)}return P},"config-get":function(){const U=Object.create(null),P=c.config;return["bigIntEnabled"].forEach(function(J){Object.getOwnPropertyDescriptor(P,J)&&(U[J]=P[J])}),U.version=c.version,U.vfsList=c.capi.sqlite3_js_vfs_list(),U},export:function(U){const P=z(U),J={byteArray:c.capi.sqlite3_js_db_export(P.pointer),filename:P.filename,mimetype:"application/x-sqlite3"};return k.xfer.push(J.byteArray.buffer),J},toss:function(U){l("Testing worker exception")}};globalThis.onmessage=async function(U){U=U.data;let P,J=U.dbId,O=U.type;const I=performance.now();try{oe.hasOwnProperty(O)&&oe[O]instanceof Function?P=await oe[O](U):l("Unknown db worker message type:",U.type)}catch(D){O="error",P={operation:U.type,message:D.message,errorClass:D.name,input:U},D.stack&&(P.stack=typeof D.stack=="string"?D.stack.split(/\n\s*/):D.stack)}J||(J=P.dbId||ie()),k.post({type:O,dbId:J,messageId:U.messageId,workerReceivedTime:I,workerRespondTime:performance.now(),departureTime:U.departureTime,result:P},k.xfer)},globalThis.postMessage({type:"sqlite3-api",result:"worker1-ready"})}).bind({sqlite3:n})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){const a=n.wasm,l=n.capi,c=n.util.toss3,u=Object.create(null);n.vfs=u,l.sqlite3_vfs.prototype.registerVfs=function(w=!1){this instanceof n.capi.sqlite3_vfs||c("Expecting a sqlite3_vfs-type argument.");const k=l.sqlite3_vfs_register(this,w?1:0);return k&&c("sqlite3_vfs_register(",this,") failed with rc",k),this.pointer!==l.sqlite3_vfs_find(this.$zName)&&c("BUG: sqlite3_vfs_find(vfs.$zName) failed for just-installed VFS",this),this},u.installVfs=function(w){let k=0;const Q=["io","vfs"];for(const z of Q){const ie=w[z];ie&&(++k,ie.struct.installMethods(ie.methods,!!ie.applyArgcCheck),z==="vfs"&&(!ie.struct.$zName&&typeof ie.name=="string"&&ie.struct.addOnDispose(ie.struct.$zName=a.allocCString(ie.name)),ie.struct.registerVfs(!!ie.asDefault)))}return k||c("Misuse: installVfs() options object requires at least","one of:",Q),this}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){if(!n.wasm.exports.sqlite3_declare_vtab)return;const a=n.wasm,l=n.capi,c=n.util.toss3,u=Object.create(null);n.vtab=u;const w=l.sqlite3_index_info;w.prototype.nthConstraint=function(z,ie=!1){if(z<0||z>=this.$nConstraint)return!1;const oe=this.$aConstraint+w.sqlite3_index_constraint.structInfo.sizeof*z;return ie?oe:new w.sqlite3_index_constraint(oe)},w.prototype.nthConstraintUsage=function(z,ie=!1){if(z<0||z>=this.$nConstraint)return!1;const oe=this.$aConstraintUsage+w.sqlite3_index_constraint_usage.structInfo.sizeof*z;return ie?oe:new w.sqlite3_index_constraint_usage(oe)},w.prototype.nthOrderBy=function(z,ie=!1){if(z<0||z>=this.$nOrderBy)return!1;const oe=this.$aOrderBy+w.sqlite3_index_orderby.structInfo.sizeof*z;return ie?oe:new w.sqlite3_index_orderby(oe)};const k=function(z,ie){return(function(oe,U=!1){if(arguments.length===0&&(oe=new ie),oe instanceof ie)return this.set(oe.pointer,oe),oe;a.isPtr(oe)||n.SQLite3Error.toss("Invalid argument to",z+"()");let P=this.get(oe);return U&&this.delete(oe),P}).bind(new Map)},Q=function(z,ie){const oe=k(z,ie);return Object.assign(Object.create(null),{StructType:ie,create:U=>{const P=oe();return a.pokePtr(U,P.pointer),P},get:U=>oe(U),unget:U=>oe(U,!0),dispose:U=>{const P=oe(U,!0);P&&P.dispose()}})};u.xVtab=Q("xVtab",l.sqlite3_vtab),u.xCursor=Q("xCursor",l.sqlite3_vtab_cursor),u.xIndexInfo=z=>new l.sqlite3_index_info(z),u.xError=function z(ie,oe,U){if(z.errorReporter instanceof Function)try{z.errorReporter("sqlite3_module::"+ie+"(): "+oe.message)}catch{}let P;return oe instanceof n.WasmAllocError?P=l.SQLITE_NOMEM:arguments.length>2?P=U:oe instanceof n.SQLite3Error&&(P=oe.resultCode),P||l.SQLITE_ERROR},u.xError.errorReporter=console.error.bind(console),u.xRowid=(z,ie)=>a.poke(z,ie,"i64"),u.setupModule=function(z){let ie=!1;const oe=this instanceof l.sqlite3_module?this:z.struct||(ie=new l.sqlite3_module);try{const U=z.methods||c("Missing 'methods' object.");for(const P of Object.entries({xConnect:"xCreate",xDisconnect:"xDestroy"})){const J=P[0],O=P[1];U[J]===!0?U[J]=U[O]:U[O]===!0&&(U[O]=U[J])}if(z.catchExceptions){const P=function(I,D){return["xConnect","xCreate"].indexOf(I)>=0?function(R,$,F,K,ne,p){try{return D(...arguments)||0}catch(E){return E instanceof n.WasmAllocError||(a.dealloc(a.peekPtr(p)),a.pokePtr(p,a.allocCString(E.message))),u.xError(I,E)}}:function(...R){try{return D(...R)||0}catch($){return u.xError(I,$)}}},J=["xCreate","xConnect","xBestIndex","xDisconnect","xDestroy","xOpen","xClose","xFilter","xNext","xEof","xColumn","xRowid","xUpdate","xBegin","xSync","xCommit","xRollback","xFindFunction","xRename","xSavepoint","xRelease","xRollbackTo","xShadowName"],O=Object.create(null);for(const I of J){const D=U[I];if(D instanceof Function)I==="xConnect"&&U.xCreate===D?O[I]=U.xCreate:I==="xCreate"&&U.xConnect===D?O[I]=U.xConnect:O[I]=P(I,D);else continue}oe.installMethods(O,!1)}else oe.installMethods(U,!!z.applyArgcCheck);if(oe.$iVersion===0){let P;typeof z.iVersion=="number"?P=z.iVersion:oe.$xShadowName?P=3:oe.$xSavePoint||oe.$xRelease||oe.$xRollbackTo?P=2:P=1,oe.$iVersion=P}}catch(U){throw ie&&ie.dispose(),U}return oe},l.sqlite3_module.prototype.setupModule=function(z){return u.setupModule.call(this,z)}}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){const a=function l(c){var k;if(!globalThis.SharedArrayBuffer||!globalThis.Atomics)return Promise.reject(new Error("Cannot install OPFS: Missing SharedArrayBuffer and/or Atomics. The server must emit the COOP/COEP response headers to enable those. See https://sqlite.org/wasm/doc/trunk/persistence.md#coop-coep"));if(typeof WorkerGlobalScope>"u")return Promise.reject(new Error("The OPFS sqlite3_vfs cannot run in the main thread because it requires Atomics.wait()."));if(!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((k=navigator==null?void 0:navigator.storage)!=null&&k.getDirectory))return Promise.reject(new Error("Missing required OPFS APIs."));(!c||typeof c!="object")&&(c=Object.create(null));const u=new URL(globalThis.location.href).searchParams;return u.has("opfs-disable")?Promise.resolve(n):(c.verbose===void 0&&(c.verbose=u.has("opfs-verbose")?+u.get("opfs-verbose")||2:1),c.sanityChecks===void 0&&(c.sanityChecks=u.has("opfs-sanity-check")),c.proxyUri===void 0&&(c.proxyUri=l.defaultProxyUri),typeof c.proxyUri=="function"&&(c.proxyUri=c.proxyUri()),new Promise(function(Q,z){const ie=[n.config.error,n.config.warn,n.config.log],oe=(B,...Y)=>{c.verbose>B&&ie[B]("OPFS syncer:",...Y)},U=(...B)=>oe(2,...B),P=(...B)=>oe(1,...B),J=(...B)=>oe(0,...B),O=n.util.toss,I=n.capi,D=n.util,R=n.wasm,$=I.sqlite3_vfs,F=I.sqlite3_file,K=I.sqlite3_io_methods,ne=Object.create(null),p=()=>{var B;return globalThis.FileSystemHandle&&globalThis.FileSystemDirectoryHandle&&globalThis.FileSystemFileHandle&&globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle&&((B=navigator==null?void 0:navigator.storage)==null?void 0:B.getDirectory)};ne.metrics={dump:function(){let B,Y=0,te=0,de=0;for(B in A.opIds){const ce=Z[B];Y+=ce.count,te+=ce.time,de+=ce.wait,ce.avgTime=ce.count&&ce.time?ce.time/ce.count:0,ce.avgWait=ce.count&&ce.wait?ce.wait/ce.count:0}n.config.log(globalThis.location.href,"metrics for",globalThis.location.href,":",Z,`
Total of`,Y,"op(s) for",te,"ms (incl. "+de+" ms of waiting on the async side)"),n.config.log("Serialization metrics:",Z.s11n),h.postMessage({type:"opfs-async-metrics"})},reset:function(){let B;const Y=de=>de.count=de.time=de.wait=0;for(B in A.opIds)Y(Z[B]=Object.create(null));let te=Z.s11n=Object.create(null);te=te.serialize=Object.create(null),te.count=te.time=0,te=Z.s11n.deserialize=Object.create(null),te.count=te.time=0}};const E=new K,C=new $().addOnDispose(()=>E.dispose());let ee;const y=B=>(ee=!0,C.dispose(),z(B)),q=()=>(ee=!1,Q(n)),h=new Worker(new URL("/docs/assets/sqlite3-opfs-async-proxy-DZdsd1Kz.js",import.meta.url));setTimeout(()=>{ee===void 0&&y(new Error("Timeout while waiting for OPFS async proxy worker."))},4e3),h._originalOnError=h.onerror,h.onerror=function(B){J("Error initializing OPFS asyncer:",B),y(new Error("Loading OPFS async Worker failed for unknown reasons."))};const _=I.sqlite3_vfs_find(null),S=_?new $(_):null;E.$iVersion=1,C.$iVersion=2,C.$szOsFile=I.sqlite3_file.structInfo.sizeof,C.$mxPathname=1024,C.$zName=R.allocCString("opfs"),C.$xDlOpen=C.$xDlError=C.$xDlSym=C.$xDlClose=null,C.addOnDispose("$zName",C.$zName,"cleanup default VFS wrapper",()=>S?S.dispose():null);const A=Object.create(null);A.verbose=c.verbose,A.littleEndian=(()=>{const B=new ArrayBuffer(2);return new DataView(B).setInt16(0,256,!0),new Int16Array(B)[0]===256})(),A.asyncIdleWaitTime=150,A.asyncS11nExceptions=1,A.fileBufferSize=1024*64,A.sabS11nOffset=A.fileBufferSize,A.sabS11nSize=C.$mxPathname*2,A.sabIO=new SharedArrayBuffer(A.fileBufferSize+A.sabS11nSize),A.opIds=Object.create(null);const Z=Object.create(null);{let B=0;A.opIds.whichOp=B++,A.opIds.rc=B++,A.opIds.xAccess=B++,A.opIds.xClose=B++,A.opIds.xDelete=B++,A.opIds.xDeleteNoWait=B++,A.opIds.xFileSize=B++,A.opIds.xLock=B++,A.opIds.xOpen=B++,A.opIds.xRead=B++,A.opIds.xSleep=B++,A.opIds.xSync=B++,A.opIds.xTruncate=B++,A.opIds.xUnlock=B++,A.opIds.xWrite=B++,A.opIds.mkdir=B++,A.opIds["opfs-async-metrics"]=B++,A.opIds["opfs-async-shutdown"]=B++,A.opIds.retry=B++,A.sabOP=new SharedArrayBuffer(B*4),ne.metrics.reset()}A.sq3Codes=Object.create(null),["SQLITE_ACCESS_EXISTS","SQLITE_ACCESS_READWRITE","SQLITE_BUSY","SQLITE_CANTOPEN","SQLITE_ERROR","SQLITE_IOERR","SQLITE_IOERR_ACCESS","SQLITE_IOERR_CLOSE","SQLITE_IOERR_DELETE","SQLITE_IOERR_FSYNC","SQLITE_IOERR_LOCK","SQLITE_IOERR_READ","SQLITE_IOERR_SHORT_READ","SQLITE_IOERR_TRUNCATE","SQLITE_IOERR_UNLOCK","SQLITE_IOERR_WRITE","SQLITE_LOCK_EXCLUSIVE","SQLITE_LOCK_NONE","SQLITE_LOCK_PENDING","SQLITE_LOCK_RESERVED","SQLITE_LOCK_SHARED","SQLITE_LOCKED","SQLITE_MISUSE","SQLITE_NOTFOUND","SQLITE_OPEN_CREATE","SQLITE_OPEN_DELETEONCLOSE","SQLITE_OPEN_MAIN_DB","SQLITE_OPEN_READONLY"].forEach(B=>{(A.sq3Codes[B]=I[B])===void 0&&O("Maintenance required: not found:",B)}),A.opfsFlags=Object.assign(Object.create(null),{OPFS_UNLOCK_ASAP:1,OPFS_UNLINK_BEFORE_OPEN:2,defaultUnlockAsap:!1});const he=(B,...Y)=>{const te=A.opIds[B]||O("Invalid op ID:",B);A.s11n.serialize(...Y),Atomics.store(A.sabOPView,A.opIds.rc,-1),Atomics.store(A.sabOPView,A.opIds.whichOp,te),Atomics.notify(A.sabOPView,A.opIds.whichOp);const de=performance.now();for(;Atomics.wait(A.sabOPView,A.opIds.rc,-1)!=="not-equal";);const ce=Atomics.load(A.sabOPView,A.opIds.rc);if(Z[B].wait+=performance.now()-de,ce&&A.asyncS11nExceptions){const pe=A.s11n.deserialize();pe&&J(B+"() async error:",...pe)}return ce};ne.debug={asyncShutdown:()=>{P("Shutting down OPFS async listener. The OPFS VFS will no longer work."),he("opfs-async-shutdown")},asyncRestart:()=>{P("Attempting to restart OPFS VFS async listener. Might work, might not."),h.postMessage({type:"opfs-async-restart"})}};const be=()=>{if(A.s11n)return A.s11n;const B=new TextDecoder,Y=new TextEncoder("utf-8"),te=new Uint8Array(A.sabIO,A.sabS11nOffset,A.sabS11nSize),de=new DataView(A.sabIO,A.sabS11nOffset,A.sabS11nSize);A.s11n=Object.create(null);const ce=Object.create(null);ce.number={id:1,size:8,getter:"getFloat64",setter:"setFloat64"},ce.bigint={id:2,size:8,getter:"getBigInt64",setter:"setBigInt64"},ce.boolean={id:3,size:4,getter:"getInt32",setter:"setInt32"},ce.string={id:4};const pe=b=>ce[typeof b]||O("Maintenance required: this value type cannot be serialized.",b),X=b=>{switch(b){case ce.number.id:return ce.number;case ce.bigint.id:return ce.bigint;case ce.boolean.id:return ce.boolean;case ce.string.id:return ce.string;default:O("Invalid type ID:",b)}};return A.s11n.deserialize=function(b=!1){++Z.s11n.deserialize.count;const g=performance.now(),T=te[0],W=T?[]:null;if(T){const H=[];let ue=1,ge,Te,De;for(ge=0;ge<T;++ge,++ue)H.push(X(te[ue]));for(ge=0;ge<T;++ge){const Ht=H[ge];Ht.getter?(De=de[Ht.getter](ue,A.littleEndian),ue+=Ht.size):(Te=de.getInt32(ue,A.littleEndian),ue+=4,De=B.decode(te.slice(ue,ue+Te)),ue+=Te),W.push(De)}}return b&&(te[0]=0),Z.s11n.deserialize.time+=performance.now()-g,W},A.s11n.serialize=function(...b){const g=performance.now();if(++Z.s11n.serialize.count,b.length){const T=[];let W=0,H=1;for(te[0]=b.length&255;W<b.length;++W,++H)T.push(pe(b[W])),te[H]=T[W].id;for(W=0;W<b.length;++W){const ue=T[W];if(ue.setter)de[ue.setter](H,b[W],A.littleEndian),H+=ue.size;else{const ge=Y.encode(b[W]);de.setInt32(H,ge.byteLength,A.littleEndian),H+=4,te.set(ge,H),H+=ge.byteLength}}}else te[0]=0;Z.s11n.serialize.time+=performance.now()-g},A.s11n},Ae=function B(Y=16){B._chars||(B._chars="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012346789",B._n=B._chars.length);const te=[];let de=0;for(;de<Y;++de){const ce=Math.random()*(B._n*64)%B._n|0;te[de]=B._chars[ce]}return te.join("")},Ee=Object.create(null),ve=Object.create(null);ve.op=void 0,ve.start=void 0;const Ie=B=>{ve.start=performance.now(),ve.op=B,++Z[B].count},Le=()=>Z[ve.op].time+=performance.now()-ve.start,Qe={xCheckReservedLock:function(B,Y){return R.poke(Y,0,"i32"),0},xClose:function(B){Ie("xClose");let Y=0;const te=Ee[B];return te&&(delete Ee[B],Y=he("xClose",B),te.sq3File&&te.sq3File.dispose()),Le(),Y},xDeviceCharacteristics:function(B){return I.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(B,Y,te){return I.SQLITE_NOTFOUND},xFileSize:function(B,Y){Ie("xFileSize");let te=he("xFileSize",B);if(te==0)try{const de=A.s11n.deserialize()[0];R.poke(Y,de,"i64")}catch(de){J("Unexpected error reading xFileSize() result:",de),te=A.sq3Codes.SQLITE_IOERR}return Le(),te},xLock:function(B,Y){Ie("xLock");const te=Ee[B];let de=0;return te.lockType?te.lockType=Y:(de=he("xLock",B,Y),de===0&&(te.lockType=Y)),Le(),de},xRead:function(B,Y,te,de){Ie("xRead");const ce=Ee[B];let pe;try{pe=he("xRead",B,te,Number(de)),(pe===0||I.SQLITE_IOERR_SHORT_READ===pe)&&R.heap8u().set(ce.sabView.subarray(0,te),Y)}catch(X){J("xRead(",arguments,") failed:",X,ce),pe=I.SQLITE_IOERR_READ}return Le(),pe},xSync:function(B,Y){Ie("xSync"),++Z.xSync.count;const te=he("xSync",B,Y);return Le(),te},xTruncate:function(B,Y){Ie("xTruncate");const te=he("xTruncate",B,Number(Y));return Le(),te},xUnlock:function(B,Y){Ie("xUnlock");const te=Ee[B];let de=0;return I.SQLITE_LOCK_NONE===Y&&te.lockType&&(de=he("xUnlock",B,Y)),de===0&&(te.lockType=Y),Le(),de},xWrite:function(B,Y,te,de){Ie("xWrite");const ce=Ee[B];let pe;try{ce.sabView.set(R.heap8u().subarray(Y,Y+te)),pe=he("xWrite",B,te,Number(de))}catch(X){J("xWrite(",arguments,") failed:",X,ce),pe=I.SQLITE_IOERR_WRITE}return Le(),pe}},je={xAccess:function(B,Y,te,de){Ie("xAccess");const ce=he("xAccess",R.cstrToJs(Y));return R.poke(de,ce?0:1,"i32"),Le(),0},xCurrentTime:function(B,Y){return R.poke(Y,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(B,Y){return R.poke(Y,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(B,Y,te){Ie("xDelete");const de=he("xDelete",R.cstrToJs(Y),te,!1);return Le(),de},xFullPathname:function(B,Y,te,de){return R.cstrncpy(de,Y,te)<te?0:I.SQLITE_CANTOPEN},xGetLastError:function(B,Y,te){return P("OPFS xGetLastError() has nothing sensible to return."),0},xOpen:function(Y,te,de,ce,pe){Ie("xOpen");let X=0;te===0?te=Ae():R.isPtr(te)&&(I.sqlite3_uri_boolean(te,"opfs-unlock-asap",0)&&(X|=A.opfsFlags.OPFS_UNLOCK_ASAP),I.sqlite3_uri_boolean(te,"delete-before-open",0)&&(X|=A.opfsFlags.OPFS_UNLINK_BEFORE_OPEN),te=R.cstrToJs(te));const b=Object.create(null);b.fid=de,b.filename=te,b.sab=new SharedArrayBuffer(A.fileBufferSize),b.flags=ce,b.readOnly=!(n.SQLITE_OPEN_CREATE&ce)&&!!(ce&I.SQLITE_OPEN_READONLY);const g=he("xOpen",de,te,ce,X);return g||(b.readOnly&&R.poke(pe,I.SQLITE_OPEN_READONLY,"i32"),Ee[de]=b,b.sabView=A.sabFileBufView,b.sq3File=new F(de),b.sq3File.$pMethods=E.pointer,b.lockType=I.SQLITE_LOCK_NONE),Le(),g}};S&&(C.$xRandomness=S.$xRandomness,C.$xSleep=S.$xSleep),C.$xRandomness||(je.xRandomness=function(B,Y,te){const de=R.heap8u();let ce=0;for(;ce<Y;++ce)de[te+ce]=Math.random()*255e3&255;return ce}),C.$xSleep||(je.xSleep=function(B,Y){return Atomics.wait(A.sabOPView,A.opIds.xSleep,0,Y),0}),ne.getResolvedPath=function(B,Y){const te=new URL(B,"file://irrelevant").pathname;return Y?te.split("/").filter(de=>!!de):te},ne.getDirForFilename=async function(Y,te=!1){const de=ne.getResolvedPath(Y,!0),ce=de.pop();let pe=ne.rootDirectory;for(const X of de)X&&(pe=await pe.getDirectoryHandle(X,{create:!!te}));return[pe,ce]},ne.mkdir=async function(B){try{return await ne.getDirForFilename(B+"/filepart",!0),!0}catch{return!1}},ne.entryExists=async function(B){try{const[Y,te]=await ne.getDirForFilename(B);return await Y.getFileHandle(te),!0}catch{return!1}},ne.randomFilename=Ae,ne.treeList=async function(){const B=async function te(de,ce){ce.name=de.name,ce.dirs=[],ce.files=[];for await(const pe of de.values())if(pe.kind==="directory"){const X=Object.create(null);ce.dirs.push(X),await te(pe,X)}else ce.files.push(pe.name)},Y=Object.create(null);return await B(ne.rootDirectory,Y),Y},ne.rmfr=async function(){const B=ne.rootDirectory,Y={recurse:!0};for await(const te of B.values())B.removeEntry(te.name,Y)},ne.unlink=async function(B,Y=!1,te=!1){try{const[de,ce]=await ne.getDirForFilename(B,!1);return await de.removeEntry(ce,{recursive:Y}),!0}catch(de){if(te)throw new Error("unlink(",arguments[0],") failed: "+de.message,{cause:de});return!1}},ne.traverse=async function(B){const Y={recursive:!0,directory:ne.rootDirectory};typeof B=="function"&&(B={callback:B}),B=Object.assign(Y,B||{}),async function de(ce,pe){for await(const X of ce.values()){if(B.callback(X,ce,pe)===!1)return!1;if(B.recursive&&X.kind==="directory"&&await de(X,pe+1)===!1)break}}(B.directory,0)};const St=async function(B,Y){const[te,de]=await ne.getDirForFilename(B,!0);let pe=await(await te.getFileHandle(de,{create:!0})).createSyncAccessHandle(),X=0,b,g=!1;try{for(pe.truncate(0);(b=await Y())!==void 0;)b instanceof ArrayBuffer&&(b=new Uint8Array(b)),X===0&&b.byteLength>=15&&(D.affirmDbHeader(b),g=!0),pe.write(b,{at:X}),X+=b.byteLength;if((X<512||X%512!==0)&&O("Input size",X,"is not correct for an SQLite database."),!g){const T=new Uint8Array(20);pe.read(T,{at:0}),D.affirmDbHeader(T)}return pe.write(new Uint8Array([1,1]),{at:18}),X}catch(T){throw await pe.close(),pe=void 0,await te.removeEntry(de).catch(()=>{}),T}finally{pe&&await pe.close()}};if(ne.importDb=async function(B,Y){if(Y instanceof Function)return St(B,Y);Y instanceof ArrayBuffer&&(Y=new Uint8Array(Y)),D.affirmIsDb(Y);const te=Y.byteLength,[de,ce]=await ne.getDirForFilename(B,!0);let pe,X=0;try{return pe=await(await de.getFileHandle(ce,{create:!0})).createSyncAccessHandle(),pe.truncate(0),X=pe.write(Y,{at:0}),X!=te&&O("Expected to write "+te+" bytes but wrote "+X+"."),pe.write(new Uint8Array([1,1]),{at:18}),X}catch(b){throw pe&&(await pe.close(),pe=void 0),await de.removeEntry(ce).catch(()=>{}),b}finally{pe&&await pe.close()}},n.oo1){const B=function(...Y){const te=n.oo1.DB.dbCtorHelper.normalizeArgs(...Y);te.vfs=C.$zName,n.oo1.DB.dbCtorHelper.call(this,te)};B.prototype=Object.create(n.oo1.DB.prototype),n.oo1.OpfsDb=B,B.importDb=ne.importDb,n.oo1.DB.dbCtorHelper.setVfsPostOpenCallback(C.pointer,function(Y,te){te.capi.sqlite3_busy_timeout(Y,1e4)})}const nt=function(){const B=R.scopedAllocPush(),Y=new F;try{const te=Y.pointer,de=I.SQLITE_OPEN_CREATE|I.SQLITE_OPEN_READWRITE|I.SQLITE_OPEN_MAIN_DB,ce=R.scopedAlloc(8),pe="/sanity/check/file"+Ae(8),X=R.scopedAllocCString(pe);let b;if(A.s11n.serialize("This is  string."),b=A.s11n.deserialize(),U("deserialize() says:",b),b[0]!=="This is  string."&&O("String d13n error."),je.xAccess(C.pointer,X,0,ce),b=R.peek(ce,"i32"),U("xAccess(",pe,") exists ?=",b),b=je.xOpen(C.pointer,X,te,de,ce),U("open rc =",b,"state.sabOPView[xOpen] =",A.sabOPView[A.opIds.xOpen]),b!==0){J("open failed with code",b);return}je.xAccess(C.pointer,X,0,ce),b=R.peek(ce,"i32"),b||O("xAccess() failed to detect file."),b=Qe.xSync(Y.pointer,0),b&&O("sync failed w/ rc",b),b=Qe.xTruncate(Y.pointer,1024),b&&O("truncate failed w/ rc",b),R.poke(ce,0,"i64"),b=Qe.xFileSize(Y.pointer,ce),b&&O("xFileSize failed w/ rc",b),U("xFileSize says:",R.peek(ce,"i64")),b=Qe.xWrite(Y.pointer,X,10,1),b&&O("xWrite() failed!");const g=R.scopedAlloc(16);b=Qe.xRead(Y.pointer,g,6,2),R.poke(g+6,0);let T=R.cstrToJs(g);U("xRead() got:",T),T!=="sanity"&&O("Unexpected xRead() value."),je.xSleep&&(U("xSleep()ing before close()ing..."),je.xSleep(C.pointer,2e3),U("waking up from xSleep()")),b=Qe.xClose(te),U("xClose rc =",b,"sabOPView =",A.sabOPView),U("Deleting file:",pe),je.xDelete(C.pointer,X,4660),je.xAccess(C.pointer,X,0,ce),b=R.peek(ce,"i32"),b&&O("Expecting 0 from xAccess(",pe,") after xDelete()."),P("End of OPFS sanity checks.")}finally{Y.dispose(),R.scopedAllocPop(B)}};h.onmessage=function({data:B}){switch(B.type){case"opfs-unavailable":y(new Error(B.payload.join(" ")));break;case"opfs-async-loaded":h.postMessage({type:"opfs-async-init",args:A});break;case"opfs-async-inited":{if(ee===!0)break;try{n.vfs.installVfs({io:{struct:E,methods:Qe},vfs:{struct:C,methods:je}}),A.sabOPView=new Int32Array(A.sabOP),A.sabFileBufView=new Uint8Array(A.sabIO,0,A.fileBufferSize),A.sabS11nView=new Uint8Array(A.sabIO,A.sabS11nOffset,A.sabS11nSize),be(),c.sanityChecks&&(P("Running sanity checks because of opfs-sanity-check URL arg..."),nt()),p()?navigator.storage.getDirectory().then(Y=>{h.onerror=h._originalOnError,delete h._originalOnError,n.opfs=ne,ne.rootDirectory=Y,U("End of OPFS sqlite3_vfs setup.",C),q()}).catch(y):q()}catch(Y){J(Y),y(Y)}break}default:{const Y="Unexpected message from the OPFS async worker: "+JSON.stringify(B);J(Y),y(new Error(Y));break}}}}))};a.defaultProxyUri="sqlite3-opfs-async-proxy.js",globalThis.sqlite3ApiBootstrap.initializersAsync.push(async l=>{try{let c=a.defaultProxyUri;return l.scriptInfo.sqlite3Dir&&(a.defaultProxyUri=l.scriptInfo.sqlite3Dir+c),a().catch(u=>{l.config.warn("Ignoring inability to install OPFS sqlite3_vfs:",u.message)})}catch(c){return l.config.error("installOpfsVfs() exception:",c),Promise.reject(c)}})}),globalThis.sqlite3ApiBootstrap.initializers.push(function(n){var Ee,ve,Ie,Le,Qe,je,St,nt,B,Y,te,de,fo,pe;const a=n.util.toss,l=n.util.toss3,c=Object.create(null),u=n.capi,w=n.util,k=n.wasm,Q=4096,z=512,ie=4,oe=8,U=z+ie,P=z,J=U,O=Q,I=u.SQLITE_OPEN_MAIN_DB|u.SQLITE_OPEN_MAIN_JOURNAL|u.SQLITE_OPEN_SUPER_JOURNAL|u.SQLITE_OPEN_WAL,D=".opaque",R=()=>Math.random().toString(36).slice(2),$=new TextDecoder,F=new TextEncoder,K=Object.assign(Object.create(null),{name:"opfs-sahpool",directory:void 0,initialCapacity:6,clearOnInit:!1,verbosity:2,forceReinitIfPreviouslyFailed:!1}),ne=[n.config.error,n.config.warn,n.config.log];n.config.log;const p=n.config.warn;n.config.error;const E=new Map,C=X=>E.get(X),ee=(X,b)=>{b?E.set(X,b):E.delete(X)},y=new Map,q=X=>y.get(X),h=(X,b)=>{b?y.set(X,b):y.delete(X)},_={xCheckReservedLock:function(X,b){const g=q(X);return g.log("xCheckReservedLock"),g.storeErr(),k.poke32(b,1),0},xClose:function(X){const b=q(X);b.storeErr();const g=b.getOFileForS3File(X);if(g)try{b.log(`xClose ${g.path}`),b.mapS3FileToOFile(X,!1),g.sah.flush(),g.flags&u.SQLITE_OPEN_DELETEONCLOSE&&b.deletePath(g.path)}catch(T){return b.storeErr(T,u.SQLITE_IOERR)}return 0},xDeviceCharacteristics:function(X){return u.SQLITE_IOCAP_UNDELETABLE_WHEN_OPEN},xFileControl:function(X,b,g){return u.SQLITE_NOTFOUND},xFileSize:function(X,b){const g=q(X);g.log("xFileSize");const W=g.getOFileForS3File(X).sah.getSize()-O;return k.poke64(b,BigInt(W)),0},xLock:function(X,b){const g=q(X);g.log(`xLock ${b}`),g.storeErr();const T=g.getOFileForS3File(X);return T.lockType=b,0},xRead:function(X,b,g,T){const W=q(X);W.storeErr();const H=W.getOFileForS3File(X);W.log(`xRead ${H.path} ${g} @ ${T}`);try{const ue=H.sah.read(k.heap8u().subarray(b,b+g),{at:O+Number(T)});return ue<g?(k.heap8u().fill(0,b+ue,b+g),u.SQLITE_IOERR_SHORT_READ):0}catch(ue){return W.storeErr(ue,u.SQLITE_IOERR)}},xSectorSize:function(X){return Q},xSync:function(X,b){const g=q(X);g.log(`xSync ${b}`),g.storeErr();const T=g.getOFileForS3File(X);try{return T.sah.flush(),0}catch(W){return g.storeErr(W,u.SQLITE_IOERR)}},xTruncate:function(X,b){const g=q(X);g.log(`xTruncate ${b}`),g.storeErr();const T=g.getOFileForS3File(X);try{return T.sah.truncate(O+Number(b)),0}catch(W){return g.storeErr(W,u.SQLITE_IOERR)}},xUnlock:function(X,b){const g=q(X);g.log("xUnlock");const T=g.getOFileForS3File(X);return T.lockType=b,0},xWrite:function(X,b,g,T){const W=q(X);W.storeErr();const H=W.getOFileForS3File(X);W.log(`xWrite ${H.path} ${g} ${T}`);try{const ue=H.sah.write(k.heap8u().subarray(b,b+g),{at:O+Number(T)});return g===ue?0:a("Unknown write() failure.")}catch(ue){return W.storeErr(ue,u.SQLITE_IOERR)}}},S=new u.sqlite3_io_methods;S.$iVersion=1,n.vfs.installVfs({io:{struct:S,methods:_}});const A={xAccess:function(X,b,g,T){const W=C(X);W.storeErr();try{const H=W.getPath(b);k.poke32(T,W.hasFilename(H)?1:0)}catch{k.poke32(T,0)}return 0},xCurrentTime:function(X,b){return k.poke(b,24405875e-1+new Date().getTime()/864e5,"double"),0},xCurrentTimeInt64:function(X,b){return k.poke(b,24405875e-1*864e5+new Date().getTime(),"i64"),0},xDelete:function(X,b,g){const T=C(X);T.log(`xDelete ${k.cstrToJs(b)}`),T.storeErr();try{return T.deletePath(T.getPath(b)),0}catch(W){return T.storeErr(W),u.SQLITE_IOERR_DELETE}},xFullPathname:function(X,b,g,T){return k.cstrncpy(T,b,g)<g?0:u.SQLITE_CANTOPEN},xGetLastError:function(X,b,g){const T=C(X),W=T.popErr();if(T.log(`xGetLastError ${b} e =`,W),W){const H=k.scopedAllocPush();try{const[ue,ge]=k.scopedAllocCString(W.message,!0);k.cstrncpy(g,ue,b),ge>b&&k.poke8(g+b-1,0)}catch{return u.SQLITE_NOMEM}finally{k.scopedAllocPop(H)}}return W?W.sqlite3Rc||u.SQLITE_IOERR:0},xOpen:function(b,g,T,W,H){const ue=C(b);try{ue.log(`xOpen ${k.cstrToJs(g)} ${W}`);const ge=g&&k.peek8(g)?ue.getPath(g):R();let Te=ue.getSAHForPath(ge);!Te&&W&u.SQLITE_OPEN_CREATE&&(ue.getFileCount()<ue.getCapacity()?(Te=ue.nextAvailableSAH(),ue.setAssociatedPath(Te,ge,W)):a("SAH pool is full. Cannot create file",ge)),Te||a("file not found:",ge);const De={path:ge,flags:W,sah:Te};ue.mapS3FileToOFile(T,De),De.lockType=u.SQLITE_LOCK_NONE;const Ht=new u.sqlite3_file(T);return Ht.$pMethods=S.pointer,Ht.dispose(),k.poke32(H,W),0}catch(ge){return ue.storeErr(ge),u.SQLITE_CANTOPEN}}},Z=function(X){n.capi.sqlite3_vfs_find(X)&&l("VFS name is already registered:",X);const b=new u.sqlite3_vfs,g=u.sqlite3_vfs_find(null),T=g?new u.sqlite3_vfs(g):null;return b.$iVersion=2,b.$szOsFile=u.sqlite3_file.structInfo.sizeof,b.$mxPathname=z,b.addOnDispose(b.$zName=k.allocCString(X),()=>ee(b.pointer,0)),T&&(b.$xRandomness=T.$xRandomness,b.$xSleep=T.$xSleep,T.dispose()),!b.$xRandomness&&!A.xRandomness&&(A.xRandomness=function(W,H,ue){const ge=k.heap8u();let Te=0;for(;Te<H;++Te)ge[ue+Te]=Math.random()*255e3&255;return Te}),!b.$xSleep&&!A.xSleep&&(A.xSleep=(W,H)=>0),n.vfs.installVfs({vfs:{struct:b,methods:A}}),b};class he{constructor(b=Object.create(null)){V(this,de);et(this,"vfsDir");V(this,Ee);V(this,ve);V(this,Ie);V(this,Le,new Map);V(this,Qe,new Map);V(this,je,new Set);V(this,St,new Map);V(this,nt,new Uint8Array(U));V(this,B);V(this,Y);V(this,te);G(this,te,b.verbosity??K.verbosity),this.vfsName=b.name||K.name,G(this,Y,Z(this.vfsName)),ee(s(this,Y).pointer,this),this.vfsDir=b.directory||"."+this.vfsName,G(this,B,new DataView(s(this,nt).buffer,s(this,nt).byteOffset)),this.isReady=this.reset(!!(b.clearOnInit??K.clearOnInit)).then(()=>{if(this.$error)throw this.$error;return this.getCapacity()?Promise.resolve(void 0):this.addCapacity(b.initialCapacity||K.initialCapacity)})}log(...b){me(this,de,fo).call(this,2,...b)}warn(...b){me(this,de,fo).call(this,1,...b)}error(...b){me(this,de,fo).call(this,0,...b)}getVfs(){return s(this,Y)}getCapacity(){return s(this,Le).size}getFileCount(){return s(this,Qe).size}getFileNames(){const b=[],g=s(this,Qe).keys();for(const T of g)b.push(T);return b}async addCapacity(b){for(let g=0;g<b;++g){const T=R(),H=await(await s(this,ve).getFileHandle(T,{create:!0})).createSyncAccessHandle();s(this,Le).set(H,T),this.setAssociatedPath(H,"",0)}return this.getCapacity()}async reduceCapacity(b){let g=0;for(const T of Array.from(s(this,je))){if(g===b||this.getFileCount()===this.getCapacity())break;const W=s(this,Le).get(T);T.close(),await s(this,ve).removeEntry(W),s(this,Le).delete(T),s(this,je).delete(T),++g}return g}releaseAccessHandles(){for(const b of s(this,Le).keys())b.close();s(this,Le).clear(),s(this,Qe).clear(),s(this,je).clear()}async acquireAccessHandles(b){const g=[];for await(const[T,W]of s(this,ve))W.kind==="file"&&g.push([T,W]);return Promise.all(g.map(async([T,W])=>{try{const H=await W.createSyncAccessHandle();if(s(this,Le).set(H,T),b)H.truncate(O),this.setAssociatedPath(H,"",0);else{const ue=this.getAssociatedPath(H);ue?s(this,Qe).set(ue,H):s(this,je).add(H)}}catch(H){throw this.storeErr(H),this.releaseAccessHandles(),H}}))}getAssociatedPath(b){b.read(s(this,nt),{at:0});const g=s(this,B).getUint32(P);if(s(this,nt)[0]&&(g&u.SQLITE_OPEN_DELETEONCLOSE||!(g&I)))return p(`Removing file with unexpected flags ${g.toString(16)}`,s(this,nt)),this.setAssociatedPath(b,"",0),"";const T=new Uint32Array(oe/4);b.read(T,{at:J});const W=this.computeDigest(s(this,nt));if(T.every((H,ue)=>H===W[ue])){const H=s(this,nt).findIndex(ue=>ue===0);return H===0&&b.truncate(O),H?$.decode(s(this,nt).subarray(0,H)):""}else return p("Disassociating file with bad digest."),this.setAssociatedPath(b,"",0),""}setAssociatedPath(b,g,T){const W=F.encodeInto(g,s(this,nt));z<=W.written+1&&a("Path too long:",g),s(this,nt).fill(0,W.written,z),s(this,B).setUint32(P,T);const H=this.computeDigest(s(this,nt));b.write(s(this,nt),{at:0}),b.write(H,{at:J}),b.flush(),g?(s(this,Qe).set(g,b),s(this,je).delete(b)):(b.truncate(O),s(this,je).add(b))}computeDigest(b){let g=3735928559,T=1103547991;for(const W of b)g=31*g+W*307,T=31*T+W*307;return new Uint32Array([g>>>0,T>>>0])}async reset(b){await this.isReady;let g=await navigator.storage.getDirectory(),T;for(const W of this.vfsDir.split("/"))W&&(T=g,g=await g.getDirectoryHandle(W,{create:!0}));return G(this,Ee,g),G(this,Ie,T),G(this,ve,await s(this,Ee).getDirectoryHandle(D,{create:!0})),this.releaseAccessHandles(),this.acquireAccessHandles(b)}getPath(b){return k.isPtr(b)&&(b=k.cstrToJs(b)),(b instanceof URL?b:new URL(b,"file://localhost/")).pathname}deletePath(b){const g=s(this,Qe).get(b);return g&&(s(this,Qe).delete(b),this.setAssociatedPath(g,"",0)),!!g}storeErr(b,g){return b&&(b.sqlite3Rc=g||u.SQLITE_IOERR,this.error(b)),this.$error=b,g}popErr(){const b=this.$error;return this.$error=void 0,b}nextAvailableSAH(){const[b]=s(this,je).keys();return b}getOFileForS3File(b){return s(this,St).get(b)}mapS3FileToOFile(b,g){g?(s(this,St).set(b,g),h(b,this)):(s(this,St).delete(b),h(b,!1))}hasFilename(b){return s(this,Qe).has(b)}getSAHForPath(b){return s(this,Qe).get(b)}async removeVfs(){if(!s(this,Y).pointer||!s(this,ve))return!1;u.sqlite3_vfs_unregister(s(this,Y).pointer),s(this,Y).dispose(),delete c[this.vfsName];try{this.releaseAccessHandles(),await s(this,Ee).removeEntry(D,{recursive:!0}),G(this,ve,void 0),await s(this,Ie).removeEntry(s(this,Ee).name,{recursive:!0}),G(this,Ee,G(this,Ie,void 0))}catch(b){n.config.error(this.vfsName,"removeVfs() failed:",b)}return!0}exportFile(b){const g=s(this,Qe).get(b)||a("File not found:",b),T=g.getSize()-O,W=new Uint8Array(T>0?T:0);if(T>0){const H=g.read(W,{at:O});H!=T&&a("Expected to read "+T+" bytes but read "+H+".")}return W}async importDbChunked(b,g){const T=s(this,Qe).get(b)||this.nextAvailableSAH()||a("No available handles to import to.");T.truncate(0);let W=0,H,ue=!1;try{for(;(H=await g())!==void 0;)H instanceof ArrayBuffer&&(H=new Uint8Array(H)),W===0&&H.byteLength>=15&&(w.affirmDbHeader(H),ue=!0),T.write(H,{at:O+W}),W+=H.byteLength;if((W<512||W%512!==0)&&a("Input size",W,"is not correct for an SQLite database."),!ue){const ge=new Uint8Array(20);T.read(ge,{at:0}),w.affirmDbHeader(ge)}T.write(new Uint8Array([1,1]),{at:O+18})}catch(ge){throw this.setAssociatedPath(T,"",0),ge}return this.setAssociatedPath(T,b,u.SQLITE_OPEN_MAIN_DB),W}importDb(b,g){if(g instanceof ArrayBuffer)g=new Uint8Array(g);else if(g instanceof Function)return this.importDbChunked(b,g);const T=s(this,Qe).get(b)||this.nextAvailableSAH()||a("No available handles to import to."),W=g.byteLength;(W<512||W%512!=0)&&a("Byte array size is invalid for an SQLite db.");const H="SQLite format 3";for(let ge=0;ge<H.length;++ge)H.charCodeAt(ge)!==g[ge]&&a("Input does not contain an SQLite database header.");const ue=T.write(g,{at:O});return ue!=W?(this.setAssociatedPath(T,"",0),a("Expected to write "+W+" bytes but wrote "+ue+".")):(T.write(new Uint8Array([1,1]),{at:O+18}),this.setAssociatedPath(T,b,u.SQLITE_OPEN_MAIN_DB)),ue}}Ee=new WeakMap,ve=new WeakMap,Ie=new WeakMap,Le=new WeakMap,Qe=new WeakMap,je=new WeakMap,St=new WeakMap,nt=new WeakMap,B=new WeakMap,Y=new WeakMap,te=new WeakMap,de=new WeakSet,fo=function(b,...g){s(this,te)>b&&ne[b](this.vfsName+":",...g)};class be{constructor(b){V(this,pe);G(this,pe,b),this.vfsName=b.vfsName}async addCapacity(b){return s(this,pe).addCapacity(b)}async reduceCapacity(b){return s(this,pe).reduceCapacity(b)}getCapacity(){return s(this,pe).getCapacity(s(this,pe))}getFileCount(){return s(this,pe).getFileCount()}getFileNames(){return s(this,pe).getFileNames()}async reserveMinimumCapacity(b){const g=s(this,pe).getCapacity();return g<b?s(this,pe).addCapacity(b-g):g}exportFile(b){return s(this,pe).exportFile(b)}importDb(b,g){return s(this,pe).importDb(b,g)}async wipeFiles(){return s(this,pe).reset(!0)}unlink(b){return s(this,pe).deletePath(b)}async removeVfs(){return s(this,pe).removeVfs()}}pe=new WeakMap;const Ae=async()=>{const X=await navigator.storage.getDirectory(),b=".opfs-sahpool-sync-check-"+R(),W=(await(await X.getFileHandle(b,{create:!0})).createSyncAccessHandle()).close();return await W,await X.removeEntry(b),W!=null&&W.then&&a("The local OPFS API is too old for opfs-sahpool:","it has an async FileSystemSyncAccessHandle.close() method."),!0};n.installOpfsSAHPoolVfs=async function(X=Object.create(null)){var g;X=Object.assign(Object.create(null),K,X||{});const b=X.name;if(X.$testThrowPhase1)throw X.$testThrowPhase1;if(c[b])try{return await c[b]}catch(T){if(X.forceReinitIfPreviouslyFailed)delete c[b];else throw T}return!globalThis.FileSystemHandle||!globalThis.FileSystemDirectoryHandle||!globalThis.FileSystemFileHandle||!globalThis.FileSystemFileHandle.prototype.createSyncAccessHandle||!((g=navigator==null?void 0:navigator.storage)!=null&&g.getDirectory)?c[b]=Promise.reject(new Error("Missing required OPFS APIs.")):c[b]=Ae().then(async function(){if(X.$testThrowPhase2)throw X.$testThrowPhase2;const T=new he(X);return T.isReady.then(async()=>{const W=new be(T);if(n.oo1){const H=n.oo1,ue=T.getVfs(),ge=function(...Te){const De=H.DB.dbCtorHelper.normalizeArgs(...Te);De.vfs=ue.$zName,H.DB.dbCtorHelper.call(this,De)};ge.prototype=Object.create(H.DB.prototype),W.OpfsSAHPoolDb=ge}return T.log("VFS initialized."),W}).catch(async W=>{throw await T.removeVfs().catch(()=>{}),W})}).catch(T=>c[b]=Promise.reject(T))}}),typeof o<"u"){const n=Object.assign(Object.create(null),{exports:typeof N>"u"?o.asm:N,memory:o.wasmMemory},globalThis.sqlite3ApiConfig||{});globalThis.sqlite3ApiConfig=n;let a;try{a=globalThis.sqlite3ApiBootstrap()}catch(l){throw console.error("sqlite3ApiBootstrap() error:",l),l}finally{delete globalThis.sqlite3ApiBootstrap,delete globalThis.sqlite3ApiConfig}o.sqlite3=a}else console.warn("This is not running in an Emscripten module context, so","globalThis.sqlite3ApiBootstrap() is _not_ being called due to lack","of config info for the WASM environment.","It must be called manually.")},t=L,t}})();const Sf=function(){var t,o;const i=ju;if(!i)throw new Error("Expecting globalThis.sqlite3InitModule to be defined by the Emscripten build.");const e=globalThis.sqlite3InitModuleState=Object.assign(Object.create(null),{moduleScript:(t=globalThis==null?void 0:globalThis.document)==null?void 0:t.currentScript,isWorker:typeof WorkerGlobalScope<"u",location:globalThis.location,urlParams:(o=globalThis==null?void 0:globalThis.location)!=null&&o.href?new URL(globalThis.location.href).searchParams:new URLSearchParams});if(e.debugModule=e.urlParams.has("sqlite3.debugModule")?(...m)=>console.warn("sqlite3.debugModule:",...m):()=>{},e.urlParams.has("sqlite3.dir"))e.sqlite3Dir=e.urlParams.get("sqlite3.dir")+"/";else if(e.moduleScript){const m=e.moduleScript.src.split("/");m.pop(),e.sqlite3Dir=m.join("/")+"/"}if(globalThis.sqlite3InitModule=function m(...M){return i(...M).then(L=>{L.runSQLite3PostLoadInit(L);const _e=L.sqlite3;_e.scriptInfo=e,m.__isUnderTest&&(_e.__isUnderTest=!0);const ke=_e.asyncPostInit;return delete _e.asyncPostInit,ke()}).catch(L=>{throw console.error("Exception loading sqlite3 module:",L),L})},globalThis.sqlite3InitModule.ready=i.ready,globalThis.sqlite3InitModuleState.moduleScript){const m=globalThis.sqlite3InitModuleState;let M=m.moduleScript.src.split("/");M.pop(),m.scriptDir=M.join("/")+"/"}return e.debugModule("sqlite3InitModuleState =",e),globalThis.sqlite3InitModule}();ju=Sf;globalThis.sqlite3Worker1Promiser=function i(e=i.defaultConfig){if(arguments.length===1&&typeof arguments[0]=="function"){const le=e;e=Object.assign(Object.create(null),i.defaultConfig),e.onready=le}else e=Object.assign(Object.create(null),i.defaultConfig,e);const t=Object.create(null),o=function(){},m=e.onerror||o,M=e.debug||o,L=e.generateMessageId?void 0:Object.create(null),_e=e.generateMessageId||function(le){return le.type+"#"+(L[le.type]=(L[le.type]||0)+1)},ke=(...le)=>{throw new Error(le.join(" "))};e.worker||(e.worker=i.defaultConfig.worker),typeof e.worker=="function"&&(e.worker=e.worker());let se,xe;return e.worker.onmessage=function(le){le=le.data,M("worker1.onmessage",le);let Se=t[le.messageId];if(!Se){if(le&&le.type==="sqlite3-api"&&le.result==="worker1-ready"){e.onready&&e.onready(xe);return}if(Se=t[le.type],Se&&Se.onrow){Se.onrow(le);return}e.onunhandled?e.onunhandled(arguments[0]):m("sqlite3Worker1Promiser() unhandled worker message:",le);return}switch(delete t[le.messageId],le.type){case"error":Se.reject(le);return;case"open":se||(se=le.dbId);break;case"close":le.dbId===se&&(se=void 0);break}try{Se.resolve(le)}catch(ut){Se.reject(ut)}},xe=function(){let le;arguments.length===1?le=arguments[0]:arguments.length===2?(le=Object.create(null),le.type=arguments[0],le.args=arguments[1],le.dbId=le.args.dbId):ke("Invalid arguments for sqlite3Worker1Promiser()-created factory."),!le.dbId&&le.type!=="open"&&(le.dbId=se),le.messageId=_e(le),le.departureTime=performance.now();const Se=Object.create(null);Se.message=le;let ut;le.type==="exec"&&le.args&&(typeof le.args.callback=="function"?(ut=le.messageId+":row",Se.onrow=le.args.callback,le.args.callback=ut,t[ut]=Se):typeof le.args.callback=="string"&&ke("exec callback may not be a string when using the Promise interface."));let Qt=new Promise(function(gt,Ue){Se.resolve=gt,Se.reject=Ue,t[le.messageId]=Se,M("Posting",le.type,"message to Worker dbId="+(se||"default")+":",le),e.worker.postMessage(le)});return ut&&(Qt=Qt.finally(()=>delete t[ut])),Qt}};globalThis.sqlite3Worker1Promiser.defaultConfig={worker:function(){return new Worker(new URL("/docs/assets/sqlite3-worker1-bundler-friendly-CZDPUhcf.js",import.meta.url),{type:"module"})},onerror:(...i)=>console.error("worker1 promiser error",...i)};sqlite3Worker1Promiser.v2=(function(i){let e;typeof i=="function"?(e=i,i={}):typeof(i==null?void 0:i.onready)=="function"&&(e=i.onready,delete i.onready);const t=Object.create(null);i=Object.assign(i||Object.create(null),{onready:async function(m){try{e&&await e(m),t.resolve(m)}catch(M){t.reject(M)}}});const o=new Promise(function(m,M){t.resolve=m,t.reject=M});try{this.original(i)}catch(m){t.reject(m)}return o}).bind({original:sqlite3Worker1Promiser});sqlite3Worker1Promiser.v2;function Af(i){const e=globalThis.sqlite3Worker1Promiser.v2({worker:i});return Cf(e)}function bs(i){if(i.type==="error")throw new cl("main","Unexpected response");return i}function Of([i,e]){if(!i)throw new cl("main","you passed 0 args lol");if(typeof i=="string")return e||(e={}),{params:[i,e],messageType:i};if(typeof i=="object"){let t;return Array.isArray(e)?t={transfer:e}:t=e,{params:[i],transfers:t,messageType:i.type}}throw new cl("main",`invalid arguments [${i}, ${e}]`)}function Cf(i){const e=new xf,t=new Map;return async function(m,M){const{messageType:L,params:_e,transfers:ke}=Of([m,M]);e.set(L);const se=e.get(L),xe=`${L}#${se}`;return ke&&t.set(xe,ke),i.then(le=>le(..._e))}}async function If(i,e){let t;return e?t=await i(e).then(bs).then(o=>Sa(o.dbId)[0]):t=await i("open").then(bs).then(o=>Sa(o.dbId)[0]),{db:t,close(){return i({type:"close",dbId:t})},query(o,m,M){return i({type:"exec",dbId:t,args:{rowMode:"object",sql:m,bind:M??[]}}).then(bs).then(L=>{const[_e]=Sa(L.result.resultRows),ke=BigInt(_e.length);let se={rows:_e};return o||(se={...se,numAffectedRows:ke}),se})}}}class Tf extends kf{constructor(e,t){super(async()=>{const o=await If(t,e);return{db:o,close:()=>o.close(),query:qf({all:async(m,M)=>{const L=await t("exec",{sql:m,bind:M,rowMode:"object"});return bs(L).result.resultRows??[]},run:async()=>{var L;const m=await t("exec",{sql:"SELECT last_insert_rowid()"}).then(bs);return{insertId:BigInt(((L=m.result.resultRows)==null?void 0:L.at(0))??0)}}})}})}}function Ff(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Vu={},Ia,Nc;function Pf(){if(Nc)return Ia;Nc=1,Ia=i;function i(t){if(t)return e(t)}function e(t){for(var o in i.prototype)t[o]=i.prototype[o];return t}return i.prototype.on=i.prototype.addEventListener=function(t,o){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(o),this},i.prototype.once=function(t,o){var m=this;this._callbacks=this._callbacks||{};function M(){m.off(t,M),o.apply(this,arguments)}return M.fn=o,this.on(t,M),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,o){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var m=this._callbacks[t];if(!m)return this;if(arguments.length==1)return delete this._callbacks[t],this;for(var M,L=0;L<m.length;L++)if(M=m[L],M===o||M.fn===o){m.splice(L,1);break}return this},i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var o=[].slice.call(arguments,1),m=this._callbacks[t];if(m){m=m.slice(0);for(var M=0,L=m.length;M<L;++M)m[M].apply(this,o)}return this},i.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]},i.prototype.hasListeners=function(t){return!!this.listeners(t).length},Ia}var Ta,qc;function Lf(){if(qc)return Ta;qc=1;var i=Pf();function e(){i.call(this)}return e.prototype=new i,Ta=e,e.Stream=e,e.prototype.pipe=function(t,o){var m=this;function M(Se){t.writable&&t.write(Se)===!1&&m.pause&&m.pause()}m.on("data",M);function L(){m.readable&&m.resume&&m.resume()}t.on("drain",L),!t._isStdio&&(!o||o.end!==!1)&&(m.on("end",ke),m.on("close",se));var _e=!1;function ke(){_e||(_e=!0,t.end())}function se(){_e||(_e=!0,typeof t.destroy=="function"&&t.destroy())}function xe(Se){if(le(),!this.hasListeners("error"))throw Se}m.on("error",xe),t.on("error",xe);function le(){m.off("data",M),t.off("drain",L),m.off("end",ke),m.off("close",se),m.off("error",xe),t.off("error",xe),m.off("end",le),m.off("close",le),t.off("end",le),t.off("close",le)}return m.on("end",le),m.on("close",le),t.on("end",le),t.on("close",le),t.emit("pipe",m),t},Ta}(function(i){var e={};(function(t){var o=typeof process=="object"&&e?e:self;t.parser=function(j){return new ut(j)},t.CParser=ut,t.CStream=gt,t.createStream=Qt,t.MAX_BUFFER_LENGTH=64*1024,t.DEBUG=o.CDEBUG==="debug",t.INFO=o.CDEBUG==="debug"||o.CDEBUG==="info",t.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var m={textNode:void 0,numberNode:""},M=t.EVENTS.filter(function(j){return j!=="error"&&j!=="end"}),L=0,_e;t.STATE={BEGIN:L++,VALUE:L++,OPEN_OBJECT:L++,CLOSE_OBJECT:L++,OPEN_ARRAY:L++,CLOSE_ARRAY:L++,TEXT_ESCAPE:L++,STRING:L++,BACKSLASH:L++,END:L++,OPEN_KEY:L++,CLOSE_KEY:L++,TRUE:L++,TRUE2:L++,TRUE3:L++,FALSE:L++,FALSE2:L++,FALSE3:L++,FALSE4:L++,NULL:L++,NULL2:L++,NULL3:L++,NUMBER_DECIMAL_POINT:L++,NUMBER_DIGIT:L++};for(var ke in t.STATE)t.STATE[t.STATE[ke]]=ke;L=t.STATE;const se={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(j){function x(){this.__proto__=j}return x.prototype=j,new x}),Object.getPrototypeOf||(Object.getPrototypeOf=function(j){return j.__proto__}),Object.keys||(Object.keys=function(j){var x=[];for(var we in j)j.hasOwnProperty(we)&&x.push(we);return x});function xe(j){var x=Math.max(t.MAX_BUFFER_LENGTH,10),we=0;for(var re in m){var xt=j[re]===void 0?0:j[re].length;if(xt>x)switch(re){case"text":closeText(j);break;default:Pe(j,"Max buffer length exceeded: "+re)}we=Math.max(we,xt)}j.bufferCheckPosition=t.MAX_BUFFER_LENGTH-we+j.position}function le(j){for(var x in m)j[x]=m[x]}var Se=/[\\"\n]/g;function ut(j){if(!(this instanceof ut))return new ut(j);var x=this;le(x),x.bufferCheckPosition=t.MAX_BUFFER_LENGTH,x.q=x.c=x.p="",x.opt=j||{},x.closed=x.closedRoot=x.sawRoot=!1,x.tag=x.error=null,x.state=L.BEGIN,x.stack=new Array,x.position=x.column=0,x.line=1,x.slashed=!1,x.unicodeI=0,x.unicodeS=null,x.depth=0,Ue(x,"onready")}ut.prototype={end:function(){Mi(this)},write:We,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{_e=Lf().Stream}catch{_e=function(){}}function Qt(j){return new gt(j)}function gt(j){if(!(this instanceof gt))return new gt(j);this._parser=new ut(j),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var x=this;_e.apply(x),this._parser.onend=function(){x.emit("end")},this._parser.onerror=function(we){x.emit("error",we),x._parser.error=null},M.forEach(function(we){Object.defineProperty(x,"on"+we,{get:function(){return x._parser["on"+we]},set:function(re){if(!re)return x.removeAllListeners(we),x._parser["on"+we]=re,re;x.on(we,re)},enumerable:!0,configurable:!1})})}gt.prototype=Object.create(_e.prototype,{constructor:{value:gt}}),gt.prototype.write=function(j){j=new Buffer(j);for(var x=0;x<j.length;x++){var we=j[x];if(this.bytes_remaining>0){for(var re=0;re<this.bytes_remaining;re++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+re]=j[re];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,x=x+re-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&we>=128)if(we>=194&&we<=223&&(this.bytes_in_sequence=2),we>=224&&we<=239&&(this.bytes_in_sequence=3),we>=240&&we<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+x>j.length){for(var xt=0;xt<=j.length-1-x;xt++)this.temp_buffs[this.bytes_in_sequence][xt]=j[x+xt];return this.bytes_remaining=x+this.bytes_in_sequence-j.length,!0}else{this.string=j.slice(x,x+this.bytes_in_sequence).toString(),x=x+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var ai=x;ai<j.length&&!(j[ai]>=128);ai++);this.string=j.slice(x,ai).toString(),this._parser.write(this.string),this.emit("data",this.string),x=ai-1}},gt.prototype.end=function(j){return j&&j.length&&this._parser.write(j.toString()),this._parser.end(),!0},gt.prototype.on=function(j,x){var we=this;return!we._parser["on"+j]&&M.indexOf(j)!==-1&&(we._parser["on"+j]=function(){var re=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);re.splice(0,0,j),we.emit.apply(we,re)}),_e.prototype.on.call(we,j,x)},gt.prototype.destroy=function(){le(this._parser),this.emit("close")};function Ue(j,x,we){t.INFO&&console.log("-- emit",x,we),j[x]&&j[x](we)}function zt(j,x,we){oi(j),Ue(j,x,we)}function oi(j,x){j.textNode=to(j.opt,j.textNode),j.textNode!==void 0&&Ue(j,x||"onvalue",j.textNode),j.textNode=void 0}function Bi(j){j.numberNode&&Ue(j,"onvalue",parseFloat(j.numberNode)),j.numberNode=""}function to(j,x){return x===void 0||(j.trim&&(x=x.trim()),j.normalize&&(x=x.replace(/\s+/g," "))),x}function Pe(j,x){return oi(j),x+=`
Line: `+j.line+`
Column: `+j.column+`
Char: `+j.c,x=new Error(x),j.error=x,Ue(j,"onerror",x),j}function Mi(j){return(j.state!==L.VALUE||j.depth!==0)&&Pe(j,"Unexpected end"),oi(j),j.c="",j.closed=!0,Ue(j,"onend"),ut.call(j,j.opt),j}function di(j){return j===se.carriageReturn||j===se.lineFeed||j===se.space||j===se.tab}function We(j){var x=this;if(this.error)throw this.error;if(x.closed)return Pe(x,"Cannot write after close. Assign an onready handler.");if(j===null)return Mi(x);var we=0,re=j.charCodeAt(0),xt=x.p,ai=!1;for(t.DEBUG&&console.log("write -> ["+j+"]");re&&(xt=re,x.c=re=j.charCodeAt(we++),xt!==re?x.p=xt:xt=x.p,!!re);)switch(t.DEBUG&&console.log(we,re,t.STATE[x.state]),ai?ai=!1:(x.position++,re===se.lineFeed?(x.line++,x.column=0):x.column++),x.state){case L.BEGIN:re===se.openBrace?x.state=L.OPEN_OBJECT:re===se.openBracket?x.state=L.OPEN_ARRAY:di(re)||Pe(x,"Non-whitespace before {[.");continue;case L.OPEN_KEY:case L.OPEN_OBJECT:if(di(re))continue;if(x.state===L.OPEN_KEY)x.stack.push(L.CLOSE_KEY);else if(re===se.closeBrace){Ue(x,"onopenobject"),this.depth++,Ue(x,"oncloseobject"),this.depth--,x.state=x.stack.pop()||L.VALUE;continue}else x.stack.push(L.CLOSE_OBJECT);re===se.doubleQuote?x.state=L.STRING:Pe(x,'Malformed object key should start with "');continue;case L.CLOSE_KEY:case L.CLOSE_OBJECT:if(di(re))continue;x.state,L.CLOSE_KEY,re===se.colon?(x.state===L.CLOSE_OBJECT?(x.stack.push(L.CLOSE_OBJECT),oi(x,"onopenobject"),this.depth++):oi(x,"onkey"),x.state=L.VALUE):re===se.closeBrace?(zt(x,"oncloseobject"),this.depth--,x.state=x.stack.pop()||L.VALUE):re===se.comma?(x.state===L.CLOSE_OBJECT&&x.stack.push(L.CLOSE_OBJECT),oi(x),x.state=L.OPEN_KEY):Pe(x,"Bad object");continue;case L.OPEN_ARRAY:case L.VALUE:if(di(re))continue;if(x.state===L.OPEN_ARRAY)if(Ue(x,"onopenarray"),this.depth++,x.state=L.VALUE,re===se.closeBracket){Ue(x,"onclosearray"),this.depth--,x.state=x.stack.pop()||L.VALUE;continue}else x.stack.push(L.CLOSE_ARRAY);re===se.doubleQuote?x.state=L.STRING:re===se.openBrace?x.state=L.OPEN_OBJECT:re===se.openBracket?x.state=L.OPEN_ARRAY:re===se.t?x.state=L.TRUE:re===se.f?x.state=L.FALSE:re===se.n?x.state=L.NULL:re===se.minus?x.numberNode+="-":se._0<=re&&re<=se._9?(x.numberNode+=String.fromCharCode(re),x.state=L.NUMBER_DIGIT):Pe(x,"Bad value");continue;case L.CLOSE_ARRAY:if(re===se.comma)x.stack.push(L.CLOSE_ARRAY),oi(x,"onvalue"),x.state=L.VALUE;else if(re===se.closeBracket)zt(x,"onclosearray"),this.depth--,x.state=x.stack.pop()||L.VALUE;else{if(di(re))continue;Pe(x,"Bad array")}continue;case L.STRING:x.textNode===void 0&&(x.textNode="");var $t=we-1,Ui=x.slashed,cr=x.unicodeI;e:for(;;){for(t.DEBUG&&console.log(we,re,t.STATE[x.state],Ui);cr>0;)if(x.unicodeS+=String.fromCharCode(re),re=j.charCodeAt(we++),x.position++,cr===4?(x.textNode+=String.fromCharCode(parseInt(x.unicodeS,16)),cr=0,$t=we-1):cr++,!re)break e;if(re===se.doubleQuote&&!Ui){x.state=x.stack.pop()||L.VALUE,x.textNode+=j.substring($t,we-1),x.position+=we-1-$t;break}if(re===se.backslash&&!Ui&&(Ui=!0,x.textNode+=j.substring($t,we-1),x.position+=we-1-$t,re=j.charCodeAt(we++),x.position++,!re))break;if(Ui){if(Ui=!1,re===se.n?x.textNode+=`
`:re===se.r?x.textNode+="\r":re===se.t?x.textNode+="	":re===se.f?x.textNode+="\f":re===se.b?x.textNode+="\b":re===se.u?(cr=1,x.unicodeS=""):x.textNode+=String.fromCharCode(re),re=j.charCodeAt(we++),x.position++,$t=we-1,re)continue;break}Se.lastIndex=we;var os=Se.exec(j);if(os===null){we=j.length+1,x.textNode+=j.substring($t,we-1),x.position+=we-1-$t;break}if(we=os.index+1,re=j.charCodeAt(os.index),!re){x.textNode+=j.substring($t,we-1),x.position+=we-1-$t;break}}x.slashed=Ui,x.unicodeI=cr;continue;case L.TRUE:re===se.r?x.state=L.TRUE2:Pe(x,"Invalid true started with t"+re);continue;case L.TRUE2:re===se.u?x.state=L.TRUE3:Pe(x,"Invalid true started with tr"+re);continue;case L.TRUE3:re===se.e?(Ue(x,"onvalue",!0),x.state=x.stack.pop()||L.VALUE):Pe(x,"Invalid true started with tru"+re);continue;case L.FALSE:re===se.a?x.state=L.FALSE2:Pe(x,"Invalid false started with f"+re);continue;case L.FALSE2:re===se.l?x.state=L.FALSE3:Pe(x,"Invalid false started with fa"+re);continue;case L.FALSE3:re===se.s?x.state=L.FALSE4:Pe(x,"Invalid false started with fal"+re);continue;case L.FALSE4:re===se.e?(Ue(x,"onvalue",!1),x.state=x.stack.pop()||L.VALUE):Pe(x,"Invalid false started with fals"+re);continue;case L.NULL:re===se.u?x.state=L.NULL2:Pe(x,"Invalid null started with n"+re);continue;case L.NULL2:re===se.l?x.state=L.NULL3:Pe(x,"Invalid null started with nu"+re);continue;case L.NULL3:re===se.l?(Ue(x,"onvalue",null),x.state=x.stack.pop()||L.VALUE):Pe(x,"Invalid null started with nul"+re);continue;case L.NUMBER_DECIMAL_POINT:re===se.period?(x.numberNode+=".",x.state=L.NUMBER_DIGIT):Pe(x,"Leading zero not followed by .");continue;case L.NUMBER_DIGIT:se._0<=re&&re<=se._9?x.numberNode+=String.fromCharCode(re):re===se.period?(x.numberNode.indexOf(".")!==-1&&Pe(x,"Invalid number has two dots"),x.numberNode+="."):re===se.e||re===se.E?((x.numberNode.indexOf("e")!==-1||x.numberNode.indexOf("E")!==-1)&&Pe(x,"Invalid number has two exponential"),x.numberNode+="e"):re===se.plus||re===se.minus?(xt===se.e||xt===se.E||Pe(x,"Invalid symbol in number"),x.numberNode+=String.fromCharCode(re)):(Bi(x),we--,ai=!0,x.state=x.stack.pop()||L.VALUE);continue;default:Pe(x,"Unknown state: "+x.state)}return x.position>=x.bufferCheckPosition&&xe(x),x}})(i)})(Vu);const Wf=Ff(Vu),zu=(i,e)=>{const t=Wf.parser();let o="",m=0,M=null,L=!1,_e=[];const ke=()=>_e[_e.length-1],se=()=>_e.length===0;return t.onkey=xe=>{xe===i&&m===e&&(L=!0),o=xe},t.onopenobject=xe=>{if(m+1===e&&xe===i)L=!0,_e.push({});else if(L)if(se())_e.push({});else{const le={};Array.isArray(ke())?ke().push(le):ke()[o]=le,_e.push(le)}m++,o=xe},t.onopenarray=()=>{if(L){const xe=[];se()?_e.push([]):(Array.isArray(ke())?ke().push(xe):ke()[o]=xe,_e.push(xe))}m++},t.onvalue=xe=>{L?_e.length>0?Array.isArray(ke())?ke().push(xe):ke()[o]=xe:(M=xe,L=!1):o===i&&m===e&&(M=xe)},t.oncloseobject=()=>{if(m--,L){const xe=_e.pop();m===e&&(L=!1,_e=[],M=xe)}},t.onclosearray=()=>{if(m--,L){const xe=_e.pop();m===e&&(L=!1,_e=[],M=xe)}},xe=>{if(t.write(xe),M)return{hd:M,tl:null};if(_e.length>0){const le=structuredClone(_e[0]);if(Array.isArray(le)){const Se=le.pop();return{hd:le,tl:Se}}else{const Se=Object.keys(le),ut=Se[Se.length-1],Qt=le[ut];return delete le[ut],{hd:le,tl:Qt}}}else return null}};zu("link",1);zu("entry",1);function Df(i){switch(i){case"sqlite":return{createAdapter:()=>new Vl,createDriver:()=>new al,createIntrospector:e=>new jl(e),createQueryCompiler:()=>new Ml};case"postgresql":return{createAdapter:()=>new Qu,createDriver:()=>new al,createIntrospector:e=>new Mu(e),createQueryCompiler:()=>new Bu}}}function $u(i){return new Worker("/docs/assets/sqlite-wasm.thread-Dc3k1ukp.js",{name:i==null?void 0:i.name})}function Rf(i,e,t,o){const m=o??new $u({name:"sqlite-wasm.thread"});return mh()?new Tf({type:"open",args:{vfs:"opfs",filename:i},aux:{baseURL:e,scope:t}},Af(m)):(console.warn("[medfetch/sqlite-wasm] > Called in non-browser environment, returning dummy..."),Df("sqlite"))}const jf=JSON.parse('{"title":"Filter by ICD codes","description":"","frontmatter":{},"headers":[],"relativePath":"examples.filter-icd.md","filePath":"examples.filter-icd.md"}'),Bf={name:"examples.filter-icd.md"},Vf=dh({...Bf,setup(i){return hh(async()=>{const e=new $u({name:"sqlite-wasm.thread"}),t=Rf(":memory:","http://localhost:8787/fhir",["Patient","Condition"],e),o=new es({dialect:t}),m=await o.selectFrom("Patient").innerJoin("Condition","Condition.subject","Patient.id").select(["Patient.id as pid","Condition.id as cid"]).execute();console.log("results",m);const M=await o.selectFrom("Patient").innerJoin("Condition","Condition.subject","Patient.id").select(["Patient.id as pid","Condition.id as cid"]).execute();console.log("results2",M);const L=await o.selectFrom("Condition").selectAll("Condition").execute();console.log("results3",L)}),(e,t)=>(ph(),fh("div",null,t[0]||(t[0]=[_h("",19)])))}});export{jf as __pageData,Vf as default};
